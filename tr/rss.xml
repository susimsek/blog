<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/rss.xsl"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title><![CDATA[≈ûuayb'in Blogu]]></title>
    <link>https://suaybsimsek.com/tr</link>
    <description><![CDATA[En son makaleleri, eƒüitimleri ve analizleri ke≈üfedin.]]></description>
    <docs>https://www.rssboard.org/rss-specification</docs>
    <generator><![CDATA[≈ûuayb's Blog RSS Generator]]></generator>
    <ttl>60</ttl>
    <pubDate>Wed, 04 Feb 2026 00:00:00 GMT</pubDate>
    <lastBuildDate>Wed, 11 Feb 2026 06:28:16 GMT</lastBuildDate>
    <language>tr-TR</language>
    <copyright><![CDATA[¬© 2024 ≈ûuayb ≈ûim≈üek. T√ºm haklarƒ± saklƒ±dƒ±r.]]></copyright>
    <image>
      <url>https://suaybsimsek.com/images/logo.webp</url>
      <title><![CDATA[≈ûuayb'in Blogu]]></title>
      <link>https://suaybsimsek.com/tr</link>
    </image>
    <atom:link rel="self" type="application/rss+xml" href="https://suaybsimsek.com/tr/rss.xml" />
    <atom:link rel="alternate" hreflang="en" type="application/rss+xml" href="https://suaybsimsek.com/en/rss.xml" />
    <item>
      <title><![CDATA[Spring Boot Configuration Properties]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-configuration-properties</link>
      <description><![CDATA[@ConfigurationProperties ile tip-g√ºvenli yapƒ±landƒ±rma tanƒ±mlamayƒ±, @Validated ile ayarlarƒ± doƒürulamayƒ± ve profile-specific application-{profile}.yml dosyalarƒ±yla ortama g√∂re deƒüer y√∂netimini √∂ƒürenin.]]></description>
      <pubDate>Wed, 04 Feb 2026 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-configuration-properties</guid>
      <content:encoded><![CDATA[<p>√áok sayƒ±da `@Value` ve daƒüƒ±nƒ±k ayarlarla uƒüra≈üƒ±yorsan, `@ConfigurationProperties` Spring Boot‚Äôta yapƒ±landƒ±rmayƒ± tip-g√ºvenli, d√ºzenli ve doƒürulanabilir hale getirmenin en iyi yoludur.</p>
<p>Bu yazƒ±da ≈üunlarƒ± √∂ƒüreneceksin:</p>
<ul>
<li>Yapƒ±landƒ±rmayƒ± sƒ±nƒ±f olarak modelleme (Java/Kotlin)</li>
<li>Uygulama a√ßƒ±lƒ±≈üƒ±nda ayar doƒürulama (fail fast)</li>
<li>`application-{profile}.yml` ile ortama g√∂re override mantƒ±ƒüƒ±</li>
</ul>
<hr />
<h2>üåü Neden `@ConfigurationProperties`?</h2>
<ul>
<li>‚úÖ Tip-g√ºvenli config eri≈üimi (IDE autocomplete, refactor dostu)</li>
<li>‚úÖ ƒ∞lgili ayarlarƒ± tek bir prefix altƒ±nda toplama</li>
<li>‚úÖ Hatalƒ± config‚Äôi erken yakalama (uygulama a√ßƒ±lƒ±≈üƒ±nda)</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>Java 17+</li>
<li>Spring Boot 3.x</li>
<li>Maven veya Gradle</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: `application.yml` i√ßinde config tanƒ±mla</h2>
<p>Uygulamaya √∂zel bir prefix belirle (√∂r. `app`):</p>
<pre><code class="language-yaml">app:
  security:
    enabled: true
    token-expiry-seconds: 3600
  allowed-origins:
    - &#39;https://example.com&#39;
    - &#39;http://localhost:3000&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: `@ConfigurationProperties` sƒ±nƒ±fƒ±nƒ± olu≈ütur</h2>
<h3>Java</h3>
<pre><code class="language-java">import java.util.List;

import org.springframework.boot.context.properties.ConfigurationProperties;

@ConfigurationProperties(prefix = &quot;app&quot;)
public class AppProperties {

  private Security security = new Security();
  private List&lt;String&gt; allowedOrigins = List.of();

  public Security getSecurity() {
    return security;
  }

  public void setSecurity(Security security) {
    this.security = security;
  }

  public List&lt;String&gt; getAllowedOrigins() {
    return allowedOrigins;
  }

  public void setAllowedOrigins(List&lt;String&gt; allowedOrigins) {
    this.allowedOrigins = allowedOrigins;
  }

  public static class Security {
    private boolean enabled = true;
    private int tokenExpirySeconds = 3600;

    public boolean isEnabled() {
      return enabled;
    }

    public void setEnabled(boolean enabled) {
      this.enabled = enabled;
    }

    public int getTokenExpirySeconds() {
      return tokenExpirySeconds;
    }

    public void setTokenExpirySeconds(int tokenExpirySeconds) {
      this.tokenExpirySeconds = tokenExpirySeconds;
    }
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">import org.springframework.boot.context.properties.ConfigurationProperties

@ConfigurationProperties(prefix = &quot;app&quot;)
data class AppProperties(
  val security: Security = Security(),
  val allowedOrigins: List&lt;String&gt; = emptyList(),
) {
  data class Security(
    val enabled: Boolean = true,
    val tokenExpirySeconds: Int = 3600,
  )
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Properties sƒ±nƒ±flarƒ±nƒ± etkinle≈ütir</h2>
<p>ƒ∞ki yaygƒ±n y√∂ntem var:</p>
<p>1. `@ConfigurationProperties` sƒ±nƒ±flarƒ±nƒ± tara:</p>
<pre><code class="language-java">import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.ConfigurationPropertiesScan;

@SpringBootApplication
@ConfigurationPropertiesScan
public class DemoApplication {}</code></pre>
<p>2. Sadece belirli sƒ±nƒ±flarƒ± enable et:</p>
<pre><code class="language-java">import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.EnableConfigurationProperties;

@SpringBootApplication
@EnableConfigurationProperties(AppProperties.class)
public class DemoApplication {}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: A√ßƒ±lƒ±≈üta doƒürula (fail fast)</h2>
<p>Constraint ekleyip sƒ±nƒ±fƒ± `@Validated` ile i≈üaretle.</p>
<h3>Java</h3>
<pre><code class="language-java">import java.util.List;

import jakarta.validation.Valid;
import jakarta.validation.constraints.Min;
import jakarta.validation.constraints.NotEmpty;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.validation.annotation.Validated;

@ConfigurationProperties(prefix = &quot;app&quot;)
@Validated
public class AppProperties {

  @Valid
  private Security security = new Security();

  @NotEmpty
  private List&lt;String&gt; allowedOrigins = List.of();

  public Security getSecurity() { return security; }
  public void setSecurity(Security security) { this.security = security; }

  public List&lt;String&gt; getAllowedOrigins() { return allowedOrigins; }
  public void setAllowedOrigins(List&lt;String&gt; allowedOrigins) { this.allowedOrigins = allowedOrigins; }

  public static class Security {
    private boolean enabled = true;

    @Min(60)
    private int tokenExpirySeconds = 3600;

    public boolean isEnabled() { return enabled; }
    public void setEnabled(boolean enabled) { this.enabled = enabled; }

    public int getTokenExpirySeconds() { return tokenExpirySeconds; }
    public void setTokenExpirySeconds(int tokenExpirySeconds) { this.tokenExpirySeconds = tokenExpirySeconds; }
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">import jakarta.validation.Valid
import jakarta.validation.constraints.Min
import jakarta.validation.constraints.NotEmpty
import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.validation.annotation.Validated

@ConfigurationProperties(prefix = &quot;app&quot;)
@Validated
data class AppProperties(
  @field:Valid
  val security: Security = Security(),

  @field:NotEmpty
  val allowedOrigins: List&lt;String&gt; = emptyList(),
) {
  data class Security(
    val enabled: Boolean = true,

    @field:Min(60)
    val tokenExpirySeconds: Int = 3600,
  )
}</code></pre>
<p>Not: Bu doƒürulamanƒ±n √ßalƒ±≈ümasƒ± i√ßin classpath‚Äôte bir Bean Validation implementasyonu olmalƒ± (√∂rn. `spring-boot-starter-validation`).</p>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: Profile-specific dosyalarƒ± kullan (`application-{profile}.yml`)</h2>
<p>Spring Boot √∂nce `application.yml`‚Äôƒ± okur, sonra aktif profile‚Äôa g√∂re override dosyalarƒ±nƒ± uygular.</p>
<p>√ñrnek:</p>
<ul>
<li>`application.yml` (varsayƒ±lanlar)</li>
<li>`application-prod.yml` (prod override)</li>
</ul>
<pre><code class="language-yaml"># application-prod.yml
app:
  security:
    enabled: true
  allowed-origins:
    - &#39;https://mycompany.com&#39;</code></pre>
<p>Birden fazla profile aktifse ‚Äúson yazan kazanƒ±r‚Äù mantƒ±ƒüƒ± ge√ßerlidir (son aktif profile, √∂nceki profillerin deƒüerlerini override edebilir).</p>
<hr />
<h2>üåü ƒ∞pu√ßlarƒ±</h2>
<ul>
<li>Non-trivial ayarlarda `@Value` yerine `@ConfigurationProperties` kullan.</li>
<li>`security`, `mail`, `storage` gibi alanlara g√∂re ayrƒ± root‚Äôlar tanƒ±mla.</li>
<li>Bo≈ü olmamasƒ± gereken veya aralƒ±k kƒ±sƒ±tƒ± olan deƒüerlerde doƒürulama constraint‚Äôleri ekle.</li>
</ul>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot&#39;ta @ConfigurationProperties, @Validated ile a√ßƒ±lƒ±≈ü doƒürulamasƒ± ve profile-specific override&#39;larƒ± birle≈ütirerek saƒülam ve √ºretim‚Äëhazƒ±r bir yapƒ±landƒ±rma katmanƒ± sunar; uygulamanƒ±zƒ± farklƒ± ortamlarda daha g√ºvenli i≈ületmenizi saƒülar.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Yapƒ±landƒ±rma]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-configuration-properties-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot GraphQL JWE Kimlik Doƒürulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-graphql-jwe-authentication</link>
      <description><![CDATA[Stateless ≈üifreli JWT‚Äôler (JWE) ile Spring Boot GraphQL API‚Äôlerinizi g√ºvenli hale getirmeyi; kullanƒ±cƒ± kimliƒüi ve rolleri JPA ile bir veritabanƒ±nda saklamayƒ± √∂ƒürenin.]]></description>
      <pubDate>Sat, 17 May 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-graphql-jwe-authentication</guid>
      <content:encoded><![CDATA[<p>Spring Boot GraphQL JWE Kimlik Doƒürulamasƒ±, GraphQL‚Äôin esnekliƒüini, stateless ≈üifreli JWT‚Äôleri (JWE) ve JPA&#39;yƒ± birle≈ütirerek g√ºvenli ve √∂l√ßeklendirilebilir bir API sunar.</p>
<hr />
<h2>üåü GraphQL + JWE Kimlik Doƒürulamasƒ± Neden Kullanƒ±lmalƒ±?</h2>
<ul>
<li>Stateless G√ºvenlik: Tokenlar kendi i√ßinde t√ºm bilgiyi barƒ±ndƒ±rƒ±r ve sunucu tarafƒ±nda saklama gerektirmez.</li>
<li>GraphQL Esnekliƒüi: Her query veya mutationu tutarlƒ± bir ≈üekilde koruyun.</li>
<li>Veri Hassasiyeti: ƒ∞stemcilerin tam olarak istediƒüi veriyi √ßeker.</li>
<li>B√ºt√ºnl√ºk: ƒ∞mzalƒ± tokenlar, i√ßeriƒüin deƒüi≈ütirilmediƒüini garanti eder.</li>
<li>Gizlilik: ≈ûifrelenmi≈ü JWT‚Äôler hassas bilgileri dƒ±≈üarƒ±dan okunamaz halde tutar.</li>
<li>Standartlara Dayalƒ±: JOSE, Spring Security ve GraphQL‚Äôden yararlanƒ±n.</li>
<li>√ñl√ßeklenebilirlik: Session replikasyonu veya sticky session gerektirmeden yatay √∂l√ßeklenebilir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>‚òï JDK 17 veya √ºzeri</li>
<li>üì¶ Spring Boot 3.2+</li>
<li>üî§ IDE (IntelliJ IDEA, Eclipse)</li>
<li>üõ¢Ô∏è PostgreSQL (veya geli≈ütirme i√ßin H2)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Add Dependencies</h2>
<p>`pom.xml` veya `build.gradle` dosyanƒ±za ≈üunlarƒ± ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
    &lt;artifactId&gt;spring-security-oauth2-resource-server&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-graphql&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.graphql-java&lt;/groupId&gt;
    &lt;artifactId&gt;graphql-java-extended-scalars&lt;/artifactId&gt;
    &lt;version&gt;22.0&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.liquibase&lt;/groupId&gt;
    &lt;artifactId&gt;liquibase-core&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
    &lt;artifactId&gt;lombok&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.h2database&lt;/groupId&gt;
    &lt;artifactId&gt;h2&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;

&lt;build&gt;
&lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.hibernate.orm.tooling&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-enhance-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;${hibernate.version}&lt;/version&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;enhance&lt;/id&gt;
        &lt;goals&gt;
          &lt;goal&gt;enhance&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;
          &lt;enableLazyInitialization&gt;true&lt;/enableLazyInitialization&gt;
          &lt;enableDirtyTracking&gt;true&lt;/enableDirtyTracking&gt;
          &lt;enableAssociationManagement&gt;true&lt;/enableAssociationManagement&gt;
        &lt;/configuration&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
  &lt;/plugin&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;
    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;
  &lt;/plugin&gt;
&lt;/plugins&gt;
&lt;/build&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">dependencies {
  implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
  implementation &#39;org.springframework.boot:spring-boot-starter-websocket&#39;
  implementation &#39;org.springframework.security:spring-security-oauth2-resource-server&#39;
  implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;
  implementation &#39;org.springframework.boot:spring-boot-starter-graphql&#39;
  implementation &#39;com.graphql-java:graphql-java-extended-scalars:22.0&#39;
  implementation &#39;org.liquibase:liquibase-core&#39;
  compileOnly &#39;org.projectlombok:lombok&#39;
  runtimeOnly &#39;com.h2database:h2&#39;
}

plugins {
  id &#39;org.hibernate.orm&#39; version &#39;6.6.13.Final&#39;
  id &#39;org.graalvm.buildtools.native&#39; version &#39;0.10.6&#39;
}

hibernate {
  enhancement {
    enableAssociationManagement = true
  }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Yapƒ±landƒ±rma Dosyalarƒ±</h2>
<p>Bu b√∂l√ºmde, Spring Boot uygulamamƒ±zƒ± H2/PostgreSQL, JPA, Liquibase changelog‚Äôlarƒ±, veri y√ºklemeleri, JWE anahtar √∂zellikleri, GraphQL ≈üema tanƒ±mlarƒ± ve GraalVM native-image reflection tanƒ±mlarƒ± ile yapƒ±landƒ±rmak i√ßin gereken t√ºm uygulama ve veritabanƒ± d√ºzeyindeki yapƒ±landƒ±rma dosyalarƒ±nƒ± tanƒ±mlƒ±yoruz.</p>
<ul>
<li>`application.yml`</li>
<p>Spring datasource, H2 konsolu, JPA/Hibernate, Liquibase changelog path‚Äôi, GraphQL subscriptions pathi ve t√ºm JWT/JWE anahtarlarƒ±, issuer ve ge√ßerlilik s√ºresi (expiration) ayarlarƒ±nƒ± i√ßerir.</p>
</ul>
<ul>
<li>`liquibase/master.xml`</li>
<p>Liquibase master changelog dosyasƒ±; H2 ve PostgreSQL i√ßin DBMS √∂zel √∂zellikler ve alt changelog tanƒ±mlarƒ±nƒ± barƒ±ndƒ±rƒ±r.</p>
</ul>
<ul>
<li>`liquibase/changelog/changelog-user.xml`</li>
<p>`user_identity`, `authority` ve `user_authority_mapping` tablolarƒ±, indeksler, yabancƒ± anahtarlar (FK) ve ilk `&lt;loadData&gt;` adƒ±mlarƒ±nƒ± tanƒ±mlayan temel ≈üema deƒüi≈üiklik changelogu.</p>
</ul>
<ul>
<li>`liquibase/data/user.csv`</li>
<p>Kullanƒ±cƒ± kayƒ±tlarƒ± (UUID, kullanƒ±cƒ± adƒ±, bcrypt ile ≈üifrelenmi≈ü parola, e-posta, enabled flagi, zaman damgalarƒ± ve olu≈üturan kullanƒ±cƒ± bilgisi).</p>
</ul>
<ul>
<li>`liquibase/data/authority.csv`</li>
<p>Yetki kayƒ±tlarƒ± (UUID, ad, a√ßƒ±klama, zaman damgalarƒ± ve olu≈üturan kullanƒ±cƒ± bilgisi).</p>
</ul>
<ul>
<li>`liquibase/data/user_authority_mapping.csv`</li>
<p>Kullanƒ±cƒ±lar ile yetkiler arasƒ±ndaki mappingler (composite birincil anahtar, zaman damgalarƒ± ve olu≈üturan kullanƒ±cƒ± bilgisi).</p>
</ul>
<ul>
<li>`graphql/schema.graphqls`</li>
<p>API i√ßin √∂zel scalar tipler, query, subscription ve mutation tanƒ±mlarƒ± ile DTO ≈üema tanƒ±mlamalarƒ±nƒ± i√ßeren GraphQL ≈üema dosyasƒ±.</p>
</ul>
<ul>
<li>`META-INF/native-image/liquibase/reflect-config.json`</li>
<p>GraalVM native-image olu≈ütururken Liquibase sƒ±nƒ±flarƒ± i√ßin gerekli reflection kurallarƒ±nƒ± tanƒ±mlar.</p>
</ul>
<h3>application.yml</h3>
<pre><code class="language-yaml">spring:
  datasource:
    url: jdbc:h2:mem:testdb;MODE=PostgreSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password: password
  h2:
    console:
      enabled: true
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: none
    show-sql: true
    properties:
      hibernate.format_sql: true
  liquibase:
    change-log: classpath:liquibase/master.xml
  graphql:
    websocket:
      path: /subscriptions
    graphiql:
      enabled: true
security:
  admin:
    username: admin
    password: adminpass
  user:
    username: user
    password: userpass
  jwt:
    issuer: demo-issuer
    expiration-duration: 3600s
    signing:
      key-id: signing-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjZEcz5itWkDGOSqZdB5P
        JE0ccOCckskp0hN3kQbT1qnv+9/k66jlWgVi4HSTppwdNF/Ylu5u541Qj+Okyg+u
        8o2PvKo5CfgvTDsFLTrZHUXU6hCSGatLAQoeN6lT8wzov2r4DFecXrIqcO6SvMB5
        ecPqsfiTi4trsNKgJ4cWS6gILH62ISd1ipUadfpnUzDMO1OulV0CJNV6bcBk7Es9
        RW6AHfg9j8osSanpwvRM4MJkB0SRxYUnrN9faGpkBZISZJ8TShhaTHEGfSNgKe5y
        8iu+AMGGZu8DYczVmqS3Ske1fq6y5HEGCma7Mo019GmwKeHBo1obuET6cZRygj4y
        twIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCNkRzPmK1aQMY5
        Kpl0Hk8kTRxw4JySySnSE3eRBtPWqe/73+TrqOVaBWLgdJOmnB00X9iW7m7njVCP
        46TKD67yjY+8qjkJ+C9MOwUtOtkdRdTqEJIZq0sBCh43qVPzDOi/avgMV5xesipw
        7pK8wHl5w+qx+JOLi2uw0qAnhxZLqAgsfrYhJ3WKlRp1+mdTMMw7U66VXQIk1Xpt
        wGTsSz1FboAd+D2PyixJqenC9EzgwmQHRJHFhSes319oamQFkhJknxNKGFpMcQZ9
        I2Ap7nLyK74AwYZm7wNhzNWapLdKR7V+rrLkcQYKZrsyjTX0abAp4cGjWhu4RPpx
        lHKCPjK3AgMBAAECggEABMo/sNCIMREXA/EqjxDFecN4LmOTOK5A0YBiH9Cc01sd
        qSaavtSQqhqbjV+0bUNEA7UohXbc3s3bx3qa5VFhiIh8sBQMaQdyRkCK/MxMc16d
        BSx5XQ/8MjVO73A1zHgH2g47BWPjgRrDL94KrgNPOO0FoG76QxL9GlcOHzhFa1rf
        xbb2auLBtflKy+5TZNnB/sbFC9ISpWywzfblD2Fsvxupl0vNWtA0Y2rPbKMZRnY+
        V6NC38yxW3HHAdWQRYLGOitM59I0HBgnjQKzTBNIsjPnJA2BSZvMBtQ1e3RQV0qE
        8VVoktZ8A0KDUxqdKWYlGYAY5hIw1y3UUsPRUbS3fQKBgQDAZehu+Kb5Sw+h00Qu
        vViNHDvi0PwmhQrHVpgjrppCnWsTk6FJFm+EBLY+87usXuRCnfZ1semb6P+yjLh2
        bJ9IXIrFAztcyE+7eZfn0H7mHA7E2ICKTjNdKbjy8kHViHpgdXREnAOrFTTk/BqW
        dq+weG2OuxYczWsY4XliWaVyiwKBgQC8XYExpSmoyI37o+jr9405k30tbGUw4X+/
        xYOvSUuafI8IOSLfKTpsvkMN3hxpJO6apIRAjOALbotKUA5FrHQPenuBWOr3mBJT
        euLiaWphqU8YN5dbNd+JhC/Jh5DLhY5FpB2Fv2MKSoF7+onpjDy9pEU5aReeBB0v
        ekUw4nWiBQKBgHxyrnjxP1frFG5xMB4nfZqw04+v7BmiXsl3mqsh6kgCeNtN17pl
        17YGMjfgAdnJ+02XzW5tqRSfDp3YZgy7z//HVD+BCqnGK8SxLu/ULfD73xW2kNZl
        JNYzAZ2r06eiQr4X2x/x5nGIIxGmfDAtDxFPpFX5b6ErwgVy+sgCAoFnAoGAWSpu
        EMEdQk+FnnwNsz2g9YNSuyDXmdb08SOfXWd1yXBzCLJ7RmYuyPEbrsHYcxFPfZap
        ICFPoTm35/qTdvnWiskxE56yw3eSHUBLjF/YQtixn0YZeMy8v0z6jgyFR0I2gdLZ
        QsnBKUrxlm2XwR1oV2Eef7m2u085PZNEk4pvor0CgYA6n060r48/CgRVslAeGder
        fZ3n+2ru8q2UVB38evepjLifn5+tKdFzZ7/NckXMC0NOVzm74qG46VFLMw5TtyT4
        /hRvGSYxA6dMjXy+tcrAns9Isrz2PnYFntlbhU6hw0um809tFunbvITfyeOjAsDW
        stC4thnhzXXT1Y3RfFtYEg==
        -----END PRIVATE KEY-----
    encryption:
      key-id: encryption-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtU7Vu4tML8qg9BISaUH0
        BTU0+qkHJS3TUl3R0hEPttZJGf8EgT7bpWqRjdhMC2SYt2ifNF82EgMo/eva1rLn
        wYtCsxjJ7oB4U2m16/JKHtphmMUGhSLgbp+Y8pGAQ+P6u4HLlI0qbL92Syb6QCTr
        nYIlzZ2uUAvUQg/SbuAvdS4kdauZtpMNbhryusMVvILVBC5yUhfLJAkjbU3qWo/n
        2NKPr4kjwwFh6FaAf0HLsXCFmJbPPok6WMZeDqPORPZCt5gU2t04fS7s/2SSbhQ/
        i+7yyT4pl44cUlNLLN3Qo73sai5H90q7Dvmk3M5/YMJB0Ueyb705LHyOO5xA618s
        qQIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC1TtW7i0wvyqD0
        EhJpQfQFNTT6qQclLdNSXdHSEQ+21kkZ/wSBPtulapGN2EwLZJi3aJ80XzYSAyj9
        69rWsufBi0KzGMnugHhTabXr8koe2mGYxQaFIuBun5jykYBD4/q7gcuUjSpsv3ZL
        JvpAJOudgiXNna5QC9RCD9Ju4C91LiR1q5m2kw1uGvK6wxW8gtUELnJSF8skCSNt
        Tepaj+fY0o+viSPDAWHoVoB/QcuxcIWYls8+iTpYxl4Oo85E9kK3mBTa3Th9Luz/
        ZJJuFD+L7vLJPimXjhxSU0ss3dCjvexqLkf3SrsO+aTczn9gwkHRR7JvvTksfI47
        nEDrXyypAgMBAAECggEAREnJHrY8n9OGA+e6n4KD0mJT7gUz98Dm0yMbIC/k50yW
        hAAVRkjSmd8lq3NIURI2ov342NTznJ0sF1d6OVtxBujY2nP/uqEQsPoj1xaO7Ef8
        cnnjFsooFgJurQ44bVm02mLstqrky8jhWTT5FKfTRqP6cRNu0B9kdu1WqQQvW8a/
        C8xD8XUFzzJFQsEstJ076NjlZNH3EeqFiLxyVdV7tPEJRnOe2V2BAAgda3ByA6Jc
        Nd4xYHTVr5rZ+KES9gaAgb86+S7hNigsxz5Gp58NimLEyz1Qd+d9QCgPRgKOV5Uq
        0ci6c28ZrxW9wa/2CGCpoow1V7hRy1fZ24g2Tz91cQKBgQDbSdP/FQYuem0pUf8u
        mA/niEC8Jz30FW3ix5aqbQ8YRudK48Xy8F7AWnlS0wT2k/Xaeppn9YSPK4HlsNk2
        1gnpNfzdqXpJQtuxcPPeFNzUdXzBrsLXYqtlhOX/afrzqMhp73gkqoxXtqwD7BqN
        VfMcVXsWrEZQrRPBn/RUnnLdJwKBgQDTqUGupm93UlhoPgLXHGF/seQwPPHcU6lS
        SS9l512Ie21B+vZecgO4r77BXJwbY4rZVA5/m+wrsNmsT2f8yfdbs84cBDDWiKy5
        t2Um8zrus+BCIffxc9Fck9/htK33jLLcYwdSAm3a9pJxR9f/kAdredSTGBNJ3W/2
        rfh3cdNprwKBgDi7WfBFRSsjGzi0cPth9cNlubGzyVBrdtlT34PJ4Tzboxz53o1i
        aHEFNxwZYdBVKSbTzzyUBS5xCBMfdKK+LyQ5hmjmXq+zb1jxqvXKmfMRTixhhSDp
        8wO5pTM1/Omqwea+QGvj/5j1tnzxSVFFajbrWoPcH/jhPho6wqBducPDAoGBALOJ
        MEOavZXy7TaO0w3v7uvH0wzvxR/kfw1jMqc3l2j7ePOskmoOQAXaXO3bRjcdOlua
        Jyoq8islOZ4lRMlx7zWD0OKG035GNGzbmRtu2aA8R48RDSVr3jyu2gqznZULbXPv
        M/hmQxSmbhVUoW0PmJubnaqfk0zmXeBaNRXsIS3VAoGBALdsAtqR23PVeL6sYj2l
        dRNTDXpfvjFqJ5NThRO/4mT0CrPHQVj+Mz2bTc/Dxiwi8s8m3L+g23i3hodh/QMb
        Iz+UbcJZBGAKsFbPKGOtj6Bi07y/L11mcuNJzOWe61/JbVmJss0s+N/v3XucK/Ge
        CUaGOccsMO221v6JoBh9J3Hz
        -----END PRIVATE KEY-----</code></pre>
<h3>master.xml</h3>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;databaseChangeLog
  xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;
      http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd&quot;&gt;

  &lt;!-- H2 defaults --&gt;
  &lt;property name=&quot;now&quot; value=&quot;now()&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;floatType&quot; value=&quot;float4&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;uuidType&quot; value=&quot;uuid&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;datetimeType&quot; value=&quot;datetime(6)&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;binaryType&quot; value=&quot;LONGVARBINARY&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;clobType&quot; value=&quot;longvarchar&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;blobType&quot; value=&quot;blob&quot; dbms=&quot;h2&quot;/&gt;

  &lt;!-- PostgreSQL overrides --&gt;
  &lt;property name=&quot;now&quot; value=&quot;current_timestamp&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;floatType&quot; value=&quot;float4&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;uuidType&quot; value=&quot;uuid&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;datetimeType&quot; value=&quot;datetime&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;binaryType&quot; value=&quot;BYTEA&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;clobType&quot; value=&quot;clob&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;blobType&quot; value=&quot;blob&quot; dbms=&quot;postgresql&quot;/&gt;

  &lt;!-- include the core auth changelog --&gt;
  &lt;include file=&quot;classpath:db/changelog/changelog-user.xml&quot;/&gt;

&lt;/databaseChangeLog&gt;</code></pre>
<h3>changelog-user.xml</h3>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;databaseChangeLog
  xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;
      http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd&quot;&gt;

  &lt;changeSet id=&quot;20250510-1&quot; author=&quot;susimsek&quot;&gt;
    &lt;createTable tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints primaryKey=&quot;true&quot; primaryKeyName=&quot;pk_user_identity&quot; nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;username&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot; unique=&quot;true&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;password&quot; type=&quot;varchar(100)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;email&quot; type=&quot;varchar(100)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot; unique=&quot;true&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;first_name&quot; type=&quot;varchar(50)&quot;/&gt;
      &lt;column name=&quot;last_name&quot; type=&quot;varchar(50)&quot;/&gt;
      &lt;column name=&quot;enabled&quot; type=&quot;boolean&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;varchar(50)&quot;/&gt;
    &lt;/createTable&gt;

    &lt;createIndex indexName=&quot;idx_user_identity_username&quot; tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;username&quot;/&gt;
    &lt;/createIndex&gt;
    &lt;createIndex indexName=&quot;idx_user_identity_email&quot; tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;email&quot;/&gt;
    &lt;/createIndex&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-2&quot; author=&quot;susimsek&quot;&gt;
    &lt;createTable tableName=&quot;authority&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints primaryKey=&quot;true&quot; primaryKeyName=&quot;pk_authority&quot; nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;name&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot; unique=&quot;true&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;description&quot; type=&quot;varchar(255)&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;varchar(50)&quot;/&gt;
    &lt;/createTable&gt;

    &lt;createIndex indexName=&quot;idx_authority_name&quot; tableName=&quot;authority&quot;&gt;
      &lt;column name=&quot;name&quot;/&gt;
    &lt;/createIndex&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-3&quot; author=&quot;susimsek&quot;&gt;
    &lt;createTable tableName=&quot;user_authority_mapping&quot;&gt;
      &lt;column name=&quot;user_id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;authority_id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;varchar(50)&quot;/&gt;
    &lt;/createTable&gt;

    &lt;addPrimaryKey
      tableName=&quot;user_authority_mapping&quot;
      columnNames=&quot;user_id, authority_id&quot;
      constraintName=&quot;pk_user_authority_mapping&quot;/&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-4&quot; author=&quot;susimsek&quot;&gt;
    &lt;addForeignKeyConstraint
      baseTableName=&quot;user_authority_mapping&quot;
      baseColumnNames=&quot;user_id&quot;
      constraintName=&quot;fk_user_authority_user&quot;
      referencedTableName=&quot;user_identity&quot;
      referencedColumnNames=&quot;id&quot;/&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-5&quot; author=&quot;susimsek&quot;&gt;
    &lt;addForeignKeyConstraint
      baseTableName=&quot;user_authority_mapping&quot;
      baseColumnNames=&quot;authority_id&quot;
      constraintName=&quot;fk_user_authority_authority&quot;
      referencedTableName=&quot;authority&quot;
      referencedColumnNames=&quot;id&quot;/&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-1-data&quot; author=&quot;susimsek&quot;&gt;
    &lt;loadData
      file=&quot;db/data/user.csv&quot;
      separator=&quot;;&quot;
      tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;username&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;password&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;email&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;first_name&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;last_name&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;enabled&quot; type=&quot;boolean&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;string&quot;/&gt;
    &lt;/loadData&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-2-data&quot; author=&quot;susimsek&quot;&gt;
    &lt;loadData
      file=&quot;db/data/authority.csv&quot;
      separator=&quot;;&quot;
      tableName=&quot;authority&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;name&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;description&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;string&quot;/&gt;
    &lt;/loadData&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-3-data&quot; author=&quot;susimsek&quot;&gt;
    &lt;loadData
      file=&quot;db/data/user_authority_mapping.csv&quot;
      separator=&quot;;&quot;
      tableName=&quot;user_authority_mapping&quot;&gt;
      &lt;column name=&quot;user_id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;authority_id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;string&quot;/&gt;
    &lt;/loadData&gt;
  &lt;/changeSet&gt;

&lt;/databaseChangeLog&gt;</code></pre>
<h3>user.csv</h3>
<pre><code class="language-csv">id;username;password;email;first_name;last_name;enabled;created_at;created_by;updated_at;updated_by
a1b2c3d4-e5f6-7890-abcd-ef1234567890;admin;$2a$10$sva6wl8pmGKJE6NIWrxwcuJK1Jaa2I/LOI43iHVpbR4YB8KjGViiK;admin@example.com;Admin;User;true;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
09876543-21fe-dcba-0987-654321fedcba;user;$2a$10$5Py4PyteLuXEqnGpSigzfu0V55C7Hi7zX18lmh.J8Bpmft.h23voG;user@example.com;Normal;User;true;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system</code></pre>
<h3>authority.csv</h3>
<pre><code class="language-csv">id;name;description;created_at;created_by;updated_at;updated_by
f47ac10b-58cc-4372-a567-0e02b2c3d479;ROLE_ADMIN;Administrator role;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
9c858901-8a57-4791-81fe-4c455b099bc9;ROLE_USER;User role;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system</code></pre>
<h3>user_authority_mapping.csv</h3>
<pre><code class="language-csv">user_id;authority_id;created_at;created_by;updated_at;updated_by
a1b2c3d4-e5f6-7890-abcd-ef1234567890;9c858901-8a57-4791-81fe-4c455b099bc9;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
a1b2c3d4-e5f6-7890-abcd-ef1234567890;f47ac10b-58cc-4372-a567-0e02b2c3d479;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
09876543-21fe-dcba-0987-654321fedcba;9c858901-8a57-4791-81fe-4c455b099bc9;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system</code></pre>
<h3>schema.graphqls</h3>
<pre><code class="language-graphql">scalar Long
scalar Date
scalar Instant

type Query {
  helloAll: String!
  helloAdmin: String!
}

type Mutation {
  login(input: LoginInput!): TokenDTO!
  logout: Boolean!
  greet(input: GreetInput!): GreetDTO!
}

type Subscription {
  greetStream(input: GreetInput!): GreetDTO!
  greetStreamAdmin(input: GreetInput!): GreetDTO!
}

input LoginInput {
  username: String!
  password: String!
}

input GreetInput {
  message: String!
}

type TokenDTO {
  accessToken: String!
  tokenType: String!
  accessTokenExpiresIn: Long!
}

type GreetDTO {
  greeting: String!
  timestamp: Instant!
}</code></pre>
<h3>reflect-config.json</h3>
<pre><code class="language-json">[
  {
    &quot;name&quot;: &quot;liquibase.logging.mdc.MdcManagerFactory&quot;,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.change.core.LoadDataColumnConfig&quot;,
    &quot;queryAllPublicMethods&quot;: true,
    &quot;allDeclaredMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.command.CommandFactory&quot;,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.changelog.ChangeLogHistoryServiceFactory&quot;,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.BigIntType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.BlobType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.BooleanType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.CharType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.ClobType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.CurrencyType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.DatabaseFunctionType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.DateTimeType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.DateType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.DecimalType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.DoubleType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.FloatType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.IntType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.MediumIntType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.NCharType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.NumberType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.NVarcharType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.SmallIntType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.TimestampType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.TimeType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.TinyIntType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.UnknownType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.UUIDType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.VarcharType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  },
  {
    &quot;name&quot;: &quot;liquibase.datatype.core.XMLType&quot;,
    &quot;allPublicMethods&quot;: true,
    &quot;methods&quot;: [{ &quot;name&quot;: &quot;&lt;init&gt;&quot;, &quot;parameterTypes&quot;: [] }]
  }
]</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: GraphQL &amp; G√ºvenlik &amp; Veritabanƒ± Yapƒ±landƒ±rmasƒ±</h2>
<p>Bu b√∂l√ºmde JWE tabanlƒ± kimlik doƒürulama, GraphQL entegrasyonu, GraalVM native-image √ßalƒ±≈üma zamanƒ± ipu√ßlarƒ± ve √∂zel scalars i√ßin gerekli bean&#39;leri ve ayarlarƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>JwtProperties: JWT d√ºzenleyicisi (issuer), ge√ßerlilik s√ºresi ve imzalama/≈üifreleme anahtar √ßiftlerini yapƒ±landƒ±rƒ±r.</li>
<li>SecurityJwtConfig: RSA JWK nesnelerini olu≈üturur, JWT encoder/decoder‚Äôƒ±, authentication converter ve token resolver ve WebSocket interceptor bean‚Äôlerini yapƒ±landƒ±rƒ±r.</li>
<li>SecurityConfig: `DomainUserDetailsService` ile entegre olur, kimlik doƒürulama y√∂neticisi (authentication manager), password encoder ve JWE desteƒüi ile stateless g√ºvenlik filtre zincirini yapƒ±landƒ±rƒ±r.</li>
<li>DatabaseConfig: JPA repository&#39;lerini, auditing ve transaction y√∂netimini etkinle≈ütirir.</li>
<li>GraphQLConfig: GraphQL i√ßin √∂zel scalarlarƒ± (`Long`, `Date`, `Instant`) tanƒ±mlar.</li>
<li>InstantScalar: GraphQL ≈üemasƒ±nda ISO-8601 uyumlu `Instant` tipini tanƒ±mlayan custom scalar.</li>
<li>NativeConfig: GraalVM native-image derlemesi i√ßin √ßalƒ±≈üma zamanƒ± ipu√ßlarƒ±nƒ± (reflection ve kaynak desenleri) kaydeder.</li>
</ul>
<h3>SecurityJwtConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.config;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.JWKSet;
import com.nimbusds.jose.jwk.RSAKey;
import com.nimbusds.jose.jwk.source.JWKSource;
import com.nimbusds.jose.proc.JWEDecryptionKeySelector;
import com.nimbusds.jose.proc.JWSVerificationKeySelector;
import com.nimbusds.jose.proc.SecurityContext;
import com.nimbusds.jwt.proc.DefaultJWTProcessor;
import io.github.susimsek.springbootgraphqljwedemo.security.CookieAuthenticationWebSocketInterceptor;
import io.github.susimsek.springbootgraphqljwedemo.security.CookieBearerTokenResolver;
import io.github.susimsek.springbootgraphqljwedemo.security.KeyUtils;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.graphql.server.WebSocketGraphQlInterceptor;
import org.springframework.graphql.server.support.BearerTokenAuthenticationExtractor;
import org.springframework.security.authentication.ProviderManager;
import org.springframework.security.oauth2.jwt.JwtDecoder;
import org.springframework.security.oauth2.jwt.JwtEncoder;
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder;
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder;
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter;
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter;
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;

import java.util.List;

import static io.github.susimsek.springbootgraphqljwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Configuration
public class SecurityJwtConfig {

  private final JwtProperties props;

  public SecurityJwtConfig(JwtProperties props) {
    this.props = props;
  }

  @Bean
  public RSAKey signingKey() throws Exception {
    return KeyUtils.buildRsaKey(
      props.getSigning().getPublicKey(),
      props.getSigning().getPrivateKey(),
      props.getSigning().getKeyId(),
      true
    );
  }

  @Bean
  public RSAKey encryptionKey() throws Exception {
    return KeyUtils.buildRsaKey(
      props.getEncryption().getPublicKey(),
      props.getEncryption().getPrivateKey(),
      props.getEncryption().getKeyId(),
      false
    );
  }

  @Bean
  public JWKSource&lt;SecurityContext&gt; jwkSource(RSAKey signingKey, RSAKey encryptionKey) {
    JWKSet jwkSet = new JWKSet(List.of(signingKey, encryptionKey));
    return (jwkSelector, context) -&gt; jwkSelector.select(jwkSet);
  }

  @Bean
  public JwtDecoder jwtDecoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
    DefaultJWTProcessor&lt;SecurityContext&gt; jwtProcessor = new DefaultJWTProcessor&lt;&gt;();

    jwtProcessor.setJWEKeySelector(new JWEDecryptionKeySelector&lt;&gt;(
      JWEAlgorithm.RSA_OAEP_256,
      EncryptionMethod.A128GCM,
      jwkSource
    ));
    jwtProcessor.setJWSKeySelector(new JWSVerificationKeySelector&lt;&gt;(
      JWSAlgorithm.RS256,
      jwkSource
    ));
    jwtProcessor.setJWTClaimsSetVerifier((claims, ctx) -&gt; {});

    return new NimbusJwtDecoder(jwtProcessor);
  }

  @Bean
  public JwtEncoder jwtEncoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
    return new NimbusJwtEncoder(jwkSource);
  }

  @Bean
  public JwtAuthenticationConverter jwtAuthenticationConverter() {
    JwtGrantedAuthoritiesConverter converter = new JwtGrantedAuthoritiesConverter();
    converter.setAuthorityPrefix(&quot;&quot;);
    converter.setAuthoritiesClaimName(AUTHORITIES_KEY);

    JwtAuthenticationConverter authConverter = new JwtAuthenticationConverter();
    authConverter.setJwtGrantedAuthoritiesConverter(converter);
    return authConverter;
  }

  @Bean
  public BearerTokenResolver bearerTokenResolver() {
    CookieBearerTokenResolver resolver = new CookieBearerTokenResolver();
    resolver.setAllowUriQueryParameter(false);
    resolver.setAllowFormEncodedBodyParameter(false);
    resolver.setAllowCookie(true);
    return resolver;
  }

  @Bean
  public WebSocketGraphQlInterceptor authenticationInterceptor(JwtDecoder jwtDecoder) {
    return new CookieAuthenticationWebSocketInterceptor(
      new BearerTokenAuthenticationExtractor(),
      new ProviderManager(new JwtAuthenticationProvider(jwtDecoder))
    );
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.config

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.JWKSet
import com.nimbusds.jose.jwk.RSAKey
import com.nimbusds.jose.jwk.source.JWKSource
import com.nimbusds.jose.proc.JWEDecryptionKeySelector
import com.nimbusds.jose.proc.JWSVerificationKeySelector
import com.nimbusds.jose.proc.SecurityContext
import com.nimbusds.jwt.proc.DefaultJWTProcessor
import io.github.susimsek.springbootgraphqljwedemo.security.CookieAuthenticationWebSocketInterceptor
import io.github.susimsek.springbootgraphqljwedemo.security.CookieBearerTokenResolver
import io.github.susimsek.springbootgraphqljwedemo.security.KeyUtils
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.graphql.server.WebSocketGraphQlInterceptor
import org.springframework.graphql.server.support.BearerTokenAuthenticationExtractor
import org.springframework.security.authentication.ProviderManager
import org.springframework.security.oauth2.jwt.JwtDecoder
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver

@Configuration
class SecurityJwtConfig(
  private val props: JwtProperties
) {

  @Bean
  @Throws(Exception::class)
  fun signingKey(): RSAKey = KeyUtils.buildRsaKey(
    props.signing.publicKey,
    props.signing.privateKey,
    props.signing.keyId,
    true
  )

  @Bean
  @Throws(Exception::class)
  fun encryptionKey(): RSAKey = KeyUtils.buildRsaKey(
    props.encryption.publicKey,
    props.encryption.privateKey,
    props.encryption.keyId,
    false
  )

  @Bean
  fun jwkSource(
    signingKey: RSAKey,
    encryptionKey: RSAKey
  ): JWKSource&lt;SecurityContext&gt; {
    val jwkSet = JWKSet(listOf(signingKey, encryptionKey))
    return JWKSource { jwkSelector, _ -&gt; jwkSelector.select(jwkSet) }
  }

  @Bean
  fun jwtDecoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtDecoder {
    val processor = DefaultJWTProcessor&lt;SecurityContext&gt;().apply {
      setJWEKeySelector(JWEDecryptionKeySelector(
        JWEAlgorithm.RSA_OAEP_256,
        EncryptionMethod.A128GCM,
        jwkSource
      ))
      setJWSKeySelector(JWSVerificationKeySelector(
        JWSAlgorithm.RS256,
        jwkSource
      ))
      setJWTClaimsSetVerifier { _, _ -&gt; }
    }
    return NimbusJwtDecoder(processor)
  }

  @Bean
  fun jwtEncoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtEncoder =
    NimbusJwtEncoder(jwkSource)

  @Bean
  fun jwtAuthenticationConverter(): JwtAuthenticationConverter {
    val granted = JwtGrantedAuthoritiesConverter().apply {
      authorityPrefix = &quot;&quot;
      authoritiesClaimName = SecurityUtils.AUTHORITIES_KEY
    }
    return JwtAuthenticationConverter().apply {
      setJwtGrantedAuthoritiesConverter(granted)
    }
  }

  @Bean
  fun bearerTokenResolver(): BearerTokenResolver =
    CookieBearerTokenResolver().apply {
      setAllowUriQueryParameter(false)
      setAllowFormEncodedBodyParameter(false)
      setAllowCookie(true)
    }

  @Bean
  fun authenticationInterceptor(jwtDecoder: JwtDecoder): WebSocketGraphQlInterceptor =
    CookieAuthenticationWebSocketInterceptor(
      BearerTokenAuthenticationExtractor(),
      ProviderManager(JwtAuthenticationProvider(jwtDecoder))
    )
}</code></pre>
<h3>SecurityConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.config;

import io.github.susimsek.springbootgraphqljwedemo.repository.UserRepository;
import io.github.susimsek.springbootgraphqljwedemo.security.DomainUserDetailsService;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.ProviderManager;
import org.springframework.security.authentication.dao.DaoAuthenticationProvider;
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher;
import org.springframework.web.servlet.handler.HandlerMappingIntrospector;

import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
@EnableMethodSecurity(securedEnabled = true)
public class SecurityConfig {

  @Bean
  public SecurityFilterChain securityFilterChain(HttpSecurity http,
                                                 MvcRequestMatcher.Builder mvc) throws Exception {
    http
      .cors(withDefaults())
      .csrf(AbstractHttpConfigurer::disable)
      .authorizeHttpRequests(authz -&gt;
        authz
          .requestMatchers(
            mvc.pattern(&quot;/webjars/**&quot;),
            mvc.pattern(&quot;/css/**&quot;),
            mvc.pattern(&quot;/js/**&quot;)
          ).permitAll()
          .requestMatchers(
            mvc.pattern(&quot;/*.ico&quot;),
            mvc.pattern(&quot;/*.png&quot;),
            mvc.pattern(&quot;/*.svg&quot;),
            mvc.pattern(&quot;/*.webapp&quot;)
          ).permitAll()
          .requestMatchers(&quot;/actuator/**&quot;).permitAll()
          .requestMatchers(
            &quot;/v3/api-docs/**&quot;,
            &quot;/swagger-ui.html&quot;,
            &quot;/swagger-ui/**&quot;
          ).permitAll()
          .requestMatchers(
            mvc.pattern(&quot;/graphql&quot;),
            mvc.pattern(&quot;/graphiql&quot;),
            mvc.pattern(&quot;/subscriptions&quot;)
          ).permitAll()
          .anyRequest().authenticated()
      )
      .sessionManagement(session -&gt;
        session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
      .oauth2ResourceServer(oauth2 -&gt; oauth2
        .jwt(withDefaults())
      );

    return http.build();
  }

  @Bean
  public UserDetailsService userDetailsService(UserRepository userRepository) {
    return new DomainUserDetailsService(userRepository);
  }

  @Bean
  public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
  }

  @Bean
  public AuthenticationManager authenticationManager(
    UserDetailsService userDetailsService,
    PasswordEncoder passwordEncoder) {
    DaoAuthenticationProvider provider = new DaoAuthenticationProvider();
    provider.setUserDetailsService(userDetailsService);
    provider.setPasswordEncoder(passwordEncoder);
    return new ProviderManager(provider);
  }

  @Bean
  public MvcRequestMatcher.Builder mvc(HandlerMappingIntrospector introspector) {
    return new MvcRequestMatcher.Builder(introspector);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.config

import io.github.susimsek.springbootgraphqljwedemo.repository.UserRepository
import io.github.susimsek.springbootgraphqljwedemo.security.DomainUserDetailsService
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.ProviderManager
import org.springframework.security.authentication.dao.DaoAuthenticationProvider
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer
import org.springframework.security.config.http.SessionCreationPolicy
import org.springframework.security.core.userdetails.UserDetailsService
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder
import org.springframework.security.crypto.password.PasswordEncoder
import org.springframework.security.web.SecurityFilterChain
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher
import org.springframework.web.servlet.handler.HandlerMappingIntrospector
import org.springframework.security.config.Customizer.withDefaults

@Configuration
@EnableMethodSecurity(securedEnabled = true)
class SecurityConfig {

  @Bean
  @Throws(Exception::class)
  fun securityFilterChain(
    http: HttpSecurity,
    mvc: MvcRequestMatcher.Builder
  ): SecurityFilterChain {
    http
      .cors(withDefaults())
      .csrf { it.disable() }
      .authorizeHttpRequests { authz -&gt;
        authz
          .requestMatchers(
            mvc.pattern(&quot;/webjars/**&quot;),
            mvc.pattern(&quot;/css/**&quot;),
            mvc.pattern(&quot;/js/**&quot;)
          ).permitAll()
          .requestMatchers(
            mvc.pattern(&quot;/*.ico&quot;),
            mvc.pattern(&quot;/*.png&quot;),
            mvc.pattern(&quot;/*.svg&quot;),
            mvc.pattern(&quot;/*.webapp&quot;)
          ).permitAll()
          .requestMatchers(&quot;/actuator/**&quot;).permitAll()
          .requestMatchers(
            &quot;/v3/api-docs/**&quot;,
            &quot;/swagger-ui.html&quot;,
            &quot;/swagger-ui/**&quot;
          ).permitAll()
          .requestMatchers(
            mvc.pattern(&quot;/graphql&quot;),
            mvc.pattern(&quot;/graphiql&quot;),
            mvc.pattern(&quot;/subscriptions&quot;)
          ).permitAll()
          .anyRequest().authenticated()
      }
      .sessionManagement {
        it.sessionCreationPolicy(SessionCreationPolicy.STATELESS)
      }
      .oauth2ResourceServer {
        it.jwt(withDefaults())
      }

    return http.build()
  }

  @Bean
  fun userDetailsService(userRepository: UserRepository): UserDetailsService =
    DomainUserDetailsService(userRepository)

  @Bean
  fun passwordEncoder(): PasswordEncoder = BCryptPasswordEncoder()

  @Bean
  fun authenticationManager(
    userDetailsService: UserDetailsService,
    passwordEncoder: PasswordEncoder
  ): AuthenticationManager {
    val provider = DaoAuthenticationProvider().apply {
      setUserDetailsService(userDetailsService)
      setPasswordEncoder(passwordEncoder)
    }
    return ProviderManager(provider)
  }

  @Bean
  fun mvc(introspector: HandlerMappingIntrospector): MvcRequestMatcher.Builder =
    MvcRequestMatcher.Builder(introspector)
}</code></pre>
<h3>JwtProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

import java.time.Duration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
@Data
public class JwtProperties {

    @Data
    public static class Pair {
        private String publicKey;
        private String privateKey;
        private String keyId;
    }

    private Pair signing;
    private Pair encryption;
    private String issuer;
    private Duration expirationDuration;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration
import java.time.Duration

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
class JwtProperties {

  class Pair {
    lateinit var publicKey: String
    lateinit var privateKey: String
    lateinit var keyId: String
  }

  lateinit var signing: Pair
  lateinit var encryption: Pair
  lateinit var issuer: String
  lateinit var expirationDuration: Duration
}</code></pre>
<h3>DatabaseConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;

@Configuration
@EnableJpaRepositories(&quot;io.github.susimsek.springbootgraphqljwedemo.repository&quot;)
@EnableJpaAuditing(auditorAwareRef = &quot;springSecurityAuditorAware&quot;)
@EnableTransactionManagement
public class DatabaseConfig {

}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.config

import org.springframework.context.annotation.Configuration
import org.springframework.data.jpa.repository.config.EnableJpaAuditing
import org.springframework.data.jpa.repository.config.EnableJpaRepositories
import org.springframework.transaction.annotation.EnableTransactionManagement

@Configuration
@EnableJpaRepositories(&quot;io.github.susimsek.springbootgraphqljwedemo.repository&quot;)
@EnableJpaAuditing(auditorAwareRef = &quot;springSecurityAuditorAware&quot;)
@EnableTransactionManagement
class DatabaseConfig</code></pre>
<h3>GraphQLConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.config;

import graphql.scalars.ExtendedScalars;
import io.github.susimsek.springbootgraphqljwedemo.scalar.InstantScalar;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.graphql.execution.RuntimeWiringConfigurer;

@Configuration
public class GraphQLConfig {

  @Bean
  public RuntimeWiringConfigurer runtimeWiringConfigurer() {
    return wiring -&gt; wiring
      .scalar(ExtendedScalars.GraphQLLong)
      .scalar(ExtendedScalars.Date)
      .scalar(InstantScalar.INSTANCE);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.config

import graphql.scalars.ExtendedScalars
import io.github.susimsek.springbootgraphqljwedemo.scalar.InstantScalar
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.graphql.execution.RuntimeWiringConfigurer

@Configuration
class GraphQLConfig {

  @Bean
  fun runtimeWiringConfigurer(): RuntimeWiringConfigurer {
    return RuntimeWiringConfigurer { wiring -&gt;
      wiring
        .scalar(ExtendedScalars.GraphQLLong)
        .scalar(ExtendedScalars.Date)
        .scalar(InstantScalar.INSTANCE)
    }
  }
}</code></pre>
<h3>InstantScalar</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.scalar;

import graphql.GraphQLContext;
import graphql.execution.CoercedVariables;
import graphql.language.StringValue;
import graphql.language.Value;
import graphql.scalars.util.Kit;
import graphql.schema.Coercing;
import graphql.schema.CoercingParseLiteralException;
import graphql.schema.CoercingParseValueException;
import graphql.schema.CoercingSerializeException;
import graphql.schema.GraphQLScalarType;
import lombok.AccessLevel;
import lombok.NoArgsConstructor;
import org.springframework.lang.NonNull;

import java.time.Instant;
import java.time.format.DateTimeParseException;
import java.util.Locale;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class InstantScalar {

  public static final GraphQLScalarType INSTANCE;

  static {
    Coercing&lt;Instant, String&gt; coercing = new Coercing&lt;&gt;() {
      @Override
      public String serialize(
        @NonNull Object input,
        @NonNull GraphQLContext context,
        @NonNull Locale locale
      ) throws CoercingSerializeException {
        if (input instanceof Instant instant) {
          return instant.toString();
        }
        throw new CoercingSerializeException(
          &quot;Expected java.time.Instant but was: &quot; + Kit.typeName(input) + &quot;&#39;.&quot;
        );
      }

      @Override
      public Instant parseValue(
        @NonNull Object input,
        @NonNull GraphQLContext context,
        @NonNull Locale locale
      ) throws CoercingParseValueException {
        if (input instanceof String s) {
          try {
            return Instant.parse(s);
          } catch (DateTimeParseException e) {
            throw new CoercingParseValueException(&quot;Invalid Instant value: &quot; + e.getMessage() + &quot;&#39;.&quot;);
          }
        }
        throw new CoercingParseValueException(
          &quot;Expected a String for Instant but was: &quot; + Kit.typeName(input) + &quot;&#39;.&quot;
        );
      }

      @Override
      public Instant parseLiteral(
        @NonNull Value&lt;?&gt; input,
        @NonNull CoercedVariables variables,
        @NonNull GraphQLContext context,
        @NonNull Locale locale
      ) throws CoercingParseLiteralException {
        if (input instanceof StringValue sv) {
          String s = sv.getValue();
          try {
            return Instant.parse(s);
          } catch (DateTimeParseException e) {
            throw new CoercingParseLiteralException(&quot;Invalid Instant literal: &quot; + e.getMessage() + &quot;&#39;&quot;);
          }
        }
        throw new CoercingParseLiteralException(
          &quot;Expected AST type &#39;StringValue&#39; but was: &quot; + Kit.typeName(input) + &quot;&#39;.&quot;
        );
      }

      @Override
      @NonNull
      public Value&lt;?&gt; valueToLiteral(
        @NonNull Object input,
        @NonNull GraphQLContext context,
        @NonNull Locale locale
      ) {
        String serialized = serialize(input, context, locale);
        return StringValue.newStringValue(serialized).build();
      }
    };

    INSTANCE = GraphQLScalarType.newScalar()
      .name(&quot;Instant&quot;)
      .description(&quot;An ISO-8601 compliant java.time.Instant scalar&quot;)
      .specifiedByUrl(&quot;https://www.rfc-editor.org/rfc/rfc3339.html#section-5.6&quot;)
      .coercing(coercing)
      .build();
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.scalar

import graphql.GraphQLContext
import graphql.execution.CoercedVariables
import graphql.language.StringValue
import graphql.language.Value
import graphql.scalars.util.Kit
import graphql.schema.Coercing
import graphql.schema.CoercingParseLiteralException
import graphql.schema.CoercingParseValueException
import graphql.schema.CoercingSerializeException
import graphql.schema.GraphQLScalarType
import java.time.Instant
import java.time.format.DateTimeParseException
import java.util.Locale

object InstantScalar {

  @JvmField
  val INSTANCE: GraphQLScalarType = GraphQLScalarType.newScalar()
    .name(&quot;Instant&quot;)
    .description(&quot;An ISO-8601 compliant java.time.Instant scalar&quot;)
    .specifiedByUrl(&quot;https://www.rfc-editor.org/rfc/rfc3339.html#section-5.6&quot;)
    .coercing(object : Coercing&lt;Instant, String&gt; {
      override fun serialize(
        input: Any,
        context: GraphQLContext,
        locale: Locale
      ): String {
        return if (input is Instant) {
          input.toString()
        } else {
          throw CoercingSerializeException(&quot;Expected java.time.Instant but was: ${Kit.typeName(input)}&#39;.&quot;)
        }
      }

      override fun parseValue(
        input: Any,
        context: GraphQLContext,
        locale: Locale
      ): Instant {
        if (input is String) {
          return try {
            Instant.parse(input)
          } catch (e: DateTimeParseException) {
            throw CoercingParseValueException(&quot;Invalid Instant value: ${e.message}&#39;.&quot;)
          }
        }
        throw CoercingParseValueException(&quot;Expected a String for Instant but was: ${Kit.typeName(input)}&#39;.&quot;)
      }

      override fun parseLiteral(
        input: Value&lt;*&gt;,
        variables: CoercedVariables,
        context: GraphQLContext,
        locale: Locale
      ): Instant {
        if (input is StringValue) {
          return try {
            Instant.parse(input.value)
          } catch (e: DateTimeParseException) {
            throw CoercingParseLiteralException(&quot;Invalid Instant literal: ${e.message}&#39;&quot;)
          }
        }
        throw CoercingParseLiteralException(&quot;Expected AST type &#39;StringValue&#39; but was: ${Kit.typeName(input)}&#39;.&quot;)
      }

      override fun valueToLiteral(
        input: Any,
        context: GraphQLContext,
        locale: Locale
      ): Value&lt;*&gt; {
        val serialized = serialize(input, context, locale)
        return StringValue.newStringValue(serialized).build()
      }
    })
    .build()
}</code></pre>
<h3>NativeConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.config;

import org.springframework.aot.hint.MemberCategory;
import org.springframework.aot.hint.RuntimeHints;
import org.springframework.aot.hint.RuntimeHintsRegistrar;

public class NativeConfig {

  public static class AppNativeRuntimeHints implements RuntimeHintsRegistrar {

    @Override
    public void registerHints(RuntimeHints hints, ClassLoader classLoader) {
      hints.reflection()
        .registerType(sun.misc.Unsafe.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_PUBLIC_METHODS));
      hints.reflection()
        .registerType(java.util.Locale.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_PUBLIC_METHODS));
      hints.reflection()
        .registerType(org.hibernate.binder.internal.BatchSizeBinder.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_PUBLIC_CONSTRUCTORS));
      hints.resources().registerPattern(&quot;liquibase/*&quot;);
      hints.reflection()
        .registerType(liquibase.ui.LoggerUIService.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_PUBLIC_CONSTRUCTORS));
      hints.reflection()
        .registerType(liquibase.database.LiquibaseTableNamesFactory.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS));
      hints.reflection()
        .registerType(liquibase.report.ShowSummaryGeneratorFactory.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS));
      hints.reflection()
        .registerType(liquibase.changelog.FastCheckService.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS));
      hints.reflection()
        .registerType(liquibase.changelog.visitor.ValidatingVisitorGeneratorFactory.class,
          hint -&gt; hint.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS));
    }
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.config

import org.springframework.aot.hint.MemberCategory
import org.springframework.aot.hint.RuntimeHints
import org.springframework.aot.hint.RuntimeHintsRegistrar

class NativeConfig {

  class AppNativeRuntimeHints : RuntimeHintsRegistrar {
    override fun registerHints(hints: RuntimeHints, classLoader: ClassLoader) {
      hints.reflection().registerType(
        sun.misc.Unsafe::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_PUBLIC_METHODS) }
      )
      hints.reflection().registerType(
        java.util.Locale::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_PUBLIC_METHODS) }
      )
      hints.reflection().registerType(
        org.hibernate.binder.internal.BatchSizeBinder::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_PUBLIC_CONSTRUCTORS) }
      )
      hints.resources().registerPattern(&quot;liquibase/*&quot;)
      hints.reflection().registerType(
        liquibase.ui.LoggerUIService::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_PUBLIC_CONSTRUCTORS) }
      )
      hints.reflection().registerType(
        liquibase.database.LiquibaseTableNamesFactory::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS) }
      )
      hints.reflection().registerType(
        liquibase.report.ShowSummaryGeneratorFactory::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS) }
      )
      hints.reflection().registerType(
        liquibase.changelog.FastCheckService::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS) }
      )
      hints.reflection().registerType(
        liquibase.changelog.visitor.ValidatingVisitorGeneratorFactory::class.java,
        hint = hint@{ it.withMembers(MemberCategory.INVOKE_DECLARED_CONSTRUCTORS) }
      )
    }
  }
}</code></pre>
<h3>Main</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo;

import io.github.susimsek.springbootgraphqljwedemo.config.NativeConfig;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.ImportRuntimeHints;

@SpringBootApplication
@ImportRuntimeHints({ NativeConfig.AppNativeRuntimeHints.class })
public class SpringBootJweAuthJpaDemoApplication {

  public static void main(String[] args) {
    SpringApplication.run(SpringBootJweAuthJpaDemoApplication.class, args);
  }

}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo

import io.github.susimsek.springbootgraphqljwedemo.config.NativeConfig
import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.context.annotation.ImportRuntimeHints

@SpringBootApplication
@ImportRuntimeHints(NativeConfig.AppNativeRuntimeHints::class)
class SpringBootJweAuthJpaDemoApplication

fun main(args: Array&lt;String&gt;) {
  runApplication&lt;SpringBootJweAuthJpaDemoApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: JPA Entegrasyonu</h2>
<p>Bu b√∂l√ºmde, kullanƒ±cƒ±larƒ±, rollerleri ve bunlarƒ±n e≈ülemelerini temsil eden JPA entity‚Äôlerini ve kullanƒ±cƒ±larƒ± yetkileriyle birlikte y√ºklemek i√ßin Spring Data JPA deposunu tanƒ±mlƒ±yoruz.</p>
<ul>
<li>BaseEntity: Audit alanlarƒ± (`createdAt`, `createdBy`, `updatedAt`, `updatedBy`) saƒülayan soyut √ºst sƒ±nƒ±f.</li>
<li>Authority: Rol verilerini saklayan `authority` tablosu entity‚Äôsi.</li>
<li>User: Kullanƒ±cƒ± kimlik bilgileri ve profili saklayan `user_identity` tablosu entity‚Äôsi.</li>
<li>UserAuthorityMapping: Kullanƒ±cƒ±larƒ± ve rolleri birbirine baƒülayan `user_authority_mapping` ili≈üki tablosunun entity‚Äôsi.</li>
<li>UserAuthorityMappingId: `UserAuthorityMapping` i√ßin composite anahtar sƒ±nƒ±fƒ±.</li>
<li>UserRepository: Entity graph kullanarak kullanƒ±cƒ± ve yetkilerini getiren Spring Data JPA repository.</li>
</ul>
<h3>BaseEntity</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.entity;

import jakarta.persistence.Column;
import jakarta.persistence.EntityListeners;
import jakarta.persistence.MappedSuperclass;
import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;

import java.time.Instant;

@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
@Getter
@Setter
public abstract class BaseEntity {

  @CreatedDate
  @Column(name = &quot;created_at&quot;, nullable = false, updatable = false)
  private Instant createdAt;

  @CreatedBy
  @Column(name = &quot;created_by&quot;, nullable = false, updatable = false, length = 50)
  private String createdBy;

  @LastModifiedDate
  @Column(name = &quot;updated_at&quot;)
  private Instant updatedAt;

  @LastModifiedBy
  @Column(name = &quot;updated_by&quot;, length = 50)
  private String updatedBy;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.entity

import jakarta.persistence.Column
import jakarta.persistence.EntityListeners
import jakarta.persistence.MappedSuperclass
import org.springframework.data.annotation.CreatedBy
import org.springframework.data.annotation.CreatedDate
import org.springframework.data.annotation.LastModifiedBy
import org.springframework.data.annotation.LastModifiedDate
import org.springframework.data.jpa.domain.support.AuditingEntityListener
import java.time.Instant

@MappedSuperclass
@EntityListeners(AuditingEntityListener::class)
abstract class BaseEntity {

  @CreatedDate
  @Column(name = &quot;created_at&quot;, nullable = false, updatable = false)
  lateinit var createdAt: Instant

  @CreatedBy
  @Column(name = &quot;created_by&quot;, nullable = false, updatable = false, length = 50)
  lateinit var createdBy: String

  @LastModifiedDate
  @Column(name = &quot;updated_at&quot;)
  var updatedAt: Instant? = null

  @LastModifiedBy
  @Column(name = &quot;updated_by&quot;, length = 50)
  var updatedBy: String? = null
}</code></pre>
<h3>Authority</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import org.hibernate.proxy.HibernateProxy;

import java.util.Objects;

@Entity
@Table(name = &quot;authority&quot;)
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
public class Authority extends BaseEntity {

  @Id
  @Column(length = 36, nullable = false)
  private String id;

  @Column(length = 50, nullable = false, unique = true)
  private String name;

  @Column(length = 255)
  private String description;

  @Override
  public final boolean equals(Object obj) {
    if (this == obj) {
      return true;
    }
    if (!(obj instanceof Authority other)) {
      return false;
    }
    Class&lt;?&gt; objClass = obj instanceof HibernateProxy proxy
      ? proxy.getHibernateLazyInitializer().getPersistentClass()
      : obj.getClass();
    Class&lt;?&gt; thisClass = this instanceof HibernateProxy proxy
      ? proxy.getHibernateLazyInitializer().getPersistentClass()
      : this.getClass();
    if (!thisClass.equals(objClass)) {
      return false;
    }
    return id != null &amp;&amp; Objects.equals(id, other.id);
  }

  @Override
  public final int hashCode() {
    return this instanceof HibernateProxy proxy
      ? proxy.getHibernateLazyInitializer().getPersistentClass().hashCode()
      : getClass().hashCode();
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.entity

import jakarta.persistence.Column
import jakarta.persistence.Entity
import jakarta.persistence.Id
import jakarta.persistence.Table
import org.hibernate.proxy.HibernateProxy
import java.util.Objects

@Entity
@Table(name = &quot;authority&quot;)
class Authority(
  @Id
  @Column(length = 36, nullable = false)
  var id: String,

  @Column(length = 50, nullable = false, unique = true)
  var name: String,

  @Column(length = 255)
  var description: String?
) : BaseEntity() {

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other !is Authority) return false
    val objClass = (other as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass ?: other::class.java
    val thisClass = (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass ?: this::class.java
    if (thisClass != objClass) return false
    return id == other.id
  }

  override fun hashCode(): Int {
    return (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass?.hashCode()
      ?: javaClass.hashCode()
  }
}</code></pre>
<h3>User</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.entity;

import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.Id;
import jakarta.persistence.NamedAttributeNode;
import jakarta.persistence.NamedEntityGraph;
import jakarta.persistence.NamedSubgraph;
import jakarta.persistence.OneToMany;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import org.hibernate.proxy.HibernateProxy;

import java.util.HashSet;
import java.util.Objects;
import java.util.Set;

@Entity
@Table(name = &quot;user_identity&quot;)
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@NamedEntityGraph(
  name = &quot;User.withAuthorities&quot;,
  attributeNodes = @NamedAttributeNode(value = &quot;authorities&quot;, subgraph = &quot;auth-subgraph&quot;),
  subgraphs = @NamedSubgraph(
    name = &quot;auth-subgraph&quot;,
    attributeNodes = @NamedAttributeNode(&quot;authority&quot;)
  )
)
public class User extends BaseEntity {

  @Id
  @Column(name = &quot;id&quot;, length = 36, nullable = false, updatable = false)
  private String id;

  @Column(name = &quot;username&quot;, length = 50, nullable = false, unique = true)
  private String username;

  @Column(name = &quot;password&quot;, length = 100, nullable = false)
  private String password;

  @Column(name = &quot;email&quot;, length = 100, nullable = false, unique = true)
  private String email;

  @Column(name = &quot;first_name&quot;, length = 50)
  private String firstName;

  @Column(name = &quot;last_name&quot;, length = 50)
  private String lastName;

  @Column(name = &quot;enabled&quot;, nullable = false)
  private boolean enabled;

  @OneToMany(mappedBy = &quot;user&quot;, fetch = FetchType.LAZY,
    cascade = CascadeType.ALL, orphanRemoval = true)
  private Set&lt;UserAuthorityMapping&gt; authorities = new HashSet&lt;&gt;();

  @Override
  public final boolean equals(Object obj) {
    if (this == obj) return true;
    if (!(obj instanceof User other)) return false;
    Class&lt;?&gt; objClass = (obj instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : obj.getClass());
    Class&lt;?&gt; thisClass = (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : this.getClass());
    if (!thisClass.equals(objClass)) return false;
    return id != null &amp;&amp; id.equals(other.id);
  }

  @Override
  public final int hashCode() {
    return (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass().hashCode()
      : getClass().hashCode());
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.entity

import jakarta.persistence.CascadeType
import jakarta.persistence.Column
import jakarta.persistence.Entity
import jakarta.persistence.FetchType
import jakarta.persistence.Id
import jakarta.persistence.NamedAttributeNode
import jakarta.persistence.NamedEntityGraph
import jakarta.persistence.NamedSubgraph
import jakarta.persistence.OneToMany
import jakarta.persistence.Table
import org.hibernate.proxy.HibernateProxy
import java.util.*

@Entity
@Table(name = &quot;user_identity&quot;)
@NamedEntityGraph(
  name = &quot;User.withAuthorities&quot;,
  attributeNodes = [NamedAttributeNode(value = &quot;authorities&quot;, subgraph = &quot;auth-subgraph&quot;)],
  subgraphs = [
    NamedSubgraph(
      name = &quot;auth-subgraph&quot;,
      attributeNodes = [NamedAttributeNode(&quot;authority&quot;)]
    )
  ]
)
class User(

  @Id
  @Column(name = &quot;id&quot;, length = 36, nullable = false, updatable = false)
  var id: String,

  @Column(name = &quot;username&quot;, length = 50, nullable = false, unique = true)
  var username: String,

  @Column(name = &quot;password&quot;, length = 100, nullable = false)
  var password: String,

  @Column(name = &quot;email&quot;, length = 100, nullable = false, unique = true)
  var email: String,

  @Column(name = &quot;first_name&quot;, length = 50)
  var firstName: String? = null,

  @Column(name = &quot;last_name&quot;, length = 50)
  var lastName: String? = null,

  @Column(name = &quot;enabled&quot;, nullable = false)
  var enabled: Boolean = true

) : BaseEntity() {

  @OneToMany(
    mappedBy = &quot;user&quot;,
    fetch = FetchType.LAZY,
    cascade = [CascadeType.ALL],
    orphanRemoval = true
  )
  var authorities: MutableSet&lt;UserAuthorityMapping&gt; = HashSet()

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other !is User) return false
    val objClass = (other as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: other::class.java
    val thisClass = (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: this::class.java
    if (thisClass != objClass) return false
    return id == other.id
  }

  override fun hashCode(): Int =
    ((this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass?.hashCode()
      ?: javaClass.hashCode())
}</code></pre>
<h3>UserAuthorityMapping</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.Id;
import jakarta.persistence.IdClass;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToOne;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import org.hibernate.proxy.HibernateProxy;

import java.util.Objects;

@Entity
@Table(name = &quot;user_authority_mapping&quot;)
@IdClass(UserAuthorityMappingId.class)
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
public class UserAuthorityMapping extends BaseEntity {

  @Id
  @Column(name = &quot;user_id&quot;, length = 36, nullable = false)
  private String userId;

  @Id
  @Column(name = &quot;authority_id&quot;, length = 36, nullable = false)
  private String authorityId;

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;user_id&quot;, insertable = false, updatable = false)
  private User user;

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;authority_id&quot;, insertable = false, updatable = false)
  private Authority authority;

  @Override
  public final boolean equals(Object obj) {
    if (this == obj) return true;
    if (!(obj instanceof UserAuthorityMapping other)) return false;
    Class&lt;?&gt; objCls = (obj instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : obj.getClass());
    Class&lt;?&gt; thisCls = (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : this.getClass());
    if (!thisCls.equals(objCls)) return false;
    return userId != null &amp;&amp; userId.equals(other.userId)
      &amp;&amp; authorityId != null &amp;&amp; authorityId.equals(other.authorityId);
  }

  @Override
  public final int hashCode() {
    return (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass().hashCode()
      : Objects.hash(userId, authorityId));
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.entity

import jakarta.persistence.*
import org.hibernate.proxy.HibernateProxy
import java.util.*

@Entity
@Table(name = &quot;user_authority_mapping&quot;)
@IdClass(UserAuthorityMappingId::class)
data class UserAuthorityMapping(

  @Id
  @Column(name = &quot;user_id&quot;, length = 36, nullable = false)
  var userId: String = &quot;&quot;,

  @Id
  @Column(name = &quot;authority_id&quot;, length = 36, nullable = false)
  var authorityId: String = &quot;&quot;,

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;user_id&quot;, insertable = false, updatable = false)
  var user: User? = null,

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;authority_id&quot;, insertable = false, updatable = false)
  var authority: Authority? = null

) : BaseEntity() {

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other !is UserAuthorityMapping) return false

    val objCls = (other as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: other::class.java
    val thisCls = (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: this::class.java

    if (thisCls != objCls) return false
    return userId == other.userId &amp;&amp; authorityId == other.authorityId
  }

  override fun hashCode(): Int {
    return (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass?.hashCode()
      ?: Objects.hash(userId, authorityId)
  }
}</code></pre>
<h3>UserAuthorityMappingId</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.entity;

import java.io.Serializable;
import java.util.Objects;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
public class UserAuthorityMappingId implements Serializable {

  private String userId;
  private String authorityId;

  @Override
  public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;
    UserAuthorityMappingId that = (UserAuthorityMappingId) o;
    return Objects.equals(userId, that.userId) &amp;&amp;
      Objects.equals(authorityId, that.authorityId);
  }

  @Override
  public int hashCode() {
    return Objects.hash(userId, authorityId);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.entity

import java.io.Serializable
import java.util.Objects

data class UserAuthorityMappingId(
  var userId: String = &quot;&quot;,
  var authorityId: String = &quot;&quot;
) : Serializable {

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other == null || this::class != other::class) return false
    other as UserAuthorityMappingId
    return userId == other.userId &amp;&amp; authorityId == other.authorityId
  }

  override fun hashCode(): Int {
    return Objects.hash(userId, authorityId)
  }
}</code></pre>
<h3>UserRepository</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.repository;

import io.github.susimsek.springbootgraphqljwedemo.entity.User;
import org.springframework.data.jpa.repository.EntityGraph;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.util.Optional;

@Repository
public interface UserRepository extends JpaRepository&lt;User, String&gt; {

  @EntityGraph(&quot;User.withAuthorities&quot;)
  Optional&lt;User&gt; findOneWithAuthoritiesByUsername(String username);
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.repository

import io.github.susimsek.springbootgraphqljwedemo.entity.User
import org.springframework.data.jpa.repository.EntityGraph
import org.springframework.data.jpa.repository.JpaRepository
import org.springframework.stereotype.Repository
import java.util.Optional

@Repository
interface UserRepository : JpaRepository&lt;User, String&gt; {

  @EntityGraph(&quot;User.withAuthorities&quot;)
  fun findOneWithAuthoritiesByUsername(username: String): Optional&lt;User&gt;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: G√ºvenli JWE Token Yardƒ±mcƒ± Sƒ±nƒ±flarƒ± Olu≈üturun</h2>
<p>Bu b√∂l√ºmde, Spring Boot uygulamanƒ±zda JSON Web Encryption (JWE) tokenlarƒ± olu≈üturmak, ≈üifrelemek ve √ß√∂zmek i√ßin gerekli temel yardƒ±mcƒ± sƒ±nƒ±flarƒ± ve sabitleri tanƒ±mlƒ±yoruz. Ayrƒ±ca auditing entegrasyonu ve JPA tabanlƒ± UserDetailsService de ekliyoruz:</p>
<ul>
<li>AuthoritiesConstants: `ROLE_` √∂n ekiyle rol isimlerini merkezile≈ütirir.</li>
<li>CookieBearerTokenResolver: Bearer token‚Äôlarƒ± yetkilendirme ba≈ülƒ±klarƒ±ndan veya HTTP √ßerezlerinden √ß√∂zer.</li>
<li>CookieUtils: Yeni veya s√ºresi dolmu≈ü token‚Äôler i√ßin HTTP-only, secure `ResponseCookie` olu≈üturur ve `HttpHeaders` i√ßinden `accessToken` deƒüerini √ßƒ±kartƒ±r.</li>
<li>JweUtil: Nimbus k√ºt√ºphanesi ile RSA anahtarlarƒ± kullanarak JWT‚Äôleri imzalar (JWS) ve ≈üifreler (JWE).</li>
<li>KeyUtils: PEM formatƒ±ndaki anahtar √ßiftinden RSA JWK‚Äôleri olu≈üturur.</li>
<li>SecurityUtils: SecurityContext oturum a√ßan kullanƒ±cƒ±nƒ±n bilgisini sunar.</li>
<li>SpringSecurityAuditorAware: Auditing i√ßin oturum a√ßan kullanƒ±cƒ±yƒ± saƒülayan `AuditorAware` implementasyonu.</li>
<li>DomainUserDetailsService: JPA tabanlƒ± `UserDetailsService`, kullanƒ±cƒ± kimlik bilgilerini ve yetkilerini getirir.</li>
<li>GraphQlTokenCookieInterceptor: GraphQL yanƒ±tlarƒ±nƒ± yakalar ve `GraphQLContext` i√ßindeki `accessToken` veya `clearAccessToken` flaglerine g√∂re eri≈üim √ßerezini olu≈üturur veya siler.</li>
<li>CookieAuthenticationWebSocketInterceptor: Headerdan veya √ßerezlerden alƒ±nan JWE token‚Äôlarla WebSocket baƒülantƒ±larƒ±nƒ± doƒürular.</li>
</ul>
<p>Bu yardƒ±mcƒ±lar, Spring Security ile durumsuz (stateless) JWE tabanlƒ± bir kimlik doƒürulama akƒ±≈üƒ±nƒ±n temelini olu≈üturur.</p>
<h3>AuthoritiesConstants</h3>
<h3>Java</h3>
<pre><code class="language-java">
package io.github.susimsek.springbootgraphqljwedemo.security;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class AuthoritiesConstants {
    public static final String ADMIN = &quot;ROLE_ADMIN&quot;;
    public static final String USER = &quot;ROLE_USER&quot;;
    public static final String ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">
package io.github.susimsek.springbootgraphqljwedemo.security

object AuthoritiesConstants {
  const val ADMIN = &quot;ROLE_ADMIN&quot;
  const val USER = &quot;ROLE_USER&quot;
  const val ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;
}</code></pre>
<h3>CookieBearerTokenResolver</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletRequest;
import lombok.Setter;
import org.springframework.http.HttpMethod;
import org.springframework.security.oauth2.core.OAuth2AuthenticationException;
import org.springframework.security.oauth2.server.resource.BearerTokenError;
import org.springframework.security.oauth2.server.resource.BearerTokenErrors;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;
import org.springframework.util.StringUtils;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

@Setter
public class CookieBearerTokenResolver implements BearerTokenResolver {
    private static final String ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;;
    private static final Pattern AUTHORIZATION_PATTERN =
        Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE);

    private boolean allowFormEncodedBodyParameter = false;
    private boolean allowUriQueryParameter       = false;
    private boolean allowCookie                  = true;
    private String  bearerTokenHeaderName       = &quot;Authorization&quot;;
    private String  cookieName                  = &quot;accessToken&quot;;

    @Override
    public String resolve(HttpServletRequest request) {
        String headerToken = resolveFromAuthorizationHeader(request);
        String queryToken  = resolveAccessTokenFromQueryString(request);
        String bodyToken   = resolveAccessTokenFromBody(request);
        String cookieToken = (headerToken == null &amp;&amp; queryToken == null &amp;&amp; bodyToken == null)
            ? resolveFromCookie(request)
            : null;

        return resolveToken(headerToken, queryToken, bodyToken, cookieToken);
    }

    private String resolveFromAuthorizationHeader(HttpServletRequest request) {
        String authorization = request.getHeader(this.bearerTokenHeaderName);
        if (!StringUtils.hasText(authorization) || !authorization.toLowerCase().startsWith(&quot;bearer&quot;)) {
            return null;
        }
        Matcher matcher = AUTHORIZATION_PATTERN.matcher(authorization.trim());
        if (!matcher.matches()) {
            BearerTokenError error = BearerTokenErrors.invalidToken(&quot;Bearer token is malformed&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return matcher.group(&quot;token&quot;);
    }

    private String resolveAccessTokenFromQueryString(HttpServletRequest request) {
        if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.getMethod())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveAccessTokenFromBody(HttpServletRequest request) {
        if (allowFormEncodedBodyParameter
            &amp;&amp; HttpMethod.POST.matches(request.getMethod())
            &amp;&amp; &quot;application/x-www-form-urlencoded&quot;.equals(request.getContentType())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveFromCookie(HttpServletRequest request) {
        if (!allowCookie || request.getCookies() == null) {
            return null;
        }
        for (Cookie cookie : request.getCookies()) {
            if (cookieName.equals(cookie.getName())) {
                String val = cookie.getValue();
                return StringUtils.hasText(val) ? val : null;
            }
        }
        return null;
    }

    private String resolveToken(String... tokens) {
        String found = null;
        for (String token : tokens) {
            if (token == null) continue;
            if (found != null) {
                BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens in the request&quot;);
                throw new OAuth2AuthenticationException(error);
            }
            found = token;
        }
        if (found != null &amp;&amp; found.isBlank()) {
            BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;The requested token parameter is an empty string&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return found;
    }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import jakarta.servlet.http.Cookie
import jakarta.servlet.http.HttpServletRequest
import org.springframework.http.HttpMethod
import org.springframework.security.oauth2.core.OAuth2AuthenticationException
import org.springframework.security.oauth2.server.resource.BearerTokenError
import org.springframework.security.oauth2.server.resource.BearerTokenErrors
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver
import org.springframework.util.StringUtils
import java.util.regex.Pattern

class CookieBearerTokenResolver {
    var allowFormEncodedBodyParameter: Boolean = false
    var allowUriQueryParameter: Boolean = false
    var allowCookie: Boolean = true
    var bearerTokenHeaderName: String = &quot;Authorization&quot;
    var cookieName: String = &quot;accessToken&quot;

    companion object {
        private const val ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;
        private val AUTHORIZATION_PATTERN =
            Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE)
    }

    fun resolve(request: HttpServletRequest): String? {
        val header = resolveFromAuthorizationHeader(request)
        val query  = if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.method))
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val body   = if (allowFormEncodedBodyParameter &amp;&amp; HttpMethod.POST.matches(request.method)
            &amp;&amp; request.contentType == &quot;application/x-www-form-urlencoded&quot;)
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val cookie = if (header == null &amp;&amp; query == null &amp;&amp; body == null)
            resolveFromCookie(request)
        else null
      return listOf(header, query, body, cookie).filterNotNull().let {
            if (it.size &gt; 1) throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens&quot;))
            it.firstOrNull()?: null
        }
    }

    private fun resolveFromAuthorizationHeader(request: HttpServletRequest): String? {
        val auth = request.getHeader(bearerTokenHeaderName) ?: return null
        if (!auth.startsWith(&quot;Bearer &quot;, true)) return null
        val matcher = AUTHORIZATION_PATTERN.matcher(auth.trim())
        return if (matcher.matches()) matcher.group(&quot;token&quot;)
        else throw OAuth2AuthenticationException(BearerTokenErrors.invalidToken(&quot;Malformed token&quot;))
    }

    private fun resolveFromCookie(request: HttpServletRequest): String? {
        if (!allowCookie) return null
        return request.cookies?.firstOrNull { it.name == cookieName }?.value?.takeIf { it.isNotBlank() }
    }

    private fun resolveToken(tokens: Array&lt;String&gt;): String? {
        return tokens.filter { it.isNotBlank() }.let {
            when {
                it.isEmpty() -&gt; null
                it.size &gt; 1   -&gt; throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Multiple tokens&quot;))
                else          -&gt; it[0]
            }
        }
    }</code></pre>
<h3>CookieUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO;
import lombok.experimental.UtilityClass;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseCookie;

import java.net.HttpCookie;
import java.util.Arrays;
import java.util.Optional;

@UtilityClass
public class CookieUtils {

  public static final String COOKIE_NAME = &quot;accessToken&quot;;

  public ResponseCookie createAccessTokenCookie(TokenDTO tokenDto) {
    return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(tokenDto.accessTokenExpiresIn())
      .sameSite(&quot;Strict&quot;)
      .build();
  }

  public static ResponseCookie removeAccessTokenCookie() {
    return ResponseCookie.from(COOKIE_NAME, &quot;&quot;)
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(0)
      .sameSite(&quot;Strict&quot;)
      .build();
  }

  public String resolveToken(HttpHeaders headers) {
    return Optional.ofNullable(headers.getFirst(HttpHeaders.COOKIE))
      .map(h -&gt; h.split(&quot;;&quot;))
      .stream()
      .flatMap(Arrays::stream)
      .flatMap(part -&gt; HttpCookie.parse(part).stream())
      .filter(c -&gt; COOKIE_NAME.equals(c.getName()))
      .map(HttpCookie::getValue)
      .findFirst()
      .orElse(null);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO
import org.springframework.http.HttpHeaders
import org.springframework.http.ResponseCookie
import java.net.HttpCookie

object CookieUtils {

  const val COOKIE_NAME = &quot;accessToken&quot;

  fun createAccessTokenCookie(tokenDto: TokenDTO): ResponseCookie =
    ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(tokenDto.accessTokenExpiresIn())
      .sameSite(&quot;Strict&quot;)
      .build()

  fun removeAccessTokenCookie(): ResponseCookie =
    ResponseCookie.from(COOKIE_NAME, &quot;&quot;)
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(0)
      .sameSite(&quot;Strict&quot;)
      .build()

  fun resolveToken(headers: HttpHeaders): String? =
    headers.getFirst(HttpHeaders.COOKIE)
      ?.split(&quot;;&quot;)
      .orEmpty()
      .asSequence()
      .flatMap { HttpCookie.parse(it).asSequence() }
      .firstOrNull { it.name == COOKIE_NAME }
      ?.value
}</code></pre>
<h3>JweUtil</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JOSEException;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWEHeader;
import com.nimbusds.jose.JWEObject;
import com.nimbusds.jose.Payload;
import com.nimbusds.jose.crypto.RSAEncrypter;
import com.nimbusds.jose.jwk.RSAKey;
import io.github.susimsek.springbootgraphqljwedemo.config.JwtProperties;
import io.github.susimsek.springbootgraphqljwedemo.dto.TokenDTO;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm;
import org.springframework.security.oauth2.jwt.*;
import org.springframework.stereotype.Component;

import java.time.Instant;
import java.util.List;

import static io.github.susimsek.springbootgraphqljwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Component
@RequiredArgsConstructor
public class JweUtil {

    private final JwtEncoder jwtEncoder;
    private final RSAKey signingKey;
    private final RSAKey encryptionKey;
    private final JwtProperties props;

    public TokenDTO generateToken(Authentication authentication) throws JOSEException {
        String subject = authentication.getName();
        List&lt;String&gt; roles = authentication.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority)
            .toList();

        Instant now = Instant.now();
        long expiresIn = props.getExpirationDuration().getSeconds();
        Instant exp = now.plusSeconds(expiresIn);

        JwtClaimsSet claims = JwtClaimsSet.builder()
            .issuer(props.getIssuer())
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build();

        JwsHeader jwsHeader = JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.getKeyID())
            .build();

        String jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .getTokenValue();

        JWEHeader jweHeader = new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.getKeyID())
            .build();

        JWEObject jweObject = new JWEObject(jweHeader, new Payload(jws));
        jweObject.encrypt(new RSAEncrypter(encryptionKey.toRSAPublicKey()));
        String token = jweObject.serialize();

        return new TokenDTO(token, &quot;Bearer&quot;, expiresIn);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JOSEException
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWEHeader
import com.nimbusds.jose.JWEObject
import com.nimbusds.jose.Payload
import com.nimbusds.jose.crypto.RSAEncrypter
import com.nimbusds.jose.jwk.RSAKey
import io.github.susimsek.springbootgraphqljwedemo.config.JwtProperties
import io.github.susimsek.springbootgraphqljwedemo.dto.TokenDTO
import lombok.RequiredArgsConstructor
import org.springframework.security.core.Authentication
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm
import org.springframework.security.oauth2.jwt.JwtClaimsSet
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.JwtEncoderParameters
import org.springframework.stereotype.Component

import java.time.Instant

@Component
@RequiredArgsConstructor
class JweUtil(
    private val jwtEncoder: JwtEncoder,
    private val signingKey: RSAKey,
    private val encryptionKey: RSAKey,
    private val props: JwtProperties
) {
    fun generateToken(authentication: Authentication): TokenDTO {
        val subject = authentication.name
        val roles = authentication.authorities.map { it.authority }

        val now = Instant.now()
        val expiresIn = props.expirationDuration.seconds
        val exp = now.plusSeconds(expiresIn)

        val claims = JwtClaimsSet.builder()
            .issuer(props.issuer)
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build()

        val jwsHeader = org.springframework.security.oauth2.jwt.JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.keyID)
            .build()

        val jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .tokenValue

        val jweHeader = JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.keyID)
            .build()

        val jweObject = JWEObject(jweHeader, Payload(jws))
        jweObject.encrypt(RSAEncrypter(encryptionKey.toRSAPublicKey()))
        val token = jweObject.serialize()

        return TokenDTO(token, &quot;Bearer&quot;, expiresIn)
    }
}</code></pre>
<h3>KeyUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.KeyUse;
import com.nimbusds.jose.jwk.RSAKey;
import lombok.experimental.UtilityClass;

import java.security.KeyFactory;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.util.Base64;

@UtilityClass
public class KeyUtils {
    public RSAKey buildRsaKey(
            String pubPem,
            String privPem,
            String kid,
            boolean forSign
    ) throws Exception {
        String pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);
        String privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);

        byte[] decodedPub = Base64.getDecoder().decode(pubContent);
        byte[] decodedPriv = Base64.getDecoder().decode(privContent);

        KeyFactory kf = KeyFactory.getInstance(&quot;RSA&quot;);
        RSAPublicKey publicKey = (RSAPublicKey) kf.generatePublic(new X509EncodedKeySpec(decodedPub));
        RSAPrivateKey privateKey = (RSAPrivateKey) kf.generatePrivate(new PKCS8EncodedKeySpec(decodedPriv));

        RSAKey.Builder builder = new RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid);

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE);
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION);
        }

        return builder.build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.KeyUse
import com.nimbusds.jose.jwk.RSAKey
import java.security.KeyFactory
import java.security.interfaces.RSAPrivateKey
import java.security.interfaces.RSAPublicKey
import java.security.spec.PKCS8EncodedKeySpec
import java.security.spec.X509EncodedKeySpec
import java.util.Base64

object KeyUtils {
    @JvmStatic
    @Throws(Exception::class)
    fun buildRsaKey(
        pubPem: String,
        privPem: String,
        kid: String,
        forSign: Boolean
    ): RSAKey {
        val pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)
        val privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)

        val decodedPub = Base64.getDecoder().decode(pubContent)
        val decodedPriv = Base64.getDecoder().decode(privContent)

        val kf = KeyFactory.getInstance(&quot;RSA&quot;)
        val publicKey = kf.generatePublic(X509EncodedKeySpec(decodedPub)) as RSAPublicKey
        val privateKey = kf.generatePrivate(PKCS8EncodedKeySpec(decodedPriv)) as RSAPrivateKey

        val builder = RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid)

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE)
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION)
        }

        return builder.build()
    }
}</code></pre>
<h3>SecurityUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import lombok.experimental.UtilityClass;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.oauth2.jwt.Jwt;

import java.util.Optional;

@UtilityClass
public class SecurityUtils {

    public static final String AUTHORITIES_KEY = &quot;auth&quot;;

    public Optional&lt;String&gt; getCurrentUserLogin() {
        var ctx = SecurityContextHolder.getContext();
        return Optional.ofNullable(extractPrincipal(ctx.getAuthentication()));
    }

    private String extractPrincipal(Authentication authentication) {
        if (authentication == null) {
            return null;
        }
        Object principal = authentication.getPrincipal();
        if (principal instanceof Jwt jwt) {
            return jwt.getSubject();
        }
        if (principal instanceof UserDetails ud) {
            return ud.getUsername();
        }
        if (principal instanceof String username) {
            return username;
        }
        return null;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.security.core.userdetails.UserDetails
import org.springframework.security.oauth2.jwt.Jwt
import java.util.Optional

object SecurityUtils {
  const val AUTHORITIES_KEY = &quot;auth&quot;

  fun getCurrentUserLogin(): Optional&lt;String&gt; {
    val authentication: Authentication? = SecurityContextHolder.getContext().authentication
    return Optional.ofNullable(extractPrincipal(authentication))
  }

  private fun extractPrincipal(authentication: Authentication?): String? {
    return when (val principal = authentication?.principal) {
      is Jwt -&gt; principal.subject
      is UserDetails -&gt; principal.username
      is String -&gt; principal
      else -&gt; null
    }
  }
}</code></pre>
<h3>DomainUserDetailsService</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import io.github.susimsek.springbootgraphqljwedemo.entity.User;
import io.github.susimsek.springbootgraphqljwedemo.repository.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;

import java.util.List;
import java.util.stream.Collectors;

@RequiredArgsConstructor
public class DomainUserDetailsService implements UserDetailsService {

  private final UserRepository userRepository;

  @Override
  public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
    User user = userRepository.findOneWithAuthoritiesByUsername(username)
      .orElseThrow(() -&gt; new UsernameNotFoundException(&quot;User not found with username: &quot; + username));

    List&lt;GrantedAuthority&gt; authorities = user.getAuthorities().stream()
      .map(mapping -&gt; mapping.getAuthority().getName())
      .map(SimpleGrantedAuthority::new)
      .collect(Collectors.toList());

    return new org.springframework.security.core.userdetails.User(
      user.getUsername(),
      user.getPassword(),
      user.isEnabled(),  // enabled
      true,              // accountNonExpired
      true,              // credentialsNonExpired
      true,              // accountNonLocked
      authorities
    );
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import io.github.susimsek.springbootgraphqljwedemo.repository.UserRepository
import org.springframework.security.core.GrantedAuthority
import org.springframework.security.core.authority.SimpleGrantedAuthority
import org.springframework.security.core.userdetails.UserDetails
import org.springframework.security.core.userdetails.UserDetailsService
import org.springframework.security.core.userdetails.UsernameNotFoundException
import java.util.stream.Collectors

class DomainUserDetailsService(
  private val userRepository: UserRepository
) : UserDetailsService {
  override fun loadUserByUsername(username: String): UserDetails {
    val user = userRepository.findOneWithAuthoritiesByUsername(username)
      .orElseThrow { UsernameNotFoundException(&quot;User not found with username: $username&quot;) }

    val authorities: List&lt;GrantedAuthority&gt; = user.authorities.stream()
      .map { SimpleGrantedAuthority(it.authority.name) }
      .collect(Collectors.toList())

    return org.springframework.security.core.userdetails.User(
      user.username,
      user.password,
      user.enabled,
      true,
      true,
      true,
      authorities
    )
  }
}</code></pre>
<h3>SpringSecurityAuditorAware</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import org.springframework.data.domain.AuditorAware;
import org.springframework.lang.NonNull;
import org.springframework.stereotype.Component;

import java.util.Optional;

@Component
public class SpringSecurityAuditorAware implements AuditorAware&lt;String&gt; {

  @Override
  @NonNull
  public Optional&lt;String&gt; getCurrentAuditor() {
    return Optional.of(SecurityUtils.getCurrentUserLogin().orElse(&quot;system&quot;));
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import org.springframework.data.domain.AuditorAware
import org.springframework.lang.NonNull
import org.springframework.stereotype.Component

@Component
class SpringSecurityAuditorAware : AuditorAware&lt;String&gt; {
    @NonNull
    override fun getCurrentAuditor(): Optional&lt;String&gt; =
        Optional.of(SecurityUtils.getCurrentUserLogin().orElse(&quot;system&quot;))
}</code></pre>
<h3>GraphQlTokenCookieInterceptor</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import graphql.GraphQLContext;
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO;
import org.springframework.graphql.server.WebGraphQlInterceptor;
import org.springframework.graphql.server.WebGraphQlRequest;
import org.springframework.graphql.server.WebGraphQlResponse;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseCookie;
import org.springframework.lang.NonNull;
import org.springframework.stereotype.Component;
import reactor.core.publisher.Mono;

@Component
public class GraphQlTokenCookieInterceptor implements WebGraphQlInterceptor {

  @Override
  @NonNull
  public Mono&lt;WebGraphQlResponse&gt; intercept(@NonNull WebGraphQlRequest request, Chain chain) {
    return chain.next(request)
      .doOnNext(response -&gt; {
        GraphQLContext ctx = response.getExecutionInput().getGraphQLContext();

        if (Boolean.TRUE.equals(ctx.get(&quot;clearAccessToken&quot;))) {
          ResponseCookie expired = CookieUtils.removeAccessTokenCookie();
          response.getResponseHeaders().add(HttpHeaders.SET_COOKIE, expired.toString());
          return;
        }

        TokenDTO tokenDto = ctx.get(&quot;accessToken&quot;);
        if (tokenDto != null) {
          ResponseCookie cookie = CookieUtils.createAccessTokenCookie(tokenDto);
          response.getResponseHeaders()
            .add(HttpHeaders.SET_COOKIE, cookie.toString());
        }
      });
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import graphql.GraphQLContext
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO
import org.springframework.graphql.server.WebGraphQlInterceptor
import org.springframework.graphql.server.WebGraphQlRequest
import org.springframework.graphql.server.WebGraphQlResponse
import org.springframework.http.HttpHeaders
import org.springframework.http.ResponseCookie
import org.springframework.stereotype.Component
import reactor.core.publisher.Mono

@Component
class GraphQlTokenCookieInterceptor : WebGraphQlInterceptor {

  override fun intercept(
    request: WebGraphQlRequest,
    chain: WebGraphQlInterceptor.Chain
  ): Mono&lt;WebGraphQlResponse&gt; {
    return chain.next(request)
      .doOnNext { response -&gt;
        val ctx: GraphQLContext = response.executionInput.graphQLContext

        if (ctx.get&lt;Boolean&gt;(&quot;clearAccessToken&quot;) == true) {
          val expired: ResponseCookie = CookieUtils.removeAccessTokenCookie()
          response.responseHeaders.add(HttpHeaders.SET_COOKIE, expired.toString())
          return@doOnNext
        }

        ctx.get&lt;TokenDTO&gt;(&quot;accessToken&quot;)?.let { tokenDto -&gt;
          val cookie: ResponseCookie = CookieUtils.createAccessTokenCookie(tokenDto)
          response.responseHeaders.add(HttpHeaders.SET_COOKIE, cookie.toString())
        }
      }
  }
}</code></pre>
<h3>CookieAuthenticationWebSocketInterceptor</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.security;

import io.github.susimsek.springbootgraphqljwedemo.security.CookieUtils;
import lombok.RequiredArgsConstructor;
import org.springframework.graphql.server.WebGraphQlInterceptor;
import org.springframework.graphql.server.WebGraphQlRequest;
import org.springframework.graphql.server.WebGraphQlResponse;
import org.springframework.graphql.server.WebSocketGraphQlInterceptor;
import org.springframework.graphql.server.WebSocketGraphQlRequest;
import org.springframework.graphql.server.WebSocketSessionInfo;
import org.springframework.graphql.server.support.AuthenticationExtractor;
import org.springframework.lang.NonNull;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContext;
import org.springframework.security.core.context.SecurityContextImpl;
import org.springframework.security.oauth2.server.resource.authentication.BearerTokenAuthenticationToken;
import reactor.core.publisher.Mono;
import reactor.util.context.Context;
import reactor.util.context.ContextView;

import java.util.Map;

@RequiredArgsConstructor
public class CookieAuthenticationWebSocketInterceptor implements WebSocketGraphQlInterceptor {

  private final String authenticationAttribute = this.getClass().getName() + &quot;.AUTHENTICATION&quot;;
  private final AuthenticationExtractor authExtractor;
  private final AuthenticationManager authenticationManager;

  @Override
  @NonNull
  public Mono&lt;Object&gt; handleConnectionInitialization(@NonNull WebSocketSessionInfo info,
                                                     @NonNull Map&lt;String, Object&gt; payload) {

    Mono&lt;Authentication&gt; headerAuth = authExtractor.getAuthentication(payload);

    Mono&lt;Authentication&gt; cookieAuth = Mono.defer(() -&gt; {
      String token = CookieUtils.resolveToken(info.getHeaders());
      return token != null
        ? Mono.just(new BearerTokenAuthenticationToken(token))
        : Mono.empty();
    });

    return headerAuth
      .switchIfEmpty(cookieAuth)
      .flatMap(this::authenticate)
      .doOnNext(auth -&gt; {
        SecurityContext securityContext = new SecurityContextImpl(auth);
        info.getAttributes().put(this.authenticationAttribute, securityContext);
      })
      .then(Mono.empty());
  }

  @Override
  @NonNull
  public Mono&lt;WebGraphQlResponse&gt; intercept(@NonNull WebGraphQlRequest request,
                                            @NonNull WebGraphQlInterceptor.Chain chain) {
    if (request instanceof WebSocketGraphQlRequest webSocketRequest) {
      Map&lt;String, Object&gt; attributes = webSocketRequest.getSessionInfo().getAttributes();
      SecurityContext securityContext = (SecurityContext) attributes.get(this.authenticationAttribute);
      ContextView contextView = this.getContextToWrite(securityContext);
      return chain.next(request).contextWrite(contextView);
    } else {
      return chain.next(request);
    }
  }

  protected Mono&lt;Authentication&gt; authenticate(Authentication authentication) {
    return Mono.just(this.authenticationManager.authenticate(authentication));
  }

  protected ContextView getContextToWrite(SecurityContext securityContext) {
    return Context.of(SecurityContext.class.getName(), securityContext);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.security

import io.github.susimsek.springbootgraphqljwedemo.security.CookieUtils
import org.springframework.graphql.server.WebGraphQlInterceptor
import org.springframework.graphql.server.WebGraphQlRequest
import org.springframework.graphql.server.WebGraphQlResponse
import org.springframework.graphql.server.WebSocketGraphQlInterceptor
import org.springframework.graphql.server.WebSocketGraphQlRequest
import org.springframework.graphql.server.WebSocketSessionInfo
import org.springframework.graphql.server.support.AuthenticationExtractor
import org.springframework.lang.NonNull
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContext
import org.springframework.security.core.context.SecurityContextImpl
import org.springframework.security.oauth2.server.resource.authentication.BearerTokenAuthenticationToken
import reactor.core.publisher.Mono
import reactor.util.context.Context
import reactor.util.context.ContextView

class CookieAuthenticationWebSocketInterceptor(
  private val authExtractor: AuthenticationExtractor,
  private val authenticationManager: AuthenticationManager
) : WebSocketGraphQlInterceptor {

  private val authenticationAttribute: String = &quot;${this::class.java.name}.AUTHENTICATION&quot;

  @NonNull
  override fun handleConnectionInitialization(
    @NonNull info: WebSocketSessionInfo,
    @NonNull payload: Map&lt;String, Any&gt;
  ): Mono&lt;Any&gt; {
    val headerAuth: Mono&lt;Authentication&gt; = authExtractor.getAuthentication(payload)

    val cookieAuth: Mono&lt;Authentication&gt; = Mono.defer {
      val token = CookieUtils.resolveToken(info.headers)
      if (token != null) {
        Mono.just(BearerTokenAuthenticationToken(token))
      } else {
        Mono.empty()
      }
    }

    return headerAuth
      .switchIfEmpty(cookieAuth)
      .flatMap { authenticate(it) }
      .doOnNext { auth -&gt;
        val securityContext = SecurityContextImpl(auth)
        info.attributes[authenticationAttribute] = securityContext
      }
      .then(Mono.empty())
  }

  @NonNull
  override fun intercept(
    @NonNull request: WebGraphQlRequest,
    @NonNull chain: WebGraphQlInterceptor.Chain
  ): Mono&lt;WebGraphQlResponse&gt; {
    return if (request is WebSocketGraphQlRequest) {
      val attributes = request.sessionInfo.attributes
      val securityContext = attributes[authenticationAttribute] as SecurityContext
      val contextView: ContextView = getContextToWrite(securityContext)
      chain.next(request).contextWrite(contextView)
    } else {
      chain.next(request)
    }
  }

  protected fun authenticate(authentication: Authentication): Mono&lt;Authentication&gt; =
    Mono.just(authenticationManager.authenticate(authentication))

  protected fun getContextToWrite(securityContext: SecurityContext): ContextView =
    Context.of(SecurityContext::class.java.name, securityContext)
}</code></pre>
<hr />
<h2>üß™ Adƒ±m 6: Kimlik Doƒürulama ve G√ºvenli Endpointler</h2>
<p>Bu b√∂l√ºmde, a≈üaƒüƒ±daki GraphQL controller ve DTO‚Äôlarƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>AuthController: Kullanƒ±cƒ±larƒ± doƒürular, JWE token&#39;ƒ± GraphQL mutationu ile olu≈üturur ve GraphQLContext i√ßine `accessToken` veya `clearAccessToken` flaglerini ekler.</li>
<li>HelloController: Kimliƒüi doƒürulanmƒ±≈ü kullanƒ±cƒ±lar ve yalnƒ±zca adminin eri≈üebileceƒüi GraphQL query, subscription ve mutationlarƒ± sunar.</li>
<li>LoginInput: Login i≈ülemi i√ßin (kullanƒ±cƒ± adƒ±/≈üifre) GraphQL input tipi.</li>
<li>GreetInput &amp; GreetDTO: greet mutationu i√ßin GraphQL input ve yanƒ±t tipi.</li>
<li>TokenDTO: Token, t√ºr ve ge√ßerlilik s√ºresini i√ßeren JWE token yanƒ±t modelidir.</li>
</ul>
<p>Bu bile≈üenler, JWE token‚Äôlarƒ± ve JPA yƒ± kullanarak GraphQL API‚Äôde stateless kimlik doƒürulama akƒ±≈üƒ±nƒ± tamamlar.</p>
<h3>AuthController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.controller;

import graphql.GraphQLContext;
import io.github.susimsek.springbootjweauthjpademo.dto.LoginInput;
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO;
import io.github.susimsek.springbootjweauthjpademo.security.JweUtil;
import lombok.RequiredArgsConstructor;
import org.springframework.graphql.data.method.annotation.Argument;
import org.springframework.graphql.data.method.annotation.MutationMapping;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Controller;

@Controller
@RequiredArgsConstructor
public class AuthController {

  private final AuthenticationManager authenticationManager;
  private final JweUtil jweUtil;

  @MutationMapping
  public TokenDTO login(@Argument LoginInput input,
                        GraphQLContext context) {
    // Authenticate user
    Authentication auth = authenticationManager.authenticate(
      new UsernamePasswordAuthenticationToken(input.username(), input.password())
    );
    SecurityContextHolder.getContext().setAuthentication(auth);

    // Generate JWE token
    TokenDTO tokenDto = jweUtil.generateToken(auth);

    // Store token in GraphQLContext for the interceptor to set cookie
    context.put(&quot;accessToken&quot;, tokenDto);

    return tokenDto;
  }

  @PreAuthorize(&quot;isAuthenticated()&quot;)
  @MutationMapping
  public Boolean logout(GraphQLContext context) {
    // Signal the interceptor to clear the cookie
    context.put(&quot;clearAccessToken&quot;, Boolean.TRUE);
    return true;
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.controller

import graphql.GraphQLContext
import io.github.susimsek.springbootjweauthjpademo.dto.LoginInput
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO
import io.github.susimsek.springbootjweauthjpademo.security.JweUtil
import org.springframework.graphql.data.method.annotation.Argument
import org.springframework.graphql.data.method.annotation.MutationMapping
import org.springframework.security.access.prepost.PreAuthorize
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.stereotype.Controller

@Controller
class AuthController(
  private val authenticationManager: AuthenticationManager,
  private val jweUtil: JweUtil
) {

  @MutationMapping
  fun login(
    @Argument input: LoginInput,
    context: GraphQLContext
  ): TokenDTO {
    // Authenticate user
    val auth = authenticationManager.authenticate(
      UsernamePasswordAuthenticationToken(input.username, input.password)
    )
    SecurityContextHolder.getContext().authentication = auth

    // Generate JWE token
    val tokenDto = jweUtil.generateToken(auth)

    // Store token in GraphQLContext for the interceptor to set cookie
    context.put(&quot;accessToken&quot;, tokenDto)

    return tokenDto
  }

  @PreAuthorize(&quot;isAuthenticated()&quot;)
  @MutationMapping
  fun logout(context: GraphQLContext): Boolean {
    // Signal the interceptor to clear the cookie
    context.put(&quot;clearAccessToken&quot;, true)
    return true
  }
}</code></pre>
<h3>HelloController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.controller;

import io.github.susimsek.springbootgraphqljwedemo.dto.GreetDTO;
import io.github.susimsek.springbootgraphqljwedemo.dto.GreetInput;
import lombok.RequiredArgsConstructor;
import org.springframework.graphql.data.method.annotation.Argument;
import org.springframework.graphql.data.method.annotation.MutationMapping;
import org.springframework.graphql.data.method.annotation.QueryMapping;
import org.springframework.graphql.data.method.annotation.SubscriptionMapping;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.oauth2.jwt.Jwt;
import org.springframework.stereotype.Controller;
import reactor.core.publisher.Flux;

import java.time.Duration;
import java.time.Instant;

import static io.github.susimsek.springbootgraphqljwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Controller
@RequiredArgsConstructor
@PreAuthorize(&quot;isAuthenticated()&quot;)
public class HelloController {

  @QueryMapping
  public String helloAll(@AuthenticationPrincipal Jwt jwt) {
    var roles = jwt.getClaimAsStringList(AUTHORITIES_KEY);
    return &quot;Hello, &quot; + jwt.getSubject() + &quot;! Your roles: &quot; + roles;
  }

  @PreAuthorize(&quot;hasAuthority(&#39;ROLE_ADMIN&#39;)&quot;)
  @QueryMapping
  public String helloAdmin(@AuthenticationPrincipal Jwt jwt) {
    return &quot;Hello Admin, &quot; + jwt.getSubject() + &quot;!&quot;;
  }

  @MutationMapping
  public GreetDTO greet(
    @Argument GreetInput input,
    @AuthenticationPrincipal Jwt jwt
  ) {
    String msg = &quot;Hello &quot; + jwt.getSubject() + &quot;, you said: &quot; + input.getMessage();
    return new GreetDTO(msg, Instant.now());
  }

  @SubscriptionMapping(&quot;greetStream&quot;)
  public Flux&lt;GreetDTO&gt; greetStream(
    @Argument GreetInput input,
    @AuthenticationPrincipal Jwt jwt
  ) {
    return Flux.interval(Duration.ofSeconds(1))
      .map(i -&gt; {
        String msg = &quot;Hello &quot; + jwt.getSubject()
          + &quot;, you said: &quot; + input.getMessage()
          + &quot; (event &quot; + (i + 1) + &quot;)&quot;;
        return new GreetDTO(msg, Instant.now());
      });
  }

  @PreAuthorize(&quot;hasAuthority(&#39;ROLE_ADMIN&#39;)&quot;)
  @SubscriptionMapping(&quot;greetStreamAdmin&quot;)
  public Flux&lt;GreetDTO&gt; greetStreamAdmin(
    @Argument GreetInput input,
    @AuthenticationPrincipal Jwt jwt
  ) {
    return Flux.interval(Duration.ofSeconds(2))
      .map(i -&gt; {
        String msg = &quot;Hello Admin &quot; + jwt.getSubject()
          + &quot;, you said: &quot; + input.getMessage()
          + &quot; (admin event &quot; + (i + 1) + &quot;)&quot;;
        return new GreetDTO(msg, Instant.now());
      });
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.controller

import io.github.susimsek.springbootgraphqljwedemo.dto.GreetDTO
import io.github.susimsek.springbootgraphqljwedemo.dto.GreetInput
import org.springframework.graphql.data.method.annotation.Argument
import org.springframework.graphql.data.method.annotation.MutationMapping
import org.springframework.graphql.data.method.annotation.QueryMapping
import org.springframework.graphql.data.method.annotation.SubscriptionMapping
import org.springframework.security.access.prepost.PreAuthorize
import org.springframework.security.core.annotation.AuthenticationPrincipal
import org.springframework.security.oauth2.jwt.Jwt
import org.springframework.stereotype.Controller
import reactor.core.publisher.Flux
import java.time.Duration
import java.time.Instant

@Controller
@RequiredArgsConstructor
@PreAuthorize(&quot;isAuthenticated()&quot;)
class HelloController {

  @QueryMapping
  fun helloAll(@AuthenticationPrincipal jwt: Jwt): String {
    val roles = jwt.getClaimAsStringList(SecurityUtils.AUTHORITIES_KEY)
    return &quot;Hello, ${jwt.subject}! Your roles: $roles&quot;
  }

  @PreAuthorize(&quot;hasAuthority(&#39;ROLE_ADMIN&#39;)&quot;)
  @QueryMapping
  fun helloAdmin(@AuthenticationPrincipal jwt: Jwt): String =
    &quot;Hello Admin, ${jwt.subject}!&quot;

  @MutationMapping
  fun greet(
    @Argument input: GreetInput,
    @AuthenticationPrincipal jwt: Jwt
  ): GreetDTO {
    val msg = &quot;Hello ${jwt.subject}, you said: ${input.message}&quot;
    return GreetDTO(msg, Instant.now())
  }

  @SubscriptionMapping(&quot;greetStream&quot;)
  fun greetStream(
    @Argument input: GreetInput,
    @AuthenticationPrincipal jwt: Jwt
  ): Flux&lt;GreetDTO&gt; =
    Flux.interval(Duration.ofSeconds(1))
      .map { i -&gt;
        val msg = &quot;Hello ${jwt.subject}, you said: ${input.message} (event ${i + 1})&quot;
        GreetDTO(msg, Instant.now())
      }

  @PreAuthorize(&quot;hasAuthority(&#39;ROLE_ADMIN&#39;)&quot;)
  @SubscriptionMapping(&quot;greetStreamAdmin&quot;)
  fun greetStreamAdmin(
    @Argument input: GreetInput,
    @AuthenticationPrincipal jwt: Jwt
  ): Flux&lt;GreetDTO&gt; =
    Flux.interval(Duration.ofSeconds(2))
      .map { i -&gt;
        val msg = &quot;Hello Admin ${jwt.subject}, you said: ${input.message} (admin event ${i + 1})&quot;
        GreetDTO(msg, Instant.now())
      }
}</code></pre>
<h3>LoginInput</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.dto;

public record LoginInput(
  String username,
  String password
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.dto

data class LoginInput(
  val username: String,
  val password: String
)</code></pre>
<h3>GreetInput</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.dto;

public record GreetInput(
  String message
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.dto

data class GreetInput(
  val message: String
)</code></pre>
<h3>GreetDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.dto;

import java.time.Instant;

public record GreetDTO(
  String greeting,
  Instant timestamp
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.dto

import java.time.Instant

data class GreetDTO(
  val greeting: String,
  val timestamp: Instant
)</code></pre>
<h3>TokenDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootgraphqljwedemo.dto;

public record TokenDTO(
  String accessToken,
  String tokenType,
  long accessTokenExpiresIn
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootgraphqljwedemo.dto

data class TokenDTO(
  val accessToken: String,
  val tokenType: String,
  val accessTokenExpiresIn: Long
)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±r</h2>
<pre><code class="language-bash">./mvnw spring-boot:run
# or
gradle bootRun</code></pre>
<p>GraalVM 22.3+ y√ºkl√ºyse, `native` profili ile native-image derlemek i√ßin ≈üu komutu √ßalƒ±≈ütƒ±r:</p>
<pre><code class="language-bash">./mvnw native:compile -Pnative</code></pre>
<p>Native-image derlemesi ba≈üarƒ±yla tamamlandƒ±ktan sonra, √ßalƒ±≈ütƒ±rƒ±labilir dosya `target/` altƒ±nda olu≈üturulur (√∂rneƒüin: `target/spring-boot-graphql-jwe-auth-demo`). Doƒürudan ≈üu komut ile √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./target/spring-boot-graphql-jwe-auth-demo</code></pre>
<p>Opsiyonel: UPX y√ºkl√ºyse, yerel √ßalƒ±≈ütƒ±rƒ±labilir dosyayƒ± daha k√º√ß√ºk boyut i√ßin sƒ±kƒ±≈ütƒ±rabilirsiniz:</p>
<pre><code class="language-bash">upx --ultra-brute --lzma target/spring-boot-graphql-jwe-auth-demo</code></pre>
<hr />
<h2>üß™ GraphQL Endpoint Testi</h2>
<h3>Admin Akƒ±≈üƒ±</h3>
<p>admin olarak giri≈ü yapƒ±n ve `Set-Cookie` ba≈ülƒ±ƒüƒ±ndan JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/graphql \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;mutation { login(input: { username: \&quot;admin\&quot;, password: \&quot;adminpass\&quot; }) { accessToken tokenType accessTokenExpiresIn } }&quot; }&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
<li>Yanƒ±t:</li>
</ul>
<pre><code class="language-json">{
  &quot;data&quot;: {
    &quot;login&quot;: {
      &quot;accessToken&quot;: &quot;&lt;jwe-token&gt;&quot;,
      &quot;tokenType&quot;: &quot;Bearer&quot;,
      &quot;accessTokenExpiresIn&quot;: 3600
    }
  }
}</code></pre>
<p>Cookie kullanarak `helloAll` sorgusuna eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;{ helloAll }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<p>Veya Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;{ helloAll }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<p>admin-√∂zel `helloAdmin` sorgusunu √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;{ helloAdmin }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<p>Oturum √ßerezini temizlemek i√ßin `logout` mutationu √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;mutation { logout }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<h3>User Flow</h3>
<p>user olarak giri≈ü yapƒ±n ve cookie‚Äôden JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/graphql \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;mutation { login(input: { username: \&quot;user\&quot;, password: \&quot;userpass\&quot; }) { accessToken tokenType accessTokenExpiresIn } }&quot; }&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
</ul>
<p>`helloAll` sorgusunu √ßaƒüƒ±rmak i√ßin cookie kullanƒ±n:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;{ helloAll }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<p>Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;{ helloAll }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<p>`helloAdmin` sorgusunu dene (403 hata d√∂nmesi gerekir):</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{ &quot;query&quot;: &quot;{ helloAdmin }&quot; }&#39; \
  http://localhost:8080/graphql</code></pre>
<h3>GraphiQL √úzerinden Subscription Testi</h3>
<p>Subscriptionlarƒ± doƒürudan GraphiQL UI‚Äôƒ±nda `http://localhost:8080/graphiql` adresinde test edin:</p>
<p>1. GraphiQL‚Äôde Token Alma</p>
<p>1. Sorgu (Query) paneline ≈üunu girin:</p>
<p>```graphql mutation Login($in: LoginInput!) { login(input: $in) { accessToken } } ```</p>
<p>1. Deƒüi≈ükenler (Variables) paneline ge√ßip ekleyin:</p>
<p>```json { &quot;in&quot;: { &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;adminpass&quot; } } ```</p>
<p>1. ‚ñ∂Ô∏è d√ºƒümesine tƒ±klayƒ±n ve d√∂nen yanƒ±ttaki `accessToken` deƒüerini kopyalayƒ±n.</p>
<p>2. Ba≈ülƒ±klarƒ± (Headers) Yapƒ±landƒ±rma</p>
<p>1. Kenar √ßubuƒüunda Headers sekmesine tƒ±klayƒ±n. 1. A≈üaƒüƒ±daki JSON‚Äôu ekleyin:</p>
<p>```json { &quot;Authorization&quot;: &quot;Bearer &lt;accessToken&gt;&quot; } ```</p>
<p>3. Kullanƒ±cƒ± Olarak Abone Olma (greetStream)</p>
<p>1. Subscriptions paneline ge√ßin. 1. A≈üaƒüƒ±daki subscription sorgusunu girin:</p>
<p>```graphql subscription UserSubscribe($in: GreetInput!) { greetStream(input: $in) { greeting timestamp } } ```</p>
<p>1. Variables paneline:</p>
<p>```json { &quot;in&quot;: { &quot;message&quot;: &quot;GraphiQL √ºzerinden merhaba!&quot; } } ```</p>
<p>1. ‚ñ∂Ô∏è d√ºƒümesine tƒ±klayarak `greetStream` akƒ±≈üƒ±nƒ± dinlemeye ba≈ülayƒ±n.</p>
<p>4. Admin Olarak Abone Olma (greetStreamAdmin)</p>
<p>1. Aynƒ± Subscriptions panelinde a≈üaƒüƒ±daki sorguyu girin:</p>
<p>```graphql subscription AdminSubscribe($in: GreetInput!) { greetStreamAdmin(input: $in) { greeting timestamp } } ```</p>
<p>1. Aynƒ± Variables panelini kullanƒ±n. 1. ‚ñ∂Ô∏è d√ºƒümesine tƒ±klayƒ±n. Sadece `ROLE_ADMIN` yetkisine sahip token‚Äôlar veri alacak; diƒüerleri yetki hatasƒ± g√∂recektir.</p>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot GraphQL JWE Kimlik Doƒürulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[G√ºvenlik]]></category>
      <category><![CDATA[JWT]]></category>
      <category><![CDATA[JWE]]></category>
      <category><![CDATA[GraphQL]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-graphql-jwe-auth-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot JPA ile JWE Kimlik Doƒürulamasƒ±]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-jwe-authentication-with-jpa</link>
      <description><![CDATA[Stateless ≈üifreli JWT‚Äôler (JWE) kullanarak Spring Boot API‚Äôlerinizi g√ºvenli hale getirirken, kullanƒ±cƒ± kimliklerini ve rolleri JPA destekli bir veritabanƒ±nda nasƒ±l saklayacaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Sun, 11 May 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-jwe-authentication-with-jpa</guid>
      <content:encoded><![CDATA[<p>Spring Boot, stateless ≈üifrelenmi≈ü JWT‚Äôleri (JWE) kullanarak API‚Äôlerinizi g√ºvence altƒ±na almanƒ±zƒ± ve kullanƒ±cƒ± kimliklerini ile rollerini JPA tabanlƒ± bir veritabanƒ±nda saklamanƒ±zƒ± saƒülar.</p>
<hr />
<h2>üåü Neden JWE + JPA Kimlik Doƒürulama?</h2>
<ul>
<li>Stateless G√ºvenlik: Tokenlar kendi i√ßinde t√ºm bilgiyi barƒ±ndƒ±rƒ±r ve sunucu tarafƒ±nda saklama gerektirmez.</li>
<li>B√ºt√ºnl√ºk: ƒ∞mzalƒ± tokenlar, i√ßeriƒüin deƒüi≈ütirilmediƒüini garanti eder.</li>
<li>Gizlilik: ≈ûifrelenmi≈ü JWT‚Äôler hassas bilgileri dƒ±≈üarƒ±dan okunamaz halde tutar.</li>
<li>Kullanƒ±cƒ± Y√∂netimi: JPA depolarƒ± ile kullanƒ±cƒ±larƒ± ve rolleri JPA repositorylerde saklayƒ±p y√∂netebilirsiniz.</li>
<li>Standartlara Uygun: JOSE, Spring Security ve Spring Data JPA‚Äônƒ±n g√ºc√ºn√º bir arada kullanƒ±r.</li>
<li>√ñl√ßeklenebilirlik: Session replikasyonu veya sticky session gerektirmeden yatay √∂l√ßeklenebilir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>‚òï JDK 17 veya √ºzeri</li>
<li>üì¶ Spring Boot 3.2+</li>
<li>üî§ IDE (IntelliJ IDEA, Eclipse)</li>
<li>üõ¢Ô∏è PostgreSQL (veya geli≈ütirme i√ßin H2)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekle</h2>
<p>`pom.xml` veya `build.gradle` dosyanƒ±za ≈üunlarƒ± ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
  &lt;artifactId&gt;spring-security-oauth2-resource-server&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.liquibase&lt;/groupId&gt;
  &lt;artifactId&gt;liquibase-core&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
  &lt;artifactId&gt;lombok&lt;/artifactId&gt;
  &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.h2database&lt;/groupId&gt;
  &lt;artifactId&gt;h2&lt;/artifactId&gt;
  &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
implementation &#39;org.springframework.security:spring-security-oauth2-resource-server&#39;
implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;
implementation &#39;org.liquibase:liquibase-core&#39;
compileOnly &#39;org.projectlombok:lombok&#39;
runtimeOnly &#39;com.h2database:h2&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Yapƒ±landƒ±rma Dosyalarƒ±</h2>
<p>Bu b√∂l√ºmde, Spring Boot uygulamanƒ±zƒ± H2/PostgreSQL, JPA, Liquibase deƒüi≈üiklik changelog, veri y√ºklemeleri ve JWE anahtar √∂zellikleri ile yapƒ±landƒ±rmak i√ßin gereken t√ºm uygulama ve veritabanƒ± d√ºzeyindeki yapƒ±landƒ±rma dosyalarƒ±nƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>`application.yml`</li>
<p>Spring veri kaynaƒüƒ± (datasource), H2 konsolu, JPA/Hibernate, Liquibase changelog pathi ve t√ºm JWT/JWE anahtar, issuer ve ge√ßerlilik s√ºresi (expiration) ayarlarƒ±nƒ± i√ßerir.</p>
</ul>
<ul>
<li>`db/master.xml`</li>
<p>Liquibase master changelog dosyasƒ±; H2 ve PostgreSQL i√ßin DBMS √∂zel √∂zellikler ve alt changelog tanƒ±mlarƒ±nƒ± barƒ±ndƒ±rƒ±r.</p>
</ul>
<ul>
<li>`db/changelog/changelog-user.xml`</li>
<p>`user_identity`, `authority` ve `user_authority_mapping` tablolarƒ±, indeksler, yabancƒ± anahtarlar (FK) ve ilk `&lt;loadData&gt;` adƒ±mlarƒ±nƒ± tanƒ±mlayan temel ≈üema deƒüi≈üiklik changelogu.</p>
</ul>
<ul>
<li>`db/data/user.csv`</li>
<p>Kullanƒ±cƒ± kayƒ±tlarƒ± (UUID, kullanƒ±cƒ± adƒ±, bcrypt ile ≈üifrelenmi≈ü parola, e-posta, enabled flagi, zaman damgalarƒ± ve olu≈üturan kullanƒ±cƒ± bilgisi).</p>
</ul>
<ul>
<li>`db/data/authority.csv`</li>
<p>Yetki kayƒ±tlarƒ± (UUID, ad, a√ßƒ±klama, zaman damgalarƒ± ve olu≈üturan kullanƒ±cƒ± bilgisi).</p>
</ul>
<ul>
<li>`db/data/user_authority_mapping.csv`</li>
<p>Kullanƒ±cƒ±lar ile yetkiler arasƒ±ndaki mappingler (composite birincil anahtar, zaman damgalarƒ± ve olu≈üturan kullanƒ±cƒ± bilgisi).</p>
</ul>
<h3>application.yml</h3>
<pre><code class="language-yaml">spring:
  datasource:
    url: jdbc:h2:mem:testdb;MODE=PostgreSQL;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password: password
  h2:
    console:
      enabled: true
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: none
    show-sql: true
    properties:
      hibernate.format_sql: true
  liquibase:
    change-log: classpath:db/master.xml
security:
  admin:
    username: admin
    password: adminpass
  user:
    username: user
    password: userpass
  jwt:
    issuer: demo-issuer
    expiration-duration: 3600s
    signing:
      key-id: signing-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjZEcz5itWkDGOSqZdB5P
        JE0ccOCckskp0hN3kQbT1qnv+9/k66jlWgVi4HSTppwdNF/Ylu5u541Qj+Okyg+u
        8o2PvKo5CfgvTDsFLTrZHUXU6hCSGatLAQoeN6lT8wzov2r4DFecXrIqcO6SvMB5
        ecPqsfiTi4trsNKgJ4cWS6gILH62ISd1ipUadfpnUzDMO1OulV0CJNV6bcBk7Es9
        RW6AHfg9j8osSanpwvRM4MJkB0SRxYUnrN9faGpkBZISZJ8TShhaTHEGfSNgKe5y
        8iu+AMGGZu8DYczVmqS3Ske1fq6y5HEGCma7Mo019GmwKeHBo1obuET6cZRygj4y
        twIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCNkRzPmK1aQMY5
        Kpl0Hk8kTRxw4JySySnSE3eRBtPWqe/73+TrqOVaBWLgdJOmnB00X9iW7m7njVCP
        46TKD67yjY+8qjkJ+C9MOwUtOtkdRdTqEJIZq0sBCh43qVPzDOi/avgMV5xesipw
        7pK8wHl5w+qx+JOLi2uw0qAnhxZLqAgsfrYhJ3WKlRp1+mdTMMw7U66VXQIk1Xpt
        wGTsSz1FboAd+D2PyixJqenC9EzgwmQHRJHFhSes319oamQFkhJknxNKGFpMcQZ9
        I2Ap7nLyK74AwYZm7wNhzNWapLdKR7V+rrLkcQYKZrsyjTX0abAp4cGjWhu4RPpx
        lHKCPjK3AgMBAAECggEABMo/sNCIMREXA/EqjxDFecN4LmOTOK5A0YBiH9Cc01sd
        qSaavtSQqhqbjV+0bUNEA7UohXbc3s3bx3qa5VFhiIh8sBQMaQdyRkCK/MxMc16d
        BSx5XQ/8MjVO73A1zHgH2g47BWPjgRrDL94KrgNPOO0FoG76QxL9GlcOHzhFa1rf
        xbb2auLBtflKy+5TZNnB/sbFC9ISpWywzfblD2Fsvxupl0vNWtA0Y2rPbKMZRnY+
        V6NC38yxW3HHAdWQRYLGOitM59I0HBgnjQKzTBNIsjPnJA2BSZvMBtQ1e3RQV0qE
        8VVoktZ8A0KDUxqdKWYlGYAY5hIw1y3UUsPRUbS3fQKBgQDAZehu+Kb5Sw+h00Qu
        vViNHDvi0PwmhQrHVpgjrppCnWsTk6FJFm+EBLY+87usXuRCnfZ1semb6P+yjLh2
        bJ9IXIrFAztcyE+7eZfn0H7mHA7E2ICKTjNdKbjy8kHViHpgdXREnAOrFTTk/BqW
        dq+weG2OuxYczWsY4XliWaVyiwKBgQC8XYExpSmoyI37o+jr9405k30tbGUw4X+/
        xYOvSUuafI8IOSLfKTpsvkMN3hxpJO6apIRAjOALbotKUA5FrHQPenuBWOr3mBJT
        euLiaWphqU8YN5dbNd+JhC/Jh5DLhY5FpB2Fv2MKSoF7+onpjDy9pEU5aReeBB0v
        ekUw4nWiBQKBgHxyrnjxP1frFG5xMB4nfZqw04+v7BmiXsl3mqsh6kgCeNtN17pl
        17YGMjfgAdnJ+02XzW5tqRSfDp3YZgy7z//HVD+BCqnGK8SxLu/ULfD73xW2kNZl
        JNYzAZ2r06eiQr4X2x/x5nGIIxGmfDAtDxFPpFX5b6ErwgVy+sgCAoFnAoGAWSpu
        EMEdQk+FnnwNsz2g9YNSuyDXmdb08SOfXWd1yXBzCLJ7RmYuyPEbrsHYcxFPfZap
        ICFPoTm35/qTdvnWiskxE56yw3eSHUBLjF/YQtixn0YZeMy8v0z6jgyFR0I2gdLZ
        QsnBKUrxlm2XwR1oV2Eef7m2u085PZNEk4pvor0CgYA6n060r48/CgRVslAeGder
        fZ3n+2ru8q2UVB38evepjLifn5+tKdFzZ7/NckXMC0NOVzm74qG46VFLMw5TtyT4
        /hRvGSYxA6dMjXy+tcrAns9Isrz2PnYFntlbhU6hw0um809tFunbvITfyeOjAsDW
        stC4thnhzXXT1Y3RfFtYEg==
        -----END PRIVATE KEY-----
    encryption:
      key-id: encryption-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtU7Vu4tML8qg9BISaUH0
        BTU0+qkHJS3TUl3R0hEPttZJGf8EgT7bpWqRjdhMC2SYt2ifNF82EgMo/eva1rLn
        wYtCsxjJ7oB4U2m16/JKHtphmMUGhSLgbp+Y8pGAQ+P6u4HLlI0qbL92Syb6QCTr
        nYIlzZ2uUAvUQg/SbuAvdS4kdauZtpMNbhryusMVvILVBC5yUhfLJAkjbU3qWo/n
        2NKPr4kjwwFh6FaAf0HLsXCFmJbPPok6WMZeDqPORPZCt5gU2t04fS7s/2SSbhQ/
        i+7yyT4pl44cUlNLLN3Qo73sai5H90q7Dvmk3M5/YMJB0Ueyb705LHyOO5xA618s
        qQIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC1TtW7i0wvyqD0
        EhJpQfQFNTT6qQclLdNSXdHSEQ+21kkZ/wSBPtulapGN2EwLZJi3aJ80XzYSAyj9
        69rWsufBi0KzGMnugHhTabXr8koe2mGYxQaFIuBun5jykYBD4/q7gcuUjSpsv3ZL
        JvpAJOudgiXNna5QC9RCD9Ju4C91LiR1q5m2kw1uGvK6wxW8gtUELnJSF8skCSNt
        Tepaj+fY0o+viSPDAWHoVoB/QcuxcIWYls8+iTpYxl4Oo85E9kK3mBTa3Th9Luz/
        ZJJuFD+L7vLJPimXjhxSU0ss3dCjvexqLkf3SrsO+aTczn9gwkHRR7JvvTksfI47
        nEDrXyypAgMBAAECggEAREnJHrY8n9OGA+e6n4KD0mJT7gUz98Dm0yMbIC/k50yW
        hAAVRkjSmd8lq3NIURI2ov342NTznJ0sF1d6OVtxBujY2nP/uqEQsPoj1xaO7Ef8
        cnnjFsooFgJurQ44bVm02mLstqrky8jhWTT5FKfTRqP6cRNu0B9kdu1WqQQvW8a/
        C8xD8XUFzzJFQsEstJ076NjlZNH3EeqFiLxyVdV7tPEJRnOe2V2BAAgda3ByA6Jc
        Nd4xYHTVr5rZ+KES9gaAgb86+S7hNigsxz5Gp58NimLEyz1Qd+d9QCgPRgKOV5Uq
        0ci6c28ZrxW9wa/2CGCpoow1V7hRy1fZ24g2Tz91cQKBgQDbSdP/FQYuem0pUf8u
        mA/niEC8Jz30FW3ix5aqbQ8YRudK48Xy8F7AWnlS0wT2k/Xaeppn9YSPK4HlsNk2
        1gnpNfzdqXpJQtuxcPPeFNzUdXzBrsLXYqtlhOX/afrzqMhp73gkqoxXtqwD7BqN
        VfMcVXsWrEZQrRPBn/RUnnLdJwKBgQDTqUGupm93UlhoPgLXHGF/seQwPPHcU6lS
        SS9l512Ie21B+vZecgO4r77BXJwbY4rZVA5/m+wrsNmsT2f8yfdbs84cBDDWiKy5
        t2Um8zrus+BCIffxc9Fck9/htK33jLLcYwdSAm3a9pJxR9f/kAdredSTGBNJ3W/2
        rfh3cdNprwKBgDi7WfBFRSsjGzi0cPth9cNlubGzyVBrdtlT34PJ4Tzboxz53o1i
        aHEFNxwZYdBVKSbTzzyUBS5xCBMfdKK+LyQ5hmjmXq+zb1jxqvXKmfMRTixhhSDp
        8wO5pTM1/Omqwea+QGvj/5j1tnzxSVFFajbrWoPcH/jhPho6wqBducPDAoGBALOJ
        MEOavZXy7TaO0w3v7uvH0wzvxR/kfw1jMqc3l2j7ePOskmoOQAXaXO3bRjcdOlua
        Jyoq8islOZ4lRMlx7zWD0OKG035GNGzbmRtu2aA8R48RDSVr3jyu2gqznZULbXPv
        M/hmQxSmbhVUoW0PmJubnaqfk0zmXeBaNRXsIS3VAoGBALdsAtqR23PVeL6sYj2l
        dRNTDXpfvjFqJ5NThRO/4mT0CrPHQVj+Mz2bTc/Dxiwi8s8m3L+g23i3hodh/QMb
        Iz+UbcJZBGAKsFbPKGOtj6Bi07y/L11mcuNJzOWe61/JbVmJss0s+N/v3XucK/Ge
        CUaGOccsMO221v6JoBh9J3Hz
        -----END PRIVATE KEY-----</code></pre>
<h3>master.xml</h3>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;databaseChangeLog
  xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;
      http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd&quot;&gt;

  &lt;!-- H2 defaults --&gt;
  &lt;property name=&quot;now&quot; value=&quot;now()&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;floatType&quot; value=&quot;float4&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;uuidType&quot; value=&quot;uuid&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;datetimeType&quot; value=&quot;datetime(6)&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;binaryType&quot; value=&quot;LONGVARBINARY&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;clobType&quot; value=&quot;longvarchar&quot; dbms=&quot;h2&quot;/&gt;
  &lt;property name=&quot;blobType&quot; value=&quot;blob&quot; dbms=&quot;h2&quot;/&gt;

  &lt;!-- PostgreSQL overrides --&gt;
  &lt;property name=&quot;now&quot; value=&quot;current_timestamp&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;floatType&quot; value=&quot;float4&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;uuidType&quot; value=&quot;uuid&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;datetimeType&quot; value=&quot;datetime&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;binaryType&quot; value=&quot;BYTEA&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;clobType&quot; value=&quot;clob&quot; dbms=&quot;postgresql&quot;/&gt;
  &lt;property name=&quot;blobType&quot; value=&quot;blob&quot; dbms=&quot;postgresql&quot;/&gt;

  &lt;!-- include the core auth changelog --&gt;
  &lt;include file=&quot;classpath:db/changelog/changelog-user.xml&quot;/&gt;

&lt;/databaseChangeLog&gt;</code></pre>
<h3>changelog-user.xml</h3>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;databaseChangeLog
  xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;
      http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd&quot;&gt;

  &lt;changeSet id=&quot;20250510-1&quot; author=&quot;susimsek&quot;&gt;
    &lt;createTable tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints primaryKey=&quot;true&quot; primaryKeyName=&quot;pk_user_identity&quot; nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;username&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot; unique=&quot;true&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;password&quot; type=&quot;varchar(100)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;email&quot; type=&quot;varchar(100)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot; unique=&quot;true&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;first_name&quot; type=&quot;varchar(50)&quot;/&gt;
      &lt;column name=&quot;last_name&quot; type=&quot;varchar(50)&quot;/&gt;
      &lt;column name=&quot;enabled&quot; type=&quot;boolean&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;varchar(50)&quot;/&gt;
    &lt;/createTable&gt;

    &lt;createIndex indexName=&quot;idx_user_identity_username&quot; tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;username&quot;/&gt;
    &lt;/createIndex&gt;
    &lt;createIndex indexName=&quot;idx_user_identity_email&quot; tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;email&quot;/&gt;
    &lt;/createIndex&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-2&quot; author=&quot;susimsek&quot;&gt;
    &lt;createTable tableName=&quot;authority&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints primaryKey=&quot;true&quot; primaryKeyName=&quot;pk_authority&quot; nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;name&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot; unique=&quot;true&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;description&quot; type=&quot;varchar(255)&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;varchar(50)&quot;/&gt;
    &lt;/createTable&gt;

    &lt;createIndex indexName=&quot;idx_authority_name&quot; tableName=&quot;authority&quot;&gt;
      &lt;column name=&quot;name&quot;/&gt;
    &lt;/createIndex&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-3&quot; author=&quot;susimsek&quot;&gt;
    &lt;createTable tableName=&quot;user_authority_mapping&quot;&gt;
      &lt;column name=&quot;user_id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;authority_id&quot; type=&quot;varchar(36)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;varchar(50)&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;varchar(50)&quot;/&gt;
    &lt;/createTable&gt;

    &lt;addPrimaryKey
      tableName=&quot;user_authority_mapping&quot;
      columnNames=&quot;user_id, authority_id&quot;
      constraintName=&quot;pk_user_authority_mapping&quot;/&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-4&quot; author=&quot;susimsek&quot;&gt;
    &lt;addForeignKeyConstraint
      baseTableName=&quot;user_authority_mapping&quot;
      baseColumnNames=&quot;user_id&quot;
      constraintName=&quot;fk_user_authority_user&quot;
      referencedTableName=&quot;user_identity&quot;
      referencedColumnNames=&quot;id&quot;/&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-5&quot; author=&quot;susimsek&quot;&gt;
    &lt;addForeignKeyConstraint
      baseTableName=&quot;user_authority_mapping&quot;
      baseColumnNames=&quot;authority_id&quot;
      constraintName=&quot;fk_user_authority_authority&quot;
      referencedTableName=&quot;authority&quot;
      referencedColumnNames=&quot;id&quot;/&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-1-data&quot; author=&quot;susimsek&quot;&gt;
    &lt;loadData
      file=&quot;db/data/user.csv&quot;
      separator=&quot;;&quot;
      tableName=&quot;user_identity&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;username&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;password&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;email&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;first_name&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;last_name&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;enabled&quot; type=&quot;boolean&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;string&quot;/&gt;
    &lt;/loadData&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-2-data&quot; author=&quot;susimsek&quot;&gt;
    &lt;loadData
      file=&quot;db/data/authority.csv&quot;
      separator=&quot;;&quot;
      tableName=&quot;authority&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;name&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;description&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;string&quot;/&gt;
    &lt;/loadData&gt;
  &lt;/changeSet&gt;

  &lt;changeSet id=&quot;20250510-3-data&quot; author=&quot;susimsek&quot;&gt;
    &lt;loadData
      file=&quot;db/data/user_authority_mapping.csv&quot;
      separator=&quot;;&quot;
      tableName=&quot;user_authority_mapping&quot;&gt;
      &lt;column name=&quot;user_id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;authority_id&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;created_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;created_by&quot; type=&quot;string&quot;/&gt;
      &lt;column name=&quot;updated_at&quot; type=&quot;datetime&quot;/&gt;
      &lt;column name=&quot;updated_by&quot; type=&quot;string&quot;/&gt;
    &lt;/loadData&gt;
  &lt;/changeSet&gt;

&lt;/databaseChangeLog&gt;</code></pre>
<h3>user.csv</h3>
<pre><code class="language-csv">id;username;password;email;first_name;last_name;enabled;created_at;created_by;updated_at;updated_by
a1b2c3d4-e5f6-7890-abcd-ef1234567890;admin;$2a$10$sva6wl8pmGKJE6NIWrxwcuJK1Jaa2I/LOI43iHVpbR4YB8KjGViiK;admin@example.com;Admin;User;true;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
09876543-21fe-dcba-0987-654321fedcba;user;$2a$10$5Py4PyteLuXEqnGpSigzfu0V55C7Hi7zX18lmh.J8Bpmft.h23voG;user@example.com;Normal;User;true;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system</code></pre>
<h3>authority.csv</h3>
<pre><code class="language-csv">id;name;description;created_at;created_by;updated_at;updated_by
f47ac10b-58cc-4372-a567-0e02b2c3d479;ROLE_ADMIN;Administrator role;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
9c858901-8a57-4791-81fe-4c455b099bc9;ROLE_USER;User role;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system</code></pre>
<h3>user_authority_mapping.csv</h3>
<pre><code class="language-csv">user_id;authority_id;created_at;created_by;updated_at;updated_by
a1b2c3d4-e5f6-7890-abcd-ef1234567890;9c858901-8a57-4791-81fe-4c455b099bc9;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
a1b2c3d4-e5f6-7890-abcd-ef1234567890;f47ac10b-58cc-4372-a567-0e02b2c3d479;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system
09876543-21fe-dcba-0987-654321fedcba;9c858901-8a57-4791-81fe-4c455b099bc9;2025-05-10 12:00:00;system;2025-05-10 12:00:00;system</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: G√ºvenlik &amp; Veritabanƒ± Yapƒ±landƒ±rmasƒ±</h2>
<p>Bu b√∂l√ºmde, JWE tabanlƒ± kimlik doƒürulama i√ßin RSA anahtarlarƒ±, HTTP g√ºvenlik filtreleri ve JPA repository / auditing yapƒ±landƒ±rmasƒ±nƒ± tanƒ±mlayan bean&#39;leri ve ayarlarƒ± olu≈üturuyoruz:</p>
<ul>
<li>JwtProperties: JWT d√ºzenleyicisi (issuer), ge√ßerlilik s√ºresi ve imzalama/≈üifreleme anahtar √ßiftlerini yapƒ±landƒ±rƒ±r.</li>
<li>SecurityJwtConfig: RSA JWK nesnelerini olu≈üturur, JWT encoder/decoder‚Äôƒ±, authentication converter ve token resolveri yapƒ±landƒ±rƒ±r.</li>
<li>SecurityConfig: `DomainUserDetailsService` ile entegre olur, kimlik doƒürulama y√∂neticisi (authentication manager), password encoder ve JWE desteƒüi ile stateless g√ºvenlik filtre zincirini yapƒ±landƒ±rƒ±r.</li>
<li>DatabaseConfig: JPA repository&#39;lerini, auditing ve transaction y√∂netimini etkinle≈ütirir.</li>
</ul>
<h3>SecurityJwtConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.config;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.JWKSet;
import com.nimbusds.jose.jwk.RSAKey;
import com.nimbusds.jose.jwk.source.JWKSource;
import com.nimbusds.jose.proc.JWEDecryptionKeySelector;
import com.nimbusds.jose.proc.JWSVerificationKeySelector;
import com.nimbusds.jose.proc.SecurityContext;
import com.nimbusds.jwt.proc.DefaultJWTProcessor;
import io.github.susimsek.springbootjweauthjpademo.security.CookieBearerTokenResolver;
import io.github.susimsek.springbootjweauthjpademo.security.KeyUtils;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.oauth2.jwt.JwtDecoder;
import org.springframework.security.oauth2.jwt.JwtEncoder;
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder;
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder;
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter;
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;

import java.util.List;

import static io.github.susimsek.springbootjweauthjpademo.security.SecurityUtils.AUTHORITIES_KEY;

@Configuration
public class SecurityJwtConfig {

    private final JwtProperties props;
    public SecurityJwtConfig(JwtProperties props) { this.props = props; }

    @Bean
    public RSAKey signingKey() throws Exception {
        return KeyUtils.buildRsaKey(
            props.getSigning().getPublicKey(),
            props.getSigning().getPrivateKey(),
            props.getSigning().getKeyId(),
            true
        );
    }

    @Bean
    public RSAKey encryptionKey() throws Exception {
        return KeyUtils.buildRsaKey(
            props.getEncryption().getPublicKey(),
            props.getEncryption().getPrivateKey(),
            props.getEncryption().getKeyId(),
            false
        );
    }

    @Bean
    public JWKSource&lt;SecurityContext&gt; jwkSource(RSAKey signingKey, RSAKey encryptionKey) {
        JWKSet jwkSet = new JWKSet(List.of(
            signingKey,
            encryptionKey
        ));
        return (jwkSelector, context) -&gt; jwkSelector.select(jwkSet);
    }

    @Bean
    public JwtDecoder jwtDecoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
        DefaultJWTProcessor&lt;SecurityContext&gt; jwtProcessor = new DefaultJWTProcessor&lt;&gt;();
        JWEDecryptionKeySelector&lt;SecurityContext&gt; jweKeySelector =
            new JWEDecryptionKeySelector&lt;&gt;(
                JWEAlgorithm.RSA_OAEP_256,
                EncryptionMethod.A128GCM,
                jwkSource
            );
        jwtProcessor.setJWEKeySelector(jweKeySelector);

        JWSVerificationKeySelector&lt;SecurityContext&gt; jwsKeySelector =
            new JWSVerificationKeySelector&lt;&gt;(
                JWSAlgorithm.RS256,
                jwkSource
            );
        jwtProcessor.setJWSKeySelector(jwsKeySelector);
        jwtProcessor.setJWTClaimsSetVerifier((claims, context) -&gt; {});

        return new NimbusJwtDecoder(jwtProcessor);
    }

    @Bean
    public JwtEncoder jwtEncoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
        return new NimbusJwtEncoder(jwkSource);
    }

    @Bean
    public JwtAuthenticationConverter jwtAuthenticationConverter() {
        JwtGrantedAuthoritiesConverter converter = new JwtGrantedAuthoritiesConverter();
        converter.setAuthorityPrefix(&quot;&quot;);
        converter.setAuthoritiesClaimName(AUTHORITIES_KEY);

        JwtAuthenticationConverter authConverter = new JwtAuthenticationConverter();
        authConverter.setJwtGrantedAuthoritiesConverter(converter);
        return authConverter;
    }

    @Bean
    public BearerTokenResolver bearerTokenResolver() {
        CookieBearerTokenResolver resolver = new CookieBearerTokenResolver();
        resolver.setAllowUriQueryParameter(false);
        resolver.setAllowFormEncodedBodyParameter(false);
        resolver.setAllowCookie(true);
        return resolver;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.config

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.JWKSet
import com.nimbusds.jose.jwk.RSAKey
import com.nimbusds.jose.jwk.source.JWKSource
import com.nimbusds.jose.proc.JWEDecryptionKeySelector
import com.nimbusds.jose.proc.JWSVerificationKeySelector
import com.nimbusds.jose.proc.SecurityContext
import com.nimbusds.jwt.proc.DefaultJWTProcessor
import io.github.susimsek.springbootjweauthjpademo.security.CookieBearerTokenResolver
import io.github.susimsek.springbootjweauthjpademo.security.KeyUtils
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.oauth2.jwt.JwtDecoder
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver

@Configuration
class SecurityJwtConfig(private val props: JwtProperties) {

    @Bean
    @Throws(Exception::class)
    fun signingKey(): RSAKey =
        KeyUtils.buildRsaKey(
            props.signing.publicKey,
            props.signing.privateKey,
            props.signing.keyId,
            true
        )

    @Bean
    @Throws(Exception::class)
    fun encryptionKey(): RSAKey =
        KeyUtils.buildRsaKey(
            props.encryption.publicKey,
            props.encryption.privateKey,
            props.encryption.keyId,
            false
        )

    @Bean
    fun jwkSource(signingKey: RSAKey, encryptionKey: RSAKey): JWKSource&lt;SecurityContext&gt; {
        val jwkSet = JWKSet(listOf(signingKey, encryptionKey))
        return JWKSource { jwkSelector, context -&gt; jwkSelector.select(jwkSet) }
    }

    @Bean
    fun jwtDecoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtDecoder {
        val jwtProcessor = DefaultJWTProcessor&lt;SecurityContext&gt;()
        val jweKeySelector = JWEDecryptionKeySelector(
            JWEAlgorithm.RSA_OAEP_256,
            EncryptionMethod.A128GCM,
            jwkSource
        )
        jwtProcessor.jweKeySelector = jweKeySelector
        val jwsKeySelector = JWSVerificationKeySelector(
            JWSAlgorithm.RS256,
            jwkSource
        )
        jwtProcessor.jwsKeySelector = jwsKeySelector
        jwtProcessor.jwtClaimsSetVerifier = { _, _ -&gt; }
        return NimbusJwtDecoder(jwtProcessor)
    }

    @Bean
    fun jwtEncoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtEncoder =
        NimbusJwtEncoder(jwkSource)

    @Bean
    fun jwtAuthenticationConverter(): JwtAuthenticationConverter {
        val converter = JwtGrantedAuthoritiesConverter().apply {
            setAuthorityPrefix(&quot;&quot;)
            setAuthoritiesClaimName(AUTHORITIES_KEY)
        }
        return JwtAuthenticationConverter().apply {
            setJwtGrantedAuthoritiesConverter(converter)
        }
    }

    @Bean
    fun bearerTokenResolver(): BearerTokenResolver =
        CookieBearerTokenResolver().apply {
            setAllowUriQueryParameter(false)
            setAllowFormEncodedBodyParameter(false)
            setAllowCookie(true)
        }
}</code></pre>
<h3>SecurityConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.config;

import io.github.susimsek.springbootjweauthjpademo.repository.UserRepository;
import io.github.susimsek.springbootjweauthjpademo.security.AuthoritiesConstants;
import io.github.susimsek.springbootjweauthjpademo.security.DomainUserDetailsService;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.ProviderManager;
import org.springframework.security.authentication.dao.DaoAuthenticationProvider;
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher;
import org.springframework.web.servlet.handler.HandlerMappingIntrospector;

import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
@EnableMethodSecurity(securedEnabled = true)
public class SecurityConfig {

  @Bean
  public SecurityFilterChain securityFilterChain(HttpSecurity http,
                                                 MvcRequestMatcher.Builder mvc) throws Exception {
    http
      .cors(withDefaults())
      .csrf(AbstractHttpConfigurer::disable)
      .authorizeHttpRequests(authz -&gt; authz
        .requestMatchers(
          mvc.pattern(&quot;/webjars/**&quot;),
          mvc.pattern(&quot;/css/**&quot;),
          mvc.pattern(&quot;/js/**&quot;)
        ).permitAll()
        .requestMatchers(
          mvc.pattern(&quot;/*.ico&quot;),
          mvc.pattern(&quot;/*.png&quot;),
          mvc.pattern(&quot;/*.svg&quot;),
          mvc.pattern(&quot;/*.webapp&quot;)
        ).permitAll()
        .requestMatchers(&quot;/actuator/**&quot;).permitAll()
        .requestMatchers(
          &quot;/v3/api-docs/**&quot;,
          &quot;/swagger-ui.html&quot;,
          &quot;/swagger-ui/**&quot;
        ).permitAll()
        .requestMatchers(mvc.pattern(&quot;/api/auth/login&quot;)).permitAll()
        .requestMatchers(mvc.pattern(&quot;/api/hello/admin&quot;)).hasAuthority(AuthoritiesConstants.ADMIN)
        .anyRequest().authenticated()
      )
      .sessionManagement(session -&gt;
        session.sessionCreationPolicy(SessionCreationPolicy.STATELESS)
      )
      .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt(withDefaults()));

    return http.build();
  }

  @Bean
  public UserDetailsService userDetailsService(UserRepository userRepository) {
    return new DomainUserDetailsService(userRepository);
  }

  @Bean
  public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
  }

  @Bean
  public AuthenticationManager authenticationManager(
    UserDetailsService userDetailsService,
    PasswordEncoder passwordEncoder) {
    DaoAuthenticationProvider authenticationProvider = new DaoAuthenticationProvider();
    authenticationProvider.setUserDetailsService(userDetailsService);
    authenticationProvider.setPasswordEncoder(passwordEncoder);

    return new ProviderManager(authenticationProvider);
  }

  @Bean
  public MvcRequestMatcher.Builder mvc(HandlerMappingIntrospector introspector) {
    return new MvcRequestMatcher.Builder(introspector);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.config

import io.github.susimsek.springbootjweauthjpademo.repository.UserRepository
import io.github.susimsek.springbootjweauthjpademo.security.AuthoritiesConstants
import io.github.susimsek.springbootjweauthjpademo.security.DomainUserDetailsService
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.ProviderManager
import org.springframework.security.authentication.dao.DaoAuthenticationProvider
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.config.configurers.AbstractHttpConfigurer
import org.springframework.security.config.http.SessionCreationPolicy
import org.springframework.security.core.userdetails.UserDetailsService
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder
import org.springframework.security.crypto.password.PasswordEncoder
import org.springframework.security.web.SecurityFilterChain
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher
import org.springframework.web.servlet.handler.HandlerMappingIntrospector

@Configuration
@EnableMethodSecurity(securedEnabled = true)
class SecurityConfig {

  @Bean
  @Throws(Exception::class)
  fun securityFilterChain(http: HttpSecurity,
                          mvc: MvcRequestMatcher.Builder): SecurityFilterChain {
    http
      .cors(withDefaults())
      .csrf { it.disable() }
      .authorizeHttpRequests { authz -&gt;
        authz
          .requestMatchers(
            mvc.pattern(&quot;/webjars/**&quot;),
            mvc.pattern(&quot;/css/**&quot;),
            mvc.pattern(&quot;/js/**&quot;)
          ).permitAll()
          .requestMatchers(
            mvc.pattern(&quot;/*.ico&quot;),
            mvc.pattern(&quot;/*.png&quot;),
            mvc.pattern(&quot;/*.svg&quot;),
            mvc.pattern(&quot;/*.webapp&quot;)
          ).permitAll()
          .requestMatchers(&quot;/actuator/**&quot;).permitAll()
          .requestMatchers(
            &quot;/v3/api-docs/**&quot;,
            &quot;/swagger-ui.html&quot;,
            &quot;/swagger-ui/**&quot;
          ).permitAll()
          .requestMatchers(mvc.pattern(&quot;/api/auth/login&quot;)).permitAll()
          .requestMatchers(mvc.pattern(&quot;/api/hello/admin&quot;)).hasAuthority(AuthoritiesConstants.ADMIN)
          .anyRequest().authenticated()
      }
      .sessionManagement { it.sessionCreationPolicy(SessionCreationPolicy.STATELESS) }
      .oauth2ResourceServer { it.jwt(withDefaults()) }

    return http.build()
  }

  @Bean
  fun userDetailsService(userRepository: UserRepository): UserDetailsService =
    DomainUserDetailsService(userRepository)

  @Bean
  fun passwordEncoder(): PasswordEncoder = BCryptPasswordEncoder()

  @Bean
  fun authenticationManager(
    userDetailsService: UserDetailsService,
    passwordEncoder: PasswordEncoder
  ): AuthenticationManager {
    val provider = DaoAuthenticationProvider().apply {
      setUserDetailsService(userDetailsService)
      setPasswordEncoder(passwordEncoder)
    }
    return ProviderManager(provider)
  }

  @Bean
  fun mvc(introspector: HandlerMappingIntrospector): MvcRequestMatcher.Builder =
    MvcRequestMatcher.Builder(introspector)
}</code></pre>
<h3>JwtProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

import java.time.Duration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
@Data
public class JwtProperties {

    @Data
    public static class Pair {
        private String publicKey;
        private String privateKey;
        private String keyId;
    }

    private Pair signing;
    private Pair encryption;
    private String issuer;
    private Duration expirationDuration;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration
import java.time.Duration

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
class JwtProperties {

  class Pair {
    lateinit var publicKey: String
    lateinit var privateKey: String
    lateinit var keyId: String
  }

  lateinit var signing: Pair
  lateinit var encryption: Pair
  lateinit var issuer: String
  lateinit var expirationDuration: Duration
}</code></pre>
<h3>DatabaseConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.transaction.annotation.EnableTransactionManagement;

@Configuration
@EnableJpaRepositories(&quot;io.github.susimsek.springbootjweauthjpademo.repository&quot;)
@EnableJpaAuditing(auditorAwareRef = &quot;springSecurityAuditorAware&quot;)
@EnableTransactionManagement
public class DatabaseConfig {

}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.config

import org.springframework.context.annotation.Configuration
import org.springframework.data.jpa.repository.config.EnableJpaAuditing
import org.springframework.data.jpa.repository.config.EnableJpaRepositories
import org.springframework.transaction.annotation.EnableTransactionManagement

@Configuration
@EnableJpaRepositories(&quot;io.github.susimsek.springbootjweauthjpademo.repository&quot;)
@EnableJpaAuditing(auditorAwareRef = &quot;springSecurityAuditorAware&quot;)
@EnableTransactionManagement
class DatabaseConfig</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: JPA Entegrasyonu</h2>
<p>Bu b√∂l√ºmde, kullanƒ±cƒ±larƒ±, rollerleri ve bunlarƒ±n e≈ülemelerini temsil eden JPA entity‚Äôlerini ve kullanƒ±cƒ±larƒ± yetkileriyle birlikte y√ºklemek i√ßin Spring Data JPA deposunu tanƒ±mlƒ±yoruz.</p>
<ul>
<li>BaseEntity: Audit alanlarƒ± (`createdAt`, `createdBy`, `updatedAt`, `updatedBy`) saƒülayan soyut √ºst sƒ±nƒ±f.</li>
<li>Authority: Rol verilerini saklayan `authority` tablosu entity‚Äôsi.</li>
<li>User: Kullanƒ±cƒ± kimlik bilgileri ve profili saklayan `user_identity` tablosu entity‚Äôsi.</li>
<li>UserAuthorityMapping: Kullanƒ±cƒ±larƒ± ve rolleri birbirine baƒülayan `user_authority_mapping` ili≈üki tablosunun entity‚Äôsi.</li>
<li>UserAuthorityMappingId: `UserAuthorityMapping` i√ßin composite anahtar sƒ±nƒ±fƒ±.</li>
<li>UserRepository: Entity graph kullanarak kullanƒ±cƒ± ve yetkilerini getiren Spring Data JPA repository.</li>
</ul>
<h3>BaseEntity</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.entity;

import jakarta.persistence.Column;
import jakarta.persistence.EntityListeners;
import jakarta.persistence.MappedSuperclass;
import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.CreatedBy;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedBy;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;

import java.time.Instant;

@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
@Getter
@Setter
public abstract class BaseEntity {

  @CreatedDate
  @Column(name = &quot;created_at&quot;, nullable = false, updatable = false)
  private Instant createdAt;

  @CreatedBy
  @Column(name = &quot;created_by&quot;, nullable = false, updatable = false, length = 50)
  private String createdBy;

  @LastModifiedDate
  @Column(name = &quot;updated_at&quot;)
  private Instant updatedAt;

  @LastModifiedBy
  @Column(name = &quot;updated_by&quot;, length = 50)
  private String updatedBy;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.entity

import jakarta.persistence.Column
import jakarta.persistence.EntityListeners
import jakarta.persistence.MappedSuperclass
import org.springframework.data.annotation.CreatedBy
import org.springframework.data.annotation.CreatedDate
import org.springframework.data.annotation.LastModifiedBy
import org.springframework.data.annotation.LastModifiedDate
import org.springframework.data.jpa.domain.support.AuditingEntityListener
import java.time.Instant

@MappedSuperclass
@EntityListeners(AuditingEntityListener::class)
abstract class BaseEntity {

  @CreatedDate
  @Column(name = &quot;created_at&quot;, nullable = false, updatable = false)
  lateinit var createdAt: Instant

  @CreatedBy
  @Column(name = &quot;created_by&quot;, nullable = false, updatable = false, length = 50)
  lateinit var createdBy: String

  @LastModifiedDate
  @Column(name = &quot;updated_at&quot;)
  var updatedAt: Instant? = null

  @LastModifiedBy
  @Column(name = &quot;updated_by&quot;, length = 50)
  var updatedBy: String? = null
}</code></pre>
<h3>Authority</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import org.hibernate.proxy.HibernateProxy;

import java.util.Objects;

@Entity
@Table(name = &quot;authority&quot;)
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
public class Authority extends BaseEntity {

  @Id
  @Column(length = 36, nullable = false)
  private String id;

  @Column(length = 50, nullable = false, unique = true)
  private String name;

  @Column(length = 255)
  private String description;

  @Override
  public final boolean equals(Object obj) {
    if (this == obj) {
      return true;
    }
    if (!(obj instanceof Authority other)) {
      return false;
    }
    Class&lt;?&gt; objClass = obj instanceof HibernateProxy proxy
      ? proxy.getHibernateLazyInitializer().getPersistentClass()
      : obj.getClass();
    Class&lt;?&gt; thisClass = this instanceof HibernateProxy proxy
      ? proxy.getHibernateLazyInitializer().getPersistentClass()
      : this.getClass();
    if (!thisClass.equals(objClass)) {
      return false;
    }
    return id != null &amp;&amp; Objects.equals(id, other.id);
  }

  @Override
  public final int hashCode() {
    return this instanceof HibernateProxy proxy
      ? proxy.getHibernateLazyInitializer().getPersistentClass().hashCode()
      : getClass().hashCode();
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.entity

import jakarta.persistence.Column
import jakarta.persistence.Entity
import jakarta.persistence.Id
import jakarta.persistence.Table
import org.hibernate.proxy.HibernateProxy
import java.util.Objects

@Entity
@Table(name = &quot;authority&quot;)
class Authority(
  @Id
  @Column(length = 36, nullable = false)
  var id: String,

  @Column(length = 50, nullable = false, unique = true)
  var name: String,

  @Column(length = 255)
  var description: String?
) : BaseEntity() {

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other !is Authority) return false
    val objClass = (other as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass ?: other::class.java
    val thisClass = (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass ?: this::class.java
    if (thisClass != objClass) return false
    return id == other.id
  }

  override fun hashCode(): Int {
    return (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass?.hashCode()
      ?: javaClass.hashCode()
  }
}</code></pre>
<h3>User</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.entity;

import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.Id;
import jakarta.persistence.NamedAttributeNode;
import jakarta.persistence.NamedEntityGraph;
import jakarta.persistence.NamedSubgraph;
import jakarta.persistence.OneToMany;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import org.hibernate.proxy.HibernateProxy;

import java.util.HashSet;
import java.util.Objects;
import java.util.Set;

@Entity
@Table(name = &quot;user_identity&quot;)
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@NamedEntityGraph(
  name = &quot;User.withAuthorities&quot;,
  attributeNodes = @NamedAttributeNode(value = &quot;authorities&quot;, subgraph = &quot;auth-subgraph&quot;),
  subgraphs = @NamedSubgraph(
    name = &quot;auth-subgraph&quot;,
    attributeNodes = @NamedAttributeNode(&quot;authority&quot;)
  )
)
public class User extends BaseEntity {

  @Id
  @Column(name = &quot;id&quot;, length = 36, nullable = false, updatable = false)
  private String id;

  @Column(name = &quot;username&quot;, length = 50, nullable = false, unique = true)
  private String username;

  @Column(name = &quot;password&quot;, length = 100, nullable = false)
  private String password;

  @Column(name = &quot;email&quot;, length = 100, nullable = false, unique = true)
  private String email;

  @Column(name = &quot;first_name&quot;, length = 50)
  private String firstName;

  @Column(name = &quot;last_name&quot;, length = 50)
  private String lastName;

  @Column(name = &quot;enabled&quot;, nullable = false)
  private boolean enabled;

  @OneToMany(mappedBy = &quot;user&quot;, fetch = FetchType.LAZY,
    cascade = CascadeType.ALL, orphanRemoval = true)
  private Set&lt;UserAuthorityMapping&gt; authorities = new HashSet&lt;&gt;();

  @Override
  public final boolean equals(Object obj) {
    if (this == obj) return true;
    if (!(obj instanceof User other)) return false;
    Class&lt;?&gt; objClass = (obj instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : obj.getClass());
    Class&lt;?&gt; thisClass = (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : this.getClass());
    if (!thisClass.equals(objClass)) return false;
    return id != null &amp;&amp; id.equals(other.id);
  }

  @Override
  public final int hashCode() {
    return (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass().hashCode()
      : getClass().hashCode());
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.entity

import jakarta.persistence.CascadeType
import jakarta.persistence.Column
import jakarta.persistence.Entity
import jakarta.persistence.FetchType
import jakarta.persistence.Id
import jakarta.persistence.NamedAttributeNode
import jakarta.persistence.NamedEntityGraph
import jakarta.persistence.NamedSubgraph
import jakarta.persistence.OneToMany
import jakarta.persistence.Table
import org.hibernate.proxy.HibernateProxy
import java.util.*

@Entity
@Table(name = &quot;user_identity&quot;)
@NamedEntityGraph(
  name = &quot;User.withAuthorities&quot;,
  attributeNodes = [NamedAttributeNode(value = &quot;authorities&quot;, subgraph = &quot;auth-subgraph&quot;)],
  subgraphs = [
    NamedSubgraph(
      name = &quot;auth-subgraph&quot;,
      attributeNodes = [NamedAttributeNode(&quot;authority&quot;)]
    )
  ]
)
class User(

  @Id
  @Column(name = &quot;id&quot;, length = 36, nullable = false, updatable = false)
  var id: String,

  @Column(name = &quot;username&quot;, length = 50, nullable = false, unique = true)
  var username: String,

  @Column(name = &quot;password&quot;, length = 100, nullable = false)
  var password: String,

  @Column(name = &quot;email&quot;, length = 100, nullable = false, unique = true)
  var email: String,

  @Column(name = &quot;first_name&quot;, length = 50)
  var firstName: String? = null,

  @Column(name = &quot;last_name&quot;, length = 50)
  var lastName: String? = null,

  @Column(name = &quot;enabled&quot;, nullable = false)
  var enabled: Boolean = true

) : BaseEntity() {

  @OneToMany(
    mappedBy = &quot;user&quot;,
    fetch = FetchType.LAZY,
    cascade = [CascadeType.ALL],
    orphanRemoval = true
  )
  var authorities: MutableSet&lt;UserAuthorityMapping&gt; = HashSet()

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other !is User) return false
    val objClass = (other as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: other::class.java
    val thisClass = (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: this::class.java
    if (thisClass != objClass) return false
    return id == other.id
  }

  override fun hashCode(): Int =
    ((this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass?.hashCode()
      ?: javaClass.hashCode())
}</code></pre>
<h3>UserAuthorityMapping</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.Id;
import jakarta.persistence.IdClass;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToOne;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import org.hibernate.proxy.HibernateProxy;

import java.util.Objects;

@Entity
@Table(name = &quot;user_authority_mapping&quot;)
@IdClass(UserAuthorityMappingId.class)
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
public class UserAuthorityMapping extends BaseEntity {

  @Id
  @Column(name = &quot;user_id&quot;, length = 36, nullable = false)
  private String userId;

  @Id
  @Column(name = &quot;authority_id&quot;, length = 36, nullable = false)
  private String authorityId;

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;user_id&quot;, insertable = false, updatable = false)
  private User user;

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;authority_id&quot;, insertable = false, updatable = false)
  private Authority authority;

  @Override
  public final boolean equals(Object obj) {
    if (this == obj) return true;
    if (!(obj instanceof UserAuthorityMapping other)) return false;
    Class&lt;?&gt; objCls = (obj instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : obj.getClass());
    Class&lt;?&gt; thisCls = (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass()
      : this.getClass());
    if (!thisCls.equals(objCls)) return false;
    return userId != null &amp;&amp; userId.equals(other.userId)
      &amp;&amp; authorityId != null &amp;&amp; authorityId.equals(other.authorityId);
  }

  @Override
  public final int hashCode() {
    return (this instanceof HibernateProxy hp
      ? hp.getHibernateLazyInitializer().getPersistentClass().hashCode()
      : Objects.hash(userId, authorityId));
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.entity

import jakarta.persistence.*
import org.hibernate.proxy.HibernateProxy
import java.util.*

@Entity
@Table(name = &quot;user_authority_mapping&quot;)
@IdClass(UserAuthorityMappingId::class)
data class UserAuthorityMapping(

  @Id
  @Column(name = &quot;user_id&quot;, length = 36, nullable = false)
  var userId: String = &quot;&quot;,

  @Id
  @Column(name = &quot;authority_id&quot;, length = 36, nullable = false)
  var authorityId: String = &quot;&quot;,

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;user_id&quot;, insertable = false, updatable = false)
  var user: User? = null,

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;authority_id&quot;, insertable = false, updatable = false)
  var authority: Authority? = null

) : BaseEntity() {

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other !is UserAuthorityMapping) return false

    val objCls = (other as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: other::class.java
    val thisCls = (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass
      ?: this::class.java

    if (thisCls != objCls) return false
    return userId == other.userId &amp;&amp; authorityId == other.authorityId
  }

  override fun hashCode(): Int {
    return (this as? HibernateProxy)?.hibernateLazyInitializer?.persistentClass?.hashCode()
      ?: Objects.hash(userId, authorityId)
  }
}</code></pre>
<h3>UserAuthorityMappingId</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.entity;

import java.io.Serializable;
import java.util.Objects;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
public class UserAuthorityMappingId implements Serializable {

  private String userId;
  private String authorityId;

  @Override
  public boolean equals(Object o) {
    if (this == o) return true;
    if (o == null || getClass() != o.getClass()) return false;
    UserAuthorityMappingId that = (UserAuthorityMappingId) o;
    return Objects.equals(userId, that.userId) &amp;&amp;
      Objects.equals(authorityId, that.authorityId);
  }

  @Override
  public int hashCode() {
    return Objects.hash(userId, authorityId);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.entity

import java.io.Serializable
import java.util.Objects

data class UserAuthorityMappingId(
  var userId: String = &quot;&quot;,
  var authorityId: String = &quot;&quot;
) : Serializable {

  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (other == null || this::class != other::class) return false
    other as UserAuthorityMappingId
    return userId == other.userId &amp;&amp; authorityId == other.authorityId
  }

  override fun hashCode(): Int {
    return Objects.hash(userId, authorityId)
  }
}</code></pre>
<h3>UserRepository</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.repository;

import io.github.susimsek.springbootjweauthjpademo.entity.User;
import org.springframework.data.jpa.repository.EntityGraph;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.util.Optional;

@Repository
public interface UserRepository extends JpaRepository&lt;User, String&gt; {

  @EntityGraph(&quot;User.withAuthorities&quot;)
  Optional&lt;User&gt; findOneWithAuthoritiesByUsername(String username);
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.repository

import io.github.susimsek.springbootjweauthjpademo.entity.User
import org.springframework.data.jpa.repository.EntityGraph
import org.springframework.data.jpa.repository.JpaRepository
import org.springframework.stereotype.Repository
import java.util.Optional

@Repository
interface UserRepository : JpaRepository&lt;User, String&gt; {

  @EntityGraph(&quot;User.withAuthorities&quot;)
  fun findOneWithAuthoritiesByUsername(username: String): Optional&lt;User&gt;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: G√ºvenli JWE Token Yardƒ±mcƒ± Sƒ±nƒ±flarƒ± Olu≈üturun</h2>
<p>Bu b√∂l√ºmde, Spring Boot uygulamanƒ±zda JSON Web Encryption (JWE) tokenlarƒ± olu≈üturmak, ≈üifrelemek ve √ß√∂zmek i√ßin gerekli temel yardƒ±mcƒ± sƒ±nƒ±flarƒ± ve sabitleri tanƒ±mlƒ±yoruz. Ayrƒ±ca auditing entegrasyonu ve JPA tabanlƒ± UserDetailsService de ekliyoruz:</p>
<ul>
<li>AuthoritiesConstants: `ROLE_` √∂n ekiyle rol isimlerini merkezile≈ütirir.</li>
<li>CookieBearerTokenResolver: Bearer token‚Äôlarƒ± yetkilendirme ba≈ülƒ±klarƒ±ndan veya HTTP √ßerezlerinden √ß√∂zer.</li>
<li>CookieUtils: Eri≈üim token‚Äôlarƒ± i√ßin HTTP-only ve secure √ßerezler olu≈üturur.</li>
<li>JweUtil: Nimbus k√ºt√ºphanesi ile RSA anahtarlarƒ± kullanarak JWT‚Äôleri imzalar (JWS) ve ≈üifreler (JWE).</li>
<li>KeyUtils: PEM formatƒ±ndaki anahtar √ßiftinden RSA JWK‚Äôleri olu≈üturur.</li>
<li>SecurityUtils: SecurityContext oturum a√ßan kullanƒ±cƒ±nƒ±n bilgisini sunar.</li>
<li>SpringSecurityAuditorAware: Auditing i√ßin oturum a√ßan kullanƒ±cƒ±yƒ± saƒülayan `AuditorAware` implementasyonu.</li>
<li>DomainUserDetailsService: JPA tabanlƒ± `UserDetailsService`, kullanƒ±cƒ± kimlik bilgilerini ve yetkilerini getirir.</li>
</ul>
<p>Bu yardƒ±mcƒ±lar, Spring Security ile durumsuz (stateless) JWE tabanlƒ± bir kimlik doƒürulama akƒ±≈üƒ±nƒ±n temelini olu≈üturur.</p>
<h3>AuthoritiesConstants</h3>
<h3>Java</h3>
<pre><code class="language-java">
package io.github.susimsek.springbootjweauthjpademo.security;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class AuthoritiesConstants {
    public static final String ADMIN = &quot;ROLE_ADMIN&quot;;
    public static final String USER = &quot;ROLE_USER&quot;;
    public static final String ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">
package io.github.susimsek.springbootjweauthjpademo.security

object AuthoritiesConstants {
  const val ADMIN = &quot;ROLE_ADMIN&quot;
  const val USER = &quot;ROLE_USER&quot;
  const val ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;
}</code></pre>
<h3>CookieBearerTokenResolver</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletRequest;
import lombok.Setter;
import org.springframework.http.HttpMethod;
import org.springframework.security.oauth2.core.OAuth2AuthenticationException;
import org.springframework.security.oauth2.server.resource.BearerTokenError;
import org.springframework.security.oauth2.server.resource.BearerTokenErrors;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;
import org.springframework.util.StringUtils;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

@Setter
public class CookieBearerTokenResolver implements BearerTokenResolver {
    private static final String ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;;
    private static final Pattern AUTHORIZATION_PATTERN =
        Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE);

    private boolean allowFormEncodedBodyParameter = false;
    private boolean allowUriQueryParameter       = false;
    private boolean allowCookie                  = true;
    private String  bearerTokenHeaderName       = &quot;Authorization&quot;;
    private String  cookieName                  = &quot;accessToken&quot;;

    @Override
    public String resolve(HttpServletRequest request) {
        String headerToken = resolveFromAuthorizationHeader(request);
        String queryToken  = resolveAccessTokenFromQueryString(request);
        String bodyToken   = resolveAccessTokenFromBody(request);
        String cookieToken = (headerToken == null &amp;&amp; queryToken == null &amp;&amp; bodyToken == null)
            ? resolveFromCookie(request)
            : null;

        return resolveToken(headerToken, queryToken, bodyToken, cookieToken);
    }

    private String resolveFromAuthorizationHeader(HttpServletRequest request) {
        String authorization = request.getHeader(this.bearerTokenHeaderName);
        if (!StringUtils.hasText(authorization) || !authorization.toLowerCase().startsWith(&quot;bearer&quot;)) {
            return null;
        }
        Matcher matcher = AUTHORIZATION_PATTERN.matcher(authorization.trim());
        if (!matcher.matches()) {
            BearerTokenError error = BearerTokenErrors.invalidToken(&quot;Bearer token is malformed&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return matcher.group(&quot;token&quot;);
    }

    private String resolveAccessTokenFromQueryString(HttpServletRequest request) {
        if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.getMethod())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveAccessTokenFromBody(HttpServletRequest request) {
        if (allowFormEncodedBodyParameter
            &amp;&amp; HttpMethod.POST.matches(request.getMethod())
            &amp;&amp; &quot;application/x-www-form-urlencoded&quot;.equals(request.getContentType())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveFromCookie(HttpServletRequest request) {
        if (!allowCookie || request.getCookies() == null) {
            return null;
        }
        for (Cookie cookie : request.getCookies()) {
            if (cookieName.equals(cookie.getName())) {
                String val = cookie.getValue();
                return StringUtils.hasText(val) ? val : null;
            }
        }
        return null;
    }

    private String resolveToken(String... tokens) {
        String found = null;
        for (String token : tokens) {
            if (token == null) continue;
            if (found != null) {
                BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens in the request&quot;);
                throw new OAuth2AuthenticationException(error);
            }
            found = token;
        }
        if (found != null &amp;&amp; found.isBlank()) {
            BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;The requested token parameter is an empty string&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return found;
    }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import jakarta.servlet.http.Cookie
import jakarta.servlet.http.HttpServletRequest
import org.springframework.http.HttpMethod
import org.springframework.security.oauth2.core.OAuth2AuthenticationException
import org.springframework.security.oauth2.server.resource.BearerTokenError
import org.springframework.security.oauth2.server.resource.BearerTokenErrors
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver
import org.springframework.util.StringUtils
import java.util.regex.Pattern

class CookieBearerTokenResolver {
    var allowFormEncodedBodyParameter: Boolean = false
    var allowUriQueryParameter: Boolean = false
    var allowCookie: Boolean = true
    var bearerTokenHeaderName: String = &quot;Authorization&quot;
    var cookieName: String = &quot;accessToken&quot;

    companion object {
        private const val ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;
        private val AUTHORIZATION_PATTERN =
            Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE)
    }

    fun resolve(request: HttpServletRequest): String? {
        val header = resolveFromAuthorizationHeader(request)
        val query  = if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.method))
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val body   = if (allowFormEncodedBodyParameter &amp;&amp; HttpMethod.POST.matches(request.method)
            &amp;&amp; request.contentType == &quot;application/x-www-form-urlencoded&quot;)
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val cookie = if (header == null &amp;&amp; query == null &amp;&amp; body == null)
            resolveFromCookie(request)
        else null
      return listOf(header, query, body, cookie).filterNotNull().let {
            if (it.size &gt; 1) throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens&quot;))
            it.firstOrNull()?: null
        }
    }

    private fun resolveFromAuthorizationHeader(request: HttpServletRequest): String? {
        val auth = request.getHeader(bearerTokenHeaderName) ?: return null
        if (!auth.startsWith(&quot;Bearer &quot;, true)) return null
        val matcher = AUTHORIZATION_PATTERN.matcher(auth.trim())
        return if (matcher.matches()) matcher.group(&quot;token&quot;)
        else throw OAuth2AuthenticationException(BearerTokenErrors.invalidToken(&quot;Malformed token&quot;))
    }

    private fun resolveFromCookie(request: HttpServletRequest): String? {
        if (!allowCookie) return null
        return request.cookies?.firstOrNull { it.name == cookieName }?.value?.takeIf { it.isNotBlank() }
    }

    private fun resolveToken(tokens: Array&lt;String&gt;): String? {
        return tokens.filter { it.isNotBlank() }.let {
            when {
                it.isEmpty() -&gt; null
                it.size &gt; 1   -&gt; throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Multiple tokens&quot;))
                else          -&gt; it[0]
            }
        }
    }</code></pre>
<h3>CookieUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO;
import lombok.experimental.UtilityClass;
import org.springframework.http.ResponseCookie;

@UtilityClass
public class CookieUtils {

    private static final String COOKIE_NAME = &quot;accessToken&quot;;

    public ResponseCookie createAccessTokenCookie(TokenDTO tokenDto) {
        return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
            .httpOnly(true)
            .secure(true)
            .path(&quot;/&quot;)
            .maxAge(tokenDto.accessTokenExpiresIn())
            .sameSite(&quot;Strict&quot;)
            .build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO
import org.springframework.http.ResponseCookie

object CookieUtils {

  private const val COOKIE_NAME = &quot;accessToken&quot;

  fun createAccessTokenCookie(tokenDto: TokenDTO): ResponseCookie {
    return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(tokenDto.accessTokenExpiresIn())
      .sameSite(&quot;Strict&quot;)
      .build()
  }
}</code></pre>
<h3>JweUtil</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JOSEException;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWEHeader;
import com.nimbusds.jose.JWEObject;
import com.nimbusds.jose.Payload;
import com.nimbusds.jose.crypto.RSAEncrypter;
import com.nimbusds.jose.jwk.RSAKey;
import io.github.susimsek.springbootjweauthjpademo.config.JwtProperties;
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm;
import org.springframework.security.oauth2.jwt.*;
import org.springframework.stereotype.Component;

import java.time.Instant;
import java.util.List;

import static io.github.susimsek.springbootjweauthjpademo.security.SecurityUtils.AUTHORITIES_KEY;

@Component
@RequiredArgsConstructor
public class JweUtil {

    private final JwtEncoder jwtEncoder;
    private final RSAKey signingKey;
    private final RSAKey encryptionKey;
    private final JwtProperties props;

    public TokenDTO generateToken(Authentication authentication) throws JOSEException {
        String subject = authentication.getName();
        List&lt;String&gt; roles = authentication.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority)
            .toList();

        Instant now = Instant.now();
        long expiresIn = props.getExpirationDuration().getSeconds();
        Instant exp = now.plusSeconds(expiresIn);

        JwtClaimsSet claims = JwtClaimsSet.builder()
            .issuer(props.getIssuer())
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build();

        JwsHeader jwsHeader = JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.getKeyID())
            .build();

        String jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .getTokenValue();

        JWEHeader jweHeader = new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.getKeyID())
            .build();

        JWEObject jweObject = new JWEObject(jweHeader, new Payload(jws));
        jweObject.encrypt(new RSAEncrypter(encryptionKey.toRSAPublicKey()));
        String token = jweObject.serialize();

        return new TokenDTO(token, &quot;Bearer&quot;, expiresIn);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JOSEException
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWEHeader
import com.nimbusds.jose.JWEObject
import com.nimbusds.jose.Payload
import com.nimbusds.jose.crypto.RSAEncrypter
import com.nimbusds.jose.jwk.RSAKey
import io.github.susimsek.springbootjweauthjpademo.config.JwtProperties
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO
import lombok.RequiredArgsConstructor
import org.springframework.security.core.Authentication
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm
import org.springframework.security.oauth2.jwt.JwtClaimsSet
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.JwtEncoderParameters
import org.springframework.stereotype.Component

import java.time.Instant

@Component
@RequiredArgsConstructor
class JweUtil(
    private val jwtEncoder: JwtEncoder,
    private val signingKey: RSAKey,
    private val encryptionKey: RSAKey,
    private val props: JwtProperties
) {
    fun generateToken(authentication: Authentication): TokenDTO {
        val subject = authentication.name
        val roles = authentication.authorities.map { it.authority }

        val now = Instant.now()
        val expiresIn = props.expirationDuration.seconds
        val exp = now.plusSeconds(expiresIn)

        val claims = JwtClaimsSet.builder()
            .issuer(props.issuer)
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build()

        val jwsHeader = org.springframework.security.oauth2.jwt.JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.keyID)
            .build()

        val jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .tokenValue

        val jweHeader = JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.keyID)
            .build()

        val jweObject = JWEObject(jweHeader, Payload(jws))
        jweObject.encrypt(RSAEncrypter(encryptionKey.toRSAPublicKey()))
        val token = jweObject.serialize()

        return TokenDTO(token, &quot;Bearer&quot;, expiresIn)
    }
}</code></pre>
<h3>KeyUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.KeyUse;
import com.nimbusds.jose.jwk.RSAKey;
import lombok.experimental.UtilityClass;

import java.security.KeyFactory;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.util.Base64;

@UtilityClass
public class KeyUtils {
    public RSAKey buildRsaKey(
            String pubPem,
            String privPem,
            String kid,
            boolean forSign
    ) throws Exception {
        String pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);
        String privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);

        byte[] decodedPub = Base64.getDecoder().decode(pubContent);
        byte[] decodedPriv = Base64.getDecoder().decode(privContent);

        KeyFactory kf = KeyFactory.getInstance(&quot;RSA&quot;);
        RSAPublicKey publicKey = (RSAPublicKey) kf.generatePublic(new X509EncodedKeySpec(decodedPub));
        RSAPrivateKey privateKey = (RSAPrivateKey) kf.generatePrivate(new PKCS8EncodedKeySpec(decodedPriv));

        RSAKey.Builder builder = new RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid);

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE);
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION);
        }

        return builder.build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.KeyUse
import com.nimbusds.jose.jwk.RSAKey
import java.security.KeyFactory
import java.security.interfaces.RSAPrivateKey
import java.security.interfaces.RSAPublicKey
import java.security.spec.PKCS8EncodedKeySpec
import java.security.spec.X509EncodedKeySpec
import java.util.Base64

object KeyUtils {
    @JvmStatic
    @Throws(Exception::class)
    fun buildRsaKey(
        pubPem: String,
        privPem: String,
        kid: String,
        forSign: Boolean
    ): RSAKey {
        val pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)
        val privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)

        val decodedPub = Base64.getDecoder().decode(pubContent)
        val decodedPriv = Base64.getDecoder().decode(privContent)

        val kf = KeyFactory.getInstance(&quot;RSA&quot;)
        val publicKey = kf.generatePublic(X509EncodedKeySpec(decodedPub)) as RSAPublicKey
        val privateKey = kf.generatePrivate(PKCS8EncodedKeySpec(decodedPriv)) as RSAPrivateKey

        val builder = RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid)

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE)
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION)
        }

        return builder.build()
    }
}</code></pre>
<h3>SecurityUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import lombok.experimental.UtilityClass;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.oauth2.jwt.Jwt;

import java.util.Optional;

@UtilityClass
public class SecurityUtils {

    public static final String AUTHORITIES_KEY = &quot;auth&quot;;

    public Optional&lt;String&gt; getCurrentUserLogin() {
        var ctx = SecurityContextHolder.getContext();
        return Optional.ofNullable(extractPrincipal(ctx.getAuthentication()));
    }

    private String extractPrincipal(Authentication authentication) {
        if (authentication == null) {
            return null;
        }
        Object principal = authentication.getPrincipal();
        if (principal instanceof Jwt jwt) {
            return jwt.getSubject();
        }
        if (principal instanceof UserDetails ud) {
            return ud.getUsername();
        }
        if (principal instanceof String username) {
            return username;
        }
        return null;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.security.core.userdetails.UserDetails
import org.springframework.security.oauth2.jwt.Jwt
import java.util.Optional

object SecurityUtils {
  const val AUTHORITIES_KEY = &quot;auth&quot;

  fun getCurrentUserLogin(): Optional&lt;String&gt; {
    val authentication: Authentication? = SecurityContextHolder.getContext().authentication
    return Optional.ofNullable(extractPrincipal(authentication))
  }

  private fun extractPrincipal(authentication: Authentication?): String? {
    return when (val principal = authentication?.principal) {
      is Jwt -&gt; principal.subject
      is UserDetails -&gt; principal.username
      is String -&gt; principal
      else -&gt; null
    }
  }
}</code></pre>
<h3>DomainUserDetailsService</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import io.github.susimsek.springbootjweauthjpademo.entity.User;
import io.github.susimsek.springbootjweauthjpademo.repository.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;

import java.util.List;
import java.util.stream.Collectors;

@RequiredArgsConstructor
public class DomainUserDetailsService implements UserDetailsService {

  private final UserRepository userRepository;

  @Override
  public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
    User user = userRepository.findOneWithAuthoritiesByUsername(username)
      .orElseThrow(() -&gt; new UsernameNotFoundException(&quot;User not found with username: &quot; + username));

    List&lt;GrantedAuthority&gt; authorities = user.getAuthorities().stream()
      .map(mapping -&gt; mapping.getAuthority().getName())
      .map(SimpleGrantedAuthority::new)
      .collect(Collectors.toList());

    return new org.springframework.security.core.userdetails.User(
      user.getUsername(),
      user.getPassword(),
      user.isEnabled(),  // enabled
      true,              // accountNonExpired
      true,              // credentialsNonExpired
      true,              // accountNonLocked
      authorities
    );
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import io.github.susimsek.springbootjweauthjpademo.repository.UserRepository
import org.springframework.security.core.GrantedAuthority
import org.springframework.security.core.authority.SimpleGrantedAuthority
import org.springframework.security.core.userdetails.UserDetails
import org.springframework.security.core.userdetails.UserDetailsService
import org.springframework.security.core.userdetails.UsernameNotFoundException
import java.util.stream.Collectors

class DomainUserDetailsService(
  private val userRepository: UserRepository
) : UserDetailsService {
  override fun loadUserByUsername(username: String): UserDetails {
    val user = userRepository.findOneWithAuthoritiesByUsername(username)
      .orElseThrow { UsernameNotFoundException(&quot;User not found with username: $username&quot;) }

    val authorities: List&lt;GrantedAuthority&gt; = user.authorities.stream()
      .map { SimpleGrantedAuthority(it.authority.name) }
      .collect(Collectors.toList())

    return org.springframework.security.core.userdetails.User(
      user.username,
      user.password,
      user.enabled,
      true,
      true,
      true,
      authorities
    )
  }
}</code></pre>
<h3>SpringSecurityAuditorAware</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.security;

import org.springframework.data.domain.AuditorAware;
import org.springframework.lang.NonNull;
import org.springframework.stereotype.Component;

import java.util.Optional;

@Component
public class SpringSecurityAuditorAware implements AuditorAware&lt;String&gt; {

  @Override
  @NonNull
  public Optional&lt;String&gt; getCurrentAuditor() {
    return Optional.of(SecurityUtils.getCurrentUserLogin().orElse(&quot;system&quot;));
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.security

import org.springframework.data.domain.AuditorAware
import org.springframework.lang.NonNull
import org.springframework.stereotype.Component

@Component
class SpringSecurityAuditorAware : AuditorAware&lt;String&gt; {
    @NonNull
    override fun getCurrentAuditor(): Optional&lt;String&gt; =
        Optional.of(SecurityUtils.getCurrentUserLogin().orElse(&quot;system&quot;))
}</code></pre>
<hr />
<h2>üß™ Adƒ±m 6: Kimlik Doƒürulama ve G√ºvenli Endpointler</h2>
<p>Bu b√∂l√ºmde, a≈üaƒüƒ±dakileri ger√ßekle≈ütirmek i√ßin gerekli REST controller ve DTO‚Äôlarƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>AuthController: Kullanƒ±cƒ±larƒ± doƒürular, JWE token‚Äôlarƒ± olu≈üturur ve g√ºvenli cookie ayarlar.</li>
<li>HelloController: Kimliƒüi doƒürulanmƒ±≈ü kullanƒ±cƒ±lar ve yalnƒ±zca admine √∂zel pathler i√ßin g√ºvenli endpointler sunar.</li>
<li>LoginRequestDTO: Login isteƒüi payloadƒ±nƒ± (kullanƒ±cƒ± adƒ±/parola) modelleyen DTO.</li>
<li>TokenDTO: Token ve ge√ßerlilik s√ºresini i√ßeren kimlik doƒürulama yanƒ±tƒ±nƒ± modelleyen DTO.</li>
</ul>
<p>Bu bile≈üenler, login i≈ülemi, token olu≈üturma, cookie y√∂netimi ve kaynak korumasƒ±nƒ± i≈üleyerek stateless(durumsuz) kimlik doƒürulama akƒ±≈üƒ±nƒ± tamamlar.</p>
<p>Bu b√∂l√ºmde, kullanƒ±cƒ± kimlik doƒürulamasƒ±nƒ±, token olu≈üturmayƒ± ve korunan kaynak eri≈üimini y√∂netmek i√ßin REST controller ve DTO‚Äôlarƒ± olu≈üturuyoruz.</p>
<h3>AuthController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.controller;

import io.github.susimsek.springbootjweauthjpademo.dto.LoginRequestDTO;
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO;
import io.github.susimsek.springbootjweauthjpademo.security.CookieUtils;
import io.github.susimsek.springbootjweauthjpademo.security.JweUtil;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseCookie;
import org.springframework.http.ResponseEntity;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequiredArgsConstructor
@RequestMapping(&quot;/api/auth&quot;)
public class AuthController {

    private final AuthenticationManager authenticationManager;
    private final JweUtil jweUtil;

    @PostMapping(&quot;/login&quot;)
    public ResponseEntity&lt;TokenDTO&gt; login(@RequestBody LoginRequestDTO loginRequest) throws Exception {
        // Authenticate user
        var authToken = new UsernamePasswordAuthenticationToken(
            loginRequest.username(), loginRequest.password()
        );
        Authentication auth = authenticationManager.authenticate(authToken);
        SecurityContextHolder.getContext().setAuthentication(auth);

        // Generate JWE token and cookie
        TokenDTO tokenDto = jweUtil.generateToken(auth);
        ResponseCookie cookie = CookieUtils.createAccessTokenCookie(tokenDto);

        return ResponseEntity.ok()
            .header(HttpHeaders.SET_COOKIE, cookie.toString())
            .body(tokenDto);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.controller

import io.github.susimsek.springbootjweauthjpademo.dto.LoginRequestDTO
import io.github.susimsek.springbootjweauthjpademo.dto.TokenDTO
import io.github.susimsek.springbootjweauthjpademo.security.CookieUtils
import io.github.susimsek.springbootjweauthjpademo.security.JweUtil
import lombok.RequiredArgsConstructor
import org.springframework.http.HttpHeaders
import org.springframework.http.ResponseCookie
import org.springframework.http.ResponseEntity
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken
import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.web.bind.annotation.PostMapping
import org.springframework.web.bind.annotation.RequestBody
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequiredArgsConstructor
@RequestMapping(&quot;/api/auth&quot;)
class AuthController(
    private val authenticationManager: AuthenticationManager,
    private val jweUtil: JweUtil
) {

    @PostMapping(&quot;/login&quot;)
    fun login(@RequestBody loginRequest: LoginRequestDTO): ResponseEntity&lt;TokenDTO&gt; {
        val authToken = UsernamePasswordAuthenticationToken(
            loginRequest.username, loginRequest.password
        )
        val auth: Authentication = authenticationManager.authenticate(authToken)
        SecurityContextHolder.getContext().authentication = auth

        val tokenDto: TokenDTO = jweUtil.generateToken(auth)
        val cookie: ResponseCookie = CookieUtils.createAccessTokenCookie(tokenDto)

        return ResponseEntity.ok()
            .header(HttpHeaders.SET_COOKIE, cookie.toString())
            .body(tokenDto)
    }
}</code></pre>
<h3>HelloController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.controller;

import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.oauth2.jwt.Jwt;
import org.springframework.web.bind.annotation.*;

import static io.github.susimsek.springbootjweauthjpademo.security.SecurityUtils.AUTHORITIES_KEY;

@RestController
@RequestMapping(&quot;/api/hello&quot;)
public class HelloController {

    @GetMapping
    public String helloAll(@AuthenticationPrincipal Jwt jwt) {
        String user = jwt.getSubject();
        var roles = jwt.getClaimAsStringList(AUTHORITIES_KEY);
        return &quot;Hello, &quot; + user + &quot;! Your roles: &quot; + roles;
    }

    @GetMapping(&quot;/admin&quot;)
    public String helloAdmin(@AuthenticationPrincipal Jwt jwt) {
        return &quot;Hello Admin, &quot; + jwt.getSubject() + &quot;!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.controller

import org.springframework.security.core.annotation.AuthenticationPrincipal
import org.springframework.security.oauth2.jwt.Jwt
import org.springframework.web.bind.annotation.*

import io.github.susimsek.springbootjweauthjpademo.security.SecurityUtils.AUTHORITIES_KEY

@RestController
@RequestMapping(&quot;/api/hello&quot;)
class HelloController {

    @GetMapping
    fun helloAll(@AuthenticationPrincipal jwt: Jwt): String {
        val user = jwt.subject
        val roles = jwt.getClaimAsStringList(AUTHORITIES_KEY)
        return &quot;Hello, \$user! Your roles: \$roles&quot;
    }

    @GetMapping(&quot;/admin&quot;)
    fun helloAdmin(@AuthenticationPrincipal jwt: Jwt): String {
        return &quot;Hello Admin, \${jwt.subject}!&quot;
    }
}</code></pre>
<h3>LoginRequestDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.dto;

public record LoginRequestDTO(
    String username,
    String password
) { }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.dto

data class LoginRequestDTO(
    val username: String,
    val password: String
)</code></pre>
<h3>TokenDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjweauthjpademo.dto;

public record TokenDTO(
    String accessToken,
    String tokenType,
    long accessTokenExpiresIn
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjweauthjpademo.dto

import kotlin.Long

data class TokenDTO(
    val accessToken: String,
    val tokenType: String,
    val accessTokenExpiresIn: Long
)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±r</h2>
<pre><code class="language-bash">./mvnw spring-boot:run
# or
gradle bootRun</code></pre>
<hr />
<h2>üß™ Endpoint Testi</h2>
<h3>Admin Akƒ±≈üƒ±</h3>
<p>admin olarak giri≈ü yapƒ±n ve `Set-Cookie` ba≈ülƒ±ƒüƒ±ndan JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/api/auth/login \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;adminpass&quot;}&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
<li>Yanƒ±t:</li>
</ul>
<pre><code class="language-json">{
  &quot;accessToken&quot;: &quot;&lt;jwe-token&gt;&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;accessTokenExpiresIn&quot;: 3600
}</code></pre>
<p>cookie kullanarak `hello` endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Veya Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>admin-√∂zel endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello/admin</code></pre>
<h3>Kullanƒ±cƒ± Akƒ±≈üƒ±</h3>
<p>user olarak giri≈ü yapƒ±n ve cookie‚Äôden JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/api/auth/login \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;username&quot;:&quot;user&quot;,&quot;password&quot;:&quot;userpass&quot;}&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
</ul>
<p>cookie kullanarak `hello` endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Admin endpointini deneyince (403 Forbidden d√∂ner):</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello/admin
# HTTP/1.1 403 Forbidden</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot JPA ile JWE Kimlik Doƒürulamasƒ± i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[G√ºvenlik]]></category>
      <category><![CDATA[JWT]]></category>
      <category><![CDATA[JWE]]></category>
      <category><![CDATA[JPA]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-jwe-auth-with-jpa-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot LDAP ve JWE Kimlik Doƒürulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-ldap-jwe-authentication</link>
      <description><![CDATA[LDAP kimlik doƒürulama ve JWE ≈üifreli JWT‚Äôlerle Spring Boot API‚Äôlerinizi external directory entegrasyonu ve token gizliliƒüi ile nasƒ±l g√ºvene alacaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Sat, 10 May 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-ldap-jwe-authentication</guid>
      <content:encoded><![CDATA[<p>Spring Boot, LDAP kimlik doƒürulamasƒ±nƒ± JWE ile ≈üifrelenmi≈ü JWT‚Äôlerle birle≈ütirerek API‚Äôlarƒ±nƒ±zƒ± hem external directory hem de token gizliliƒüiyle g√ºvence altƒ±na almanƒ±zƒ± saƒülar.</p>
<hr />
<h2>üåü Neden LDAP ve JWE?</h2>
<ul>
<li>Dƒ±≈ü Directory: LDAP ile kullanƒ±cƒ± y√∂netimini merkezi hale getirin (kurumsal veya g√∂m√ºl√º directory).</li>
<li>B√ºt√ºnl√ºk &amp; Gizlilik: Token‚Äôlarƒ± imzalayƒ±n (JWS) ve ≈üifreleyin (JWE) ‚Äî g√ºvenli ta≈üƒ±ma.</li>
<li>Standartlara Uygun: JOSE (JWS &amp; JWE) ve Spring Security OAuth2 Resource Server.</li>
<li>Rol Tabanlƒ± Eri≈üim: LDAP gruplarƒ±nƒ± `ROLE_USER` / `ROLE_ADMIN` rollerine otomatik e≈üleyin.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>‚òï Java Development Kit (JDK) 17 veya √ºzeri</li>
<li>üì¶ Spring Boot 3.2+</li>
<li>üóÑÔ∏è LDAP (Embedded veya harici)</li>
<li>üî§ IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekle</h2>
<p>Bu satƒ±rlarƒ± `pom.xml` veya `build.gradle` dosyanƒ±za ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
  &lt;artifactId&gt;spring-security-oauth2-resource-server&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
  &lt;artifactId&gt;spring-security-ldap&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.unboundid&lt;/groupId&gt;
  &lt;artifactId&gt;unboundid-ldapsdk&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
  &lt;artifactId&gt;lombok&lt;/artifactId&gt;
  &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
implementation &#39;org.springframework.security:spring-security-oauth2-resource-server&#39;
implementation &#39;org.springframework.security:spring-security-ldap&#39;
implementation &#39;com.unboundid:unboundid-ldapsdk&#39;
compileOnly &#39;org.projectlombok:lombok&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Anahtar ve LDAP Yapƒ±landƒ±rmasƒ±</h2>
<p>Embeded LDAP directory, kullanƒ±cƒ±/grup yapƒ±nƒ±zƒ± ve RSA anahtar √∂zelliklerinizi `application.yml` ve `schema.ldif` dosyalarƒ±nda tanƒ±mlayƒ±n:</p>
<h3>application.yml</h3>
<pre><code class="language-yaml">spring:
  ldap:
    embedded:
      ldif: classpath:schema.ldif
      base-dn: dc=suaybsimsek,dc=com
      port: 8389
    urls: ldap://localhost:8389
    base: dc=suaybsimsek,dc=com
security:
  jwt:
    issuer: demo-issuer
    expiration-duration: 3600s
    signing:
      key-id: signing-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjZEcz5itWkDGOSqZdB5P
        JE0ccOCckskp0hN3kQbT1qnv+9/k66jlWgVi4HSTppwdNF/Ylu5u541Qj+Okyg+u
        8o2PvKo5CfgvTDsFLTrZHUXU6hCSGatLAQoeN6lT8wzov2r4DFecXrIqcO6SvMB5
        ecPqsfiTi4trsNKgJ4cWS6gILH62ISd1ipUadfpnUzDMO1OulV0CJNV6bcBk7Es9
        RW6AHfg9j8osSanpwvRM4MJkB0SRxYUnrN9faGpkBZISZJ8TShhaTHEGfSNgKe5y
        8iu+AMGGZu8DYczVmqS3Ske1fq6y5HEGCma7Mo019GmwKeHBo1obuET6cZRygj4y
        twIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCNkRzPmK1aQMY5
        Kpl0Hk8kTRxw4JySySnSE3eRBtPWqe/73+TrqOVaBWLgdJOmnB00X9iW7m7njVCP
        46TKD67yjY+8qjkJ+C9MOwUtOtkdRdTqEJIZq0sBCh43qVPzDOi/avgMV5xesipw
        7pK8wHl5w+qx+JOLi2uw0qAnhxZLqAgsfrYhJ3WKlRp1+mdTMMw7U66VXQIk1Xpt
        wGTsSz1FboAd+D2PyixJqenC9EzgwmQHRJHFhSes319oamQFkhJknxNKGFpMcQZ9
        I2Ap7nLyK74AwYZm7wNhzNWapLdKR7V+rrLkcQYKZrsyjTX0abAp4cGjWhu4RPpx
        lHKCPjK3AgMBAAECggEABMo/sNCIMREXA/EqjxDFecN4LmOTOK5A0YBiH9Cc01sd
        qSaavtSQqhqbjV+0bUNEA7UohXbc3s3bx3qa5VFhiIh8sBQMaQdyRkCK/MxMc16d
        BSx5XQ/8MjVO73A1zHgH2g47BWPjgRrDL94KrgNPOO0FoG76QxL9GlcOHzhFa1rf
        xbb2auLBtflKy+5TZNnB/sbFC9ISpWywzfblD2Fsvxupl0vNWtA0Y2rPbKMZRnY+
        V6NC38yxW3HHAdWQRYLGOitM59I0HBgnjQKzTBNIsjPnJA2BSZvMBtQ1e3RQV0qE
        8VVoktZ8A0KDUxqdKWYlGYAY5hIw1y3UUsPRUbS3fQKBgQDAZehu+Kb5Sw+h00Qu
        vViNHDvi0PwmhQrHVpgjrppCnWsTk6FJFm+EBLY+87usXuRCnfZ1semb6P+yjLh2
        bJ9IXIrFAztcyE+7eZfn0H7mHA7E2ICKTjNdKbjy8kHViHpgdXREnAOrFTTk/BqW
        dq+weG2OuxYczWsY4XliWaVyiwKBgQC8XYExpSmoyI37o+jr9405k30tbGUw4X+/
        xYOvSUuafI8IOSLfKTpsvkMN3hxpJO6apIRAjOALbotKUA5FrHQPenuBWOr3mBJT
        euLiaWphqU8YN5dbNd+JhC/Jh5DLhY5FpB2Fv2MKSoF7+onpjDy9pEU5aReeBB0v
        ekUw4nWiBQKBgHxyrnjxP1frFG5xMB4nfZqw04+v7BmiXsl3mqsh6kgCeNtN17pl
        17YGMjfgAdnJ+02XzW5tqRSfDp3YZgy7z//HVD+BCqnGK8SxLu/ULfD73xW2kNZl
        JNYzAZ2r06eiQr4X2x/x5nGIIxGmfDAtDxFPpFX5b6ErwgVy+sgCAoFnAoGAWSpu
        EMEdQk+FnnwNsz2g9YNSuyDXmdb08SOfXWd1yXBzCLJ7RmYuyPEbrsHYcxFPfZap
        ICFPoTm35/qTdvnWiskxE56yw3eSHUBLjF/YQtixn0YZeMy8v0z6jgyFR0I2gdLZ
        QsnBKUrxlm2XwR1oV2Eef7m2u085PZNEk4pvor0CgYA6n060r48/CgRVslAeGder
        fZ3n+2ru8q2UVB38evepjLifn5+tKdFzZ7/NckXMC0NOVzm74qG46VFLMw5TtyT4
        /hRvGSYxA6dMjXy+tcrAns9Isrz2PnYFntlbhU6hw0um809tFunbvITfyeOjAsDW
        stC4thnhzXXT1Y3RfFtYEg==
        -----END PRIVATE KEY-----
    encryption:
      key-id: encryption-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtU7Vu4tML8qg9BISaUH0
        BTU0+qkHJS3TUl3R0hEPttZJGf8EgT7bpWqRjdhMC2SYt2ifNF82EgMo/eva1rLn
        wYtCsxjJ7oB4U2m16/JKHtphmMUGhSLgbp+Y8pGAQ+P6u4HLlI0qbL92Syb6QCTr
        nYIlzZ2uUAvUQg/SbuAvdS4kdauZtpMNbhryusMVvILVBC5yUhfLJAkjbU3qWo/n
        2NKPr4kjwwFh6FaAf0HLsXCFmJbPPok6WMZeDqPORPZCt5gU2t04fS7s/2SSbhQ/
        i+7yyT4pl44cUlNLLN3Qo73sai5H90q7Dvmk3M5/YMJB0Ueyb705LHyOO5xA618s
        qQIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC1TtW7i0wvyqD0
        EhJpQfQFNTT6qQclLdNSXdHSEQ+21kkZ/wSBPtulapGN2EwLZJi3aJ80XzYSAyj9
        69rWsufBi0KzGMnugHhTabXr8koe2mGYxQaFIuBun5jykYBD4/q7gcuUjSpsv3ZL
        JvpAJOudgiXNna5QC9RCD9Ju4C91LiR1q5m2kw1uGvK6wxW8gtUELnJSF8skCSNt
        Tepaj+fY0o+viSPDAWHoVoB/QcuxcIWYls8+iTpYxl4Oo85E9kK3mBTa3Th9Luz/
        ZJJuFD+L7vLJPimXjhxSU0ss3dCjvexqLkf3SrsO+aTczn9gwkHRR7JvvTksfI47
        nEDrXyypAgMBAAECggEAREnJHrY8n9OGA+e6n4KD0mJT7gUz98Dm0yMbIC/k50yW
        hAAVRkjSmd8lq3NIURI2ov342NTznJ0sF1d6OVtxBujY2nP/uqEQsPoj1xaO7Ef8
        cnnjFsooFgJurQ44bVm02mLstqrky8jhWTT5FKfTRqP6cRNu0B9kdu1WqQQvW8a/
        C8xD8XUFzzJFQsEstJ076NjlZNH3EeqFiLxyVdV7tPEJRnOe2V2BAAgda3ByA6Jc
        Nd4xYHTVr5rZ+KES9gaAgb86+S7hNigsxz5Gp58NimLEyz1Qd+d9QCgPRgKOV5Uq
        0ci6c28ZrxW9wa/2CGCpoow1V7hRy1fZ24g2Tz91cQKBgQDbSdP/FQYuem0pUf8u
        mA/niEC8Jz30FW3ix5aqbQ8YRudK48Xy8F7AWnlS0wT2k/Xaeppn9YSPK4HlsNk2
        1gnpNfzdqXpJQtuxcPPeFNzUdXzBrsLXYqtlhOX/afrzqMhp73gkqoxXtqwD7BqN
        VfMcVXsWrEZQrRPBn/RUnnLdJwKBgQDTqUGupm93UlhoPgLXHGF/seQwPPHcU6lS
        SS9l512Ie21B+vZecgO4r77BXJwbY4rZVA5/m+wrsNmsT2f8yfdbs84cBDDWiKy5
        t2Um8zrus+BCIffxc9Fck9/htK33jLLcYwdSAm3a9pJxR9f/kAdredSTGBNJ3W/2
        rfh3cdNprwKBgDi7WfBFRSsjGzi0cPth9cNlubGzyVBrdtlT34PJ4Tzboxz53o1i
        aHEFNxwZYdBVKSbTzzyUBS5xCBMfdKK+LyQ5hmjmXq+zb1jxqvXKmfMRTixhhSDp
        8wO5pTM1/Omqwea+QGvj/5j1tnzxSVFFajbrWoPcH/jhPho6wqBducPDAoGBALOJ
        MEOavZXy7TaO0w3v7uvH0wzvxR/kfw1jMqc3l2j7ePOskmoOQAXaXO3bRjcdOlua
        Jyoq8islOZ4lRMlx7zWD0OKG035GNGzbmRtu2aA8R48RDSVr3jyu2gqznZULbXPv
        M/hmQxSmbhVUoW0PmJubnaqfk0zmXeBaNRXsIS3VAoGBALdsAtqR23PVeL6sYj2l
        dRNTDXpfvjFqJ5NThRO/4mT0CrPHQVj+Mz2bTc/Dxiwi8s8m3L+g23i3hodh/QMb
        Iz+UbcJZBGAKsFbPKGOtj6Bi07y/L11mcuNJzOWe61/JbVmJss0s+N/v3XucK/Ge
        CUaGOccsMO221v6JoBh9J3Hz
        -----END PRIVATE KEY-----</code></pre>
<h3>LDAP Schema (schema.ldif)</h3>
<pre><code class="language-ldif"># 1) Root DN
 dn: dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: domain
 objectClass: extensibleObject
 dc: suaybsimsek

# 2) People OU
 dn: ou=people,dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: organizationalUnit
 ou: people

# 3) Admin user
 dn: uid=admin,ou=people,dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: person
 objectClass: inetOrgPerson
 cn: Admin User
 sn: User
 uid: admin
 userPassword: $2a$10$sva6wl8pmGKJE6NIWrxwcuJK1Jaa2I/LOI43iHVpbR4YB8KjGViiK

# 4) Normal user
 dn: uid=user,ou=people,dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: person
 objectClass: inetOrgPerson
 cn: Normal User
 sn: User
 uid: user
 userPassword: $2a$10$5Py4PyteLuXEqnGpSigzfu0V55C7Hi7zX18lmh.J8Bpmft.h23voG

# 5) Groups OU
 dn: ou=groups,dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: organizationalUnit
 ou: groups

# 6) USER group ‚Üí maps to ROLE_USER
 dn: cn=USER,ou=groups,dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: groupOfUniqueNames
 cn: USER
 uniqueMember: uid=user,ou=people,dc=suaybsimsek,dc=com
 uniqueMember: uid=admin,ou=people,dc=suaybsimsek,dc=com

# 7) ADMIN group ‚Üí maps to ROLE_ADMIN
 dn: cn=ADMIN,ou=groups,dc=suaybsimsek,dc=com
 objectClass: top
 objectClass: groupOfUniqueNames
 cn: ADMIN
 uniqueMember: uid=admin,ou=people,dc=suaybsimsek,dc=com</code></pre>
<p>Bu yapƒ±landƒ±rma, tanƒ±mlƒ± ≈üema ile embedded bir LDAP sunucusunu ayaƒüa kaldƒ±rƒ±r ve JWE imzalama ile ≈üifreleme i√ßin RSA anahtarlarƒ±nƒ± y√ºkler. Artƒ±k Spring Security‚Äôyi LDAP kimlik doƒürulamasƒ± ve JWE tabanlƒ± token olu≈üturma i√ßin yapƒ±landƒ±rabilirsiniz.</p>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: G√ºvenlik Yapƒ±landƒ±rmasƒ±</h2>
<p>Bu b√∂l√ºmde, LDAP kimlik doƒürulamasƒ±nƒ± yapƒ±landƒ±rmak, RSA anahtarlarƒ±nƒ± ayarlamak ve JWE tabanlƒ± kimlik doƒürulama i√ßin HTTP g√ºvenlik filtrelerini uygulamak √ºzere gerekli bean‚Äôleri ve √∂zellikleri tanƒ±mlƒ±yoruz:</p>
<ul>
<li>JwtProperties: JWT encoder/decoder i√ßin imzalama ve ≈üifreleme anahtar √ßiftlerini, issuer bilgisini ve expire s√ºresini tanƒ±mlar.</li>
<li>SecurityJwtConfig: RSA JWK nesnelerini olu≈üturur, JWT encoder/decoder‚Äôƒ±, authentication converter ve token resolveri yapƒ±landƒ±rƒ±r.</li>
<li>SecurityConfig: Embedded LDAP kimlik doƒürulamasƒ±nƒ± tanƒ±mlar ve stateless bir g√ºvenlik filtresi zinciri kurarak ilgili URL‚Äôleri yetkilendirmeye tabi tutar.</li>
</ul>
<h3>SecurityJwtConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.config;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.JWKSet;
import com.nimbusds.jose.jwk.RSAKey;
import com.nimbusds.jose.jwk.source.JWKSource;
import com.nimbusds.jose.proc.JWEDecryptionKeySelector;
import com.nimbusds.jose.proc.JWSVerificationKeySelector;
import com.nimbusds.jose.proc.SecurityContext;
import com.nimbusds.jwt.proc.DefaultJWTProcessor;
import io.github.susimsek.springbootldapjwedemo.security.CookieBearerTokenResolver;
import io.github.susimsek.springbootldapjwedemo.security.KeyUtils;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.oauth2.jwt.JwtDecoder;
import org.springframework.security.oauth2.jwt.JwtEncoder;
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder;
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder;
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter;
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;

import java.util.List;

import static io.github.susimsek.springbootldapjwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Configuration
public class SecurityJwtConfig {

    private final JwtProperties props;
    public SecurityJwtConfig(JwtProperties props) { this.props = props; }

    @Bean
    public RSAKey signingKey() throws Exception {
        return KeyUtils.buildRsaKey(
            props.getSigning().getPublicKey(),
            props.getSigning().getPrivateKey(),
            props.getSigning().getKeyId(),
            true
        );
    }

    @Bean
    public RSAKey encryptionKey() throws Exception {
        return KeyUtils.buildRsaKey(
            props.getEncryption().getPublicKey(),
            props.getEncryption().getPrivateKey(),
            props.getEncryption().getKeyId(),
            false
        );
    }

    @Bean
    public JWKSource&lt;SecurityContext&gt; jwkSource(RSAKey signingKey, RSAKey encryptionKey) {
        JWKSet jwkSet = new JWKSet(List.of(
            signingKey,
            encryptionKey
        ));
        return (jwkSelector, context) -&gt; jwkSelector.select(jwkSet);
    }

    @Bean
    public JwtDecoder jwtDecoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
        DefaultJWTProcessor&lt;SecurityContext&gt; jwtProcessor = new DefaultJWTProcessor&lt;&gt;();
        JWEDecryptionKeySelector&lt;SecurityContext&gt; jweKeySelector =
            new JWEDecryptionKeySelector&lt;&gt;(
                JWEAlgorithm.RSA_OAEP_256,
                EncryptionMethod.A128GCM,
                jwkSource
            );
        jwtProcessor.setJWEKeySelector(jweKeySelector);

        JWSVerificationKeySelector&lt;SecurityContext&gt; jwsKeySelector =
            new JWSVerificationKeySelector&lt;&gt;(
                JWSAlgorithm.RS256,
                jwkSource
            );
        jwtProcessor.setJWSKeySelector(jwsKeySelector);
        jwtProcessor.setJWTClaimsSetVerifier((claims, context) -&gt; {});

        return new NimbusJwtDecoder(jwtProcessor);
    }

    @Bean
    public JwtEncoder jwtEncoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
        return new NimbusJwtEncoder(jwkSource);
    }

    @Bean
    public JwtAuthenticationConverter jwtAuthenticationConverter() {
        JwtGrantedAuthoritiesConverter converter = new JwtGrantedAuthoritiesConverter();
        converter.setAuthorityPrefix(&quot;&quot;);
        converter.setAuthoritiesClaimName(AUTHORITIES_KEY);

        JwtAuthenticationConverter authConverter = new JwtAuthenticationConverter();
        authConverter.setJwtGrantedAuthoritiesConverter(converter);
        return authConverter;
    }

    @Bean
    public BearerTokenResolver bearerTokenResolver() {
        CookieBearerTokenResolver resolver = new CookieBearerTokenResolver();
        resolver.setAllowUriQueryParameter(false);
        resolver.setAllowFormEncodedBodyParameter(false);
        resolver.setAllowCookie(true);
        return resolver;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.config

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.JWKSet
import com.nimbusds.jose.jwk.RSAKey
import com.nimbusds.jose.jwk.source.JWKSource
import com.nimbusds.jose.proc.JWEDecryptionKeySelector
import com.nimbusds.jose.proc.JWSVerificationKeySelector
import com.nimbusds.jose.proc.SecurityContext
import com.nimbusds.jwt.proc.DefaultJWTProcessor
import io.github.susimsek.springbootldapjwedemo.security.CookieBearerTokenResolver
import io.github.susimsek.springbootldapjwedemo.security.KeyUtils
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.oauth2.jwt.JwtDecoder
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver

@Configuration
class SecurityJwtConfig(private val props: JwtProperties) {

    @Bean
    @Throws(Exception::class)
    fun signingKey(): RSAKey =
        KeyUtils.buildRsaKey(
            props.signing.publicKey,
            props.signing.privateKey,
            props.signing.keyId,
            true
        )

    @Bean
    @Throws(Exception::class)
    fun encryptionKey(): RSAKey =
        KeyUtils.buildRsaKey(
            props.encryption.publicKey,
            props.encryption.privateKey,
            props.encryption.keyId,
            false
        )

    @Bean
    fun jwkSource(signingKey: RSAKey, encryptionKey: RSAKey): JWKSource&lt;SecurityContext&gt; {
        val jwkSet = JWKSet(listOf(signingKey, encryptionKey))
        return JWKSource { jwkSelector, context -&gt; jwkSelector.select(jwkSet) }
    }

    @Bean
    fun jwtDecoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtDecoder {
        val jwtProcessor = DefaultJWTProcessor&lt;SecurityContext&gt;()
        val jweKeySelector = JWEDecryptionKeySelector(
            JWEAlgorithm.RSA_OAEP_256,
            EncryptionMethod.A128GCM,
            jwkSource
        )
        jwtProcessor.jweKeySelector = jweKeySelector
        val jwsKeySelector = JWSVerificationKeySelector(
            JWSAlgorithm.RS256,
            jwkSource
        )
        jwtProcessor.jwsKeySelector = jwsKeySelector
        jwtProcessor.jwtClaimsSetVerifier = { _, _ -&gt; }
        return NimbusJwtDecoder(jwtProcessor)
    }

    @Bean
    fun jwtEncoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtEncoder =
        NimbusJwtEncoder(jwkSource)

    @Bean
    fun jwtAuthenticationConverter(): JwtAuthenticationConverter {
        val converter = JwtGrantedAuthoritiesConverter().apply {
            setAuthorityPrefix(&quot;&quot;)
            setAuthoritiesClaimName(AUTHORITIES_KEY)
        }
        return JwtAuthenticationConverter().apply {
            setJwtGrantedAuthoritiesConverter(converter)
        }
    }

    @Bean
    fun bearerTokenResolver(): BearerTokenResolver =
        CookieBearerTokenResolver().apply {
            setAllowUriQueryParameter(false)
            setAllowFormEncodedBodyParameter(false)
            setAllowCookie(true)
        }
}</code></pre>
<h3>SecurityConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.config;

import io.github.susimsek.springbootldapjwedemo.security.AuthoritiesConstants;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.ldap.core.support.BaseLdapPathContextSource;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.config.ldap.LdapPasswordComparisonAuthenticationManagerFactory;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator;
import org.springframework.security.ldap.userdetails.LdapAuthoritiesPopulator;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher;
import org.springframework.web.servlet.handler.HandlerMappingIntrospector;

import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
@EnableMethodSecurity(securedEnabled = true)
public class SecurityConfig {

  @Bean
  public SecurityFilterChain securityFilterChain(HttpSecurity http,
                                                 MvcRequestMatcher.Builder mvc) throws Exception {
    http
      .cors(withDefaults())
      .csrf(AbstractHttpConfigurer::disable)
      .authorizeHttpRequests(authz -&gt;
        authz
          .requestMatchers(
            mvc.pattern(&quot;/webjars/**&quot;),
            mvc.pattern(&quot;/css/**&quot;),
            mvc.pattern(&quot;/js/**&quot;)
          ).permitAll()
          .requestMatchers(
            mvc.pattern(&quot;/*.ico&quot;),
            mvc.pattern(&quot;/*.png&quot;),
            mvc.pattern(&quot;/*.svg&quot;),
            mvc.pattern(&quot;/*.webapp&quot;)
          ).permitAll()
          .requestMatchers(&quot;/actuator/**&quot;).permitAll()
          .requestMatchers(
            &quot;/v3/api-docs/**&quot;,
            &quot;/swagger-ui.html&quot;,
            &quot;/swagger-ui/**&quot;
          ).permitAll()
          .requestMatchers(mvc.pattern(&quot;/api/auth/login&quot;)).permitAll()
          .requestMatchers(mvc.pattern(&quot;/api/hello/admin&quot;))
          .hasAuthority(AuthoritiesConstants.ADMIN)
          .anyRequest().authenticated()
      )
      .sessionManagement(session -&gt;
        session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
      .oauth2ResourceServer(oauth2 -&gt; oauth2
        .jwt(withDefaults())
      );
    return http.build();
  }

  @Bean
  public PasswordEncoder passwordEncoder() {
    return new BCryptPasswordEncoder();
  }

  @Bean
  public LdapAuthoritiesPopulator authorities(BaseLdapPathContextSource contextSource) {
    DefaultLdapAuthoritiesPopulator populator =
      new DefaultLdapAuthoritiesPopulator(contextSource, &quot;ou=groups&quot;);
    populator.setGroupSearchFilter(&quot;uniqueMember={0}&quot;);
    populator.setGroupRoleAttribute(&quot;cn&quot;);
    populator.setRolePrefix(&quot;ROLE_&quot;);
    return populator;
  }

  @Bean
  public AuthenticationManager authenticationManager(
    BaseLdapPathContextSource contextSource,
    PasswordEncoder passwordEncoder,
    LdapAuthoritiesPopulator authorities
  ) {
    LdapPasswordComparisonAuthenticationManagerFactory factory =
      new LdapPasswordComparisonAuthenticationManagerFactory(contextSource, passwordEncoder);
    factory.setUserDnPatterns(&quot;uid={0},ou=people&quot;);
    factory.setPasswordAttribute(&quot;userPassword&quot;);
    factory.setLdapAuthoritiesPopulator(authorities);
    return factory.createAuthenticationManager();
  }

  @Bean
  public MvcRequestMatcher.Builder mvc(HandlerMappingIntrospector introspector) {
    return new MvcRequestMatcher.Builder(introspector);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.config

import io.github.susimsek.springbootldapjwedemo.security.AuthoritiesConstants
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.ldap.core.support.BaseLdapPathContextSource
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer
import org.springframework.security.config.http.SessionCreationPolicy
import org.springframework.security.config.ldap.LdapPasswordComparisonAuthenticationManagerFactory
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder
import org.springframework.security.crypto.password.PasswordEncoder
import org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator
import org.springframework.security.ldap.userdetails.LdapAuthoritiesPopulator
import org.springframework.security.web.SecurityFilterChain
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher
import org.springframework.web.servlet.handler.HandlerMappingIntrospector
import org.springframework.security.config.Customizer.withDefaults

@Configuration
@EnableMethodSecurity(securedEnabled = true)
class SecurityConfig {

  @Bean
  fun securityFilterChain(
    http: HttpSecurity,
    mvc: MvcRequestMatcher.Builder
  ): SecurityFilterChain = http
    .cors(withDefaults())
    .csrf { it.disable() }
    .authorizeHttpRequests { authz -&gt;
      authz
        .requestMatchers(
          mvc.pattern(&quot;/webjars/**&quot;),
          mvc.pattern(&quot;/css/**&quot;),
          mvc.pattern(&quot;/js/**&quot;)
        ).permitAll()
        .requestMatchers(
          mvc.pattern(&quot;/*.ico&quot;),
          mvc.pattern(&quot;/*.png&quot;),
          mvc.pattern(&quot;/*.svg&quot;),
          mvc.pattern(&quot;/*.webapp&quot;)
        ).permitAll()
        .requestMatchers(&quot;/actuator/**&quot;).permitAll()
        .requestMatchers(&quot;/v3/api-docs/**&quot;, &quot;/swagger-ui.html&quot;, &quot;/swagger-ui/**&quot;)
        .permitAll()
        .requestMatchers(mvc.pattern(&quot;/api/auth/login&quot;)).permitAll()
        .requestMatchers(mvc.pattern(&quot;/api/hello/admin&quot;))
        .hasAuthority(AuthoritiesConstants.ADMIN)
        .anyRequest().authenticated()
    }
    .sessionManagement { it.sessionCreationPolicy(SessionCreationPolicy.STATELESS) }
    .oauth2ResourceServer { it.jwt(withDefaults()) }
    .build()

  @Bean
  fun passwordEncoder(): PasswordEncoder = BCryptPasswordEncoder()

  @Bean
  fun authorities(contextSource: BaseLdapPathContextSource): LdapAuthoritiesPopulator {
    return DefaultLdapAuthoritiesPopulator(contextSource, &quot;ou=groups&quot;).apply {
      setGroupSearchFilter(&quot;uniqueMember={0}&quot;)
      setGroupRoleAttribute(&quot;cn&quot;)
      setRolePrefix(&quot;ROLE_&quot;)
    }
  }

  @Bean
  fun authenticationManager(
    contextSource: BaseLdapPathContextSource,
    passwordEncoder: PasswordEncoder,
    authorities: LdapAuthoritiesPopulator
  ): AuthenticationManager {
    return LdapPasswordComparisonAuthenticationManagerFactory(contextSource, passwordEncoder).apply {
      setUserDnPatterns(&quot;uid={0},ou=people&quot;)
      setPasswordAttribute(&quot;userPassword&quot;)
      setLdapAuthoritiesPopulator(authorities)
    }.createAuthenticationManager()
  }

  @Bean
  fun mvc(introspector: HandlerMappingIntrospector): MvcRequestMatcher.Builder =
    MvcRequestMatcher.Builder(introspector)
}</code></pre>
<h3>JwtProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

import java.time.Duration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
@Data
public class JwtProperties {

    @Data
    public static class Pair {
        private String publicKey;
        private String privateKey;
        private String keyId;
    }

    private Pair signing;
    private Pair encryption;
    private String issuer;
    private Duration expirationDuration;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration
import java.time.Duration

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
class JwtProperties {

  class Pair {
    lateinit var publicKey: String
    lateinit var privateKey: String
    lateinit var keyId: String
  }

  lateinit var signing: Pair
  lateinit var encryption: Pair
  lateinit var issuer: String
  lateinit var expirationDuration: Duration
}</code></pre>
<h3>UserProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.user&quot;)
@Data
public class UserProperties {
    private String username;
    private String password;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration

@Configuration
@ConfigurationProperties(prefix = &quot;security.user&quot;)
class UserProperties {
  lateinit var username: String
  lateinit var password: String
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: G√ºvenli JWE Token Yardƒ±mcƒ± Sƒ±nƒ±flarƒ± Olu≈üturun</h2>
<p>Bu b√∂l√ºmde, Spring Boot uygulamanƒ±zda JSON Web Encryption (JWE) tokenlarƒ± olu≈üturmak, ≈üifrelemek ve √ß√∂zmek i√ßin gereken temel yardƒ±mcƒ± sƒ±nƒ±flarƒ± ve sabitleri tanƒ±mlƒ±yoruz. Bu bile≈üenler ≈üunlarƒ± saƒülar:</p>
<ul>
<li>AuthoritiesConstants: `ROLE_` √∂n ekiyle rol isimlerini merkezile≈ütirir.</li>
<li>CookieBearerTokenResolver: Bearer token‚Äôlarƒ± yetkilendirme ba≈ülƒ±klarƒ±ndan veya HTTP √ßerezlerinden √ß√∂zer.</li>
<li>CookieUtils: Eri≈üim token‚Äôlarƒ± i√ßin HTTP-only ve secure √ßerezler olu≈üturur.</li>
<li>JweUtil: Nimbus k√ºt√ºphanesi ile RSA anahtarlarƒ± kullanarak JWT‚Äôleri imzalar (JWS) ve ≈üifreler (JWE).</li>
<li>KeyUtils: PEM formatƒ±ndaki anahtar √ßiftinden RSA JWK‚Äôleri olu≈üturur.</li>
<li>SecurityUtils: SecurityContext oturum a√ßan kullanƒ±cƒ±nƒ±n bilgisini sunar.</li>
</ul>
<p>Bu yardƒ±mcƒ±lar, Spring Security ile durumsuz (stateless) JWE tabanlƒ± bir kimlik doƒürulama akƒ±≈üƒ±nƒ±n temelini olu≈üturur.</p>
<h3>AuthoritiesConstants</h3>
<h3>Java</h3>
<pre><code class="language-java">
package io.github.susimsek.springbootldapjwedemo.security;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class AuthoritiesConstants {
    public static final String ADMIN = &quot;ROLE_ADMIN&quot;;
    public static final String USER = &quot;ROLE_USER&quot;;
    public static final String ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">
package io.github.susimsek.springbootldapjwedemo.security

object AuthoritiesConstants {
  const val ADMIN = &quot;ROLE_ADMIN&quot;
  const val USER = &quot;ROLE_USER&quot;
  const val ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;
}</code></pre>
<h3>CookieBearerTokenResolver</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.security;

import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletRequest;
import lombok.Setter;
import org.springframework.http.HttpMethod;
import org.springframework.security.oauth2.core.OAuth2AuthenticationException;
import org.springframework.security.oauth2.server.resource.BearerTokenError;
import org.springframework.security.oauth2.server.resource.BearerTokenErrors;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;
import org.springframework.util.StringUtils;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

@Setter
public class CookieBearerTokenResolver implements BearerTokenResolver {
    private static final String ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;;
    private static final Pattern AUTHORIZATION_PATTERN =
        Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE);

    private boolean allowFormEncodedBodyParameter = false;
    private boolean allowUriQueryParameter       = false;
    private boolean allowCookie                  = true;
    private String  bearerTokenHeaderName       = &quot;Authorization&quot;;
    private String  cookieName                  = &quot;accessToken&quot;;

    @Override
    public String resolve(HttpServletRequest request) {
        String headerToken = resolveFromAuthorizationHeader(request);
        String queryToken  = resolveAccessTokenFromQueryString(request);
        String bodyToken   = resolveAccessTokenFromBody(request);
        String cookieToken = (headerToken == null &amp;&amp; queryToken == null &amp;&amp; bodyToken == null)
            ? resolveFromCookie(request)
            : null;

        return resolveToken(headerToken, queryToken, bodyToken, cookieToken);
    }

    private String resolveFromAuthorizationHeader(HttpServletRequest request) {
        String authorization = request.getHeader(this.bearerTokenHeaderName);
        if (!StringUtils.hasText(authorization) || !authorization.toLowerCase().startsWith(&quot;bearer&quot;)) {
            return null;
        }
        Matcher matcher = AUTHORIZATION_PATTERN.matcher(authorization.trim());
        if (!matcher.matches()) {
            BearerTokenError error = BearerTokenErrors.invalidToken(&quot;Bearer token is malformed&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return matcher.group(&quot;token&quot;);
    }

    private String resolveAccessTokenFromQueryString(HttpServletRequest request) {
        if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.getMethod())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveAccessTokenFromBody(HttpServletRequest request) {
        if (allowFormEncodedBodyParameter
            &amp;&amp; HttpMethod.POST.matches(request.getMethod())
            &amp;&amp; &quot;application/x-www-form-urlencoded&quot;.equals(request.getContentType())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveFromCookie(HttpServletRequest request) {
        if (!allowCookie || request.getCookies() == null) {
            return null;
        }
        for (Cookie cookie : request.getCookies()) {
            if (cookieName.equals(cookie.getName())) {
                String val = cookie.getValue();
                return StringUtils.hasText(val) ? val : null;
            }
        }
        return null;
    }

    private String resolveToken(String... tokens) {
        String found = null;
        for (String token : tokens) {
            if (token == null) continue;
            if (found != null) {
                BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens in the request&quot;);
                throw new OAuth2AuthenticationException(error);
            }
            found = token;
        }
        if (found != null &amp;&amp; found.isBlank()) {
            BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;The requested token parameter is an empty string&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return found;
    }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.security

import jakarta.servlet.http.Cookie
import jakarta.servlet.http.HttpServletRequest
import org.springframework.http.HttpMethod
import org.springframework.security.oauth2.core.OAuth2AuthenticationException
import org.springframework.security.oauth2.server.resource.BearerTokenError
import org.springframework.security.oauth2.server.resource.BearerTokenErrors
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver
import org.springframework.util.StringUtils
import java.util.regex.Pattern

class CookieBearerTokenResolver {
    var allowFormEncodedBodyParameter: Boolean = false
    var allowUriQueryParameter: Boolean = false
    var allowCookie: Boolean = true
    var bearerTokenHeaderName: String = &quot;Authorization&quot;
    var cookieName: String = &quot;accessToken&quot;

    companion object {
        private const val ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;
        private val AUTHORIZATION_PATTERN =
            Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE)
    }

    fun resolve(request: HttpServletRequest): String? {
        val header = resolveFromAuthorizationHeader(request)
        val query  = if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.method))
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val body   = if (allowFormEncodedBodyParameter &amp;&amp; HttpMethod.POST.matches(request.method)
            &amp;&amp; request.contentType == &quot;application/x-www-form-urlencoded&quot;)
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val cookie = if (header == null &amp;&amp; query == null &amp;&amp; body == null)
            resolveFromCookie(request)
        else null
        return listOf(header, query, body, cookie).filterNotNull().let {
            if (it.size &gt; 1) throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens&quot;))
            it.firstOrNull()?: null
        }
    }

    private fun resolveFromAuthorizationHeader(request: HttpServletRequest): String? {
        val auth = request.getHeader(bearerTokenHeaderName) ?: return null
        if (!auth.startsWith(&quot;Bearer &quot;, true)) return null
        val matcher = AUTHORIZATION_PATTERN.matcher(auth.trim())
        return if (matcher.matches()) matcher.group(&quot;token&quot;)
        else throw OAuth2AuthenticationException(BearerTokenErrors.invalidToken(&quot;Malformed token&quot;))
    }

    private fun resolveFromCookie(request: HttpServletRequest): String? {
        if (!allowCookie) return null
        return request.cookies?.firstOrNull { it.name == cookieName }?.value?.takeIf { it.isNotBlank() }
    }

    private fun resolveToken(tokens: Array&lt;String&gt;): String? {
        return tokens.filter { it.isNotBlank() }.let {
            when {
                it.isEmpty() -&gt; null
                it.size &gt; 1   -&gt; throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Multiple tokens&quot;))
                else          -&gt; it[0]
            }
        }
    }</code></pre>
<h3>CookieUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.security;

import io.github.susimsek.springbootldapjwedemo.dto.TokenDTO;
import lombok.experimental.UtilityClass;
import org.springframework.http.ResponseCookie;

@UtilityClass
public class CookieUtils {

    private static final String COOKIE_NAME = &quot;accessToken&quot;;

    public ResponseCookie createAccessTokenCookie(TokenDTO tokenDto) {
        return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
            .httpOnly(true)
            .secure(true)
            .path(&quot;/&quot;)
            .maxAge(tokenDto.accessTokenExpiresIn())
            .sameSite(&quot;Strict&quot;)
            .build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.security

import io.github.susimsek.springbootldapjwedemo.dto.TokenDTO
import org.springframework.http.ResponseCookie

object CookieUtils {

  private const val COOKIE_NAME = &quot;accessToken&quot;

  fun createAccessTokenCookie(tokenDto: TokenDTO): ResponseCookie {
    return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(tokenDto.accessTokenExpiresIn())
      .sameSite(&quot;Strict&quot;)
      .build()
  }
}</code></pre>
<h3>JweUtil</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.security;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JOSEException;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWEHeader;
import com.nimbusds.jose.JWEObject;
import com.nimbusds.jose.Payload;
import com.nimbusds.jose.crypto.RSAEncrypter;
import com.nimbusds.jose.jwk.RSAKey;
import io.github.susimsek.springbootldapjwedemo.config.JwtProperties;
import io.github.susimsek.springbootldapjwedemo.dto.TokenDTO;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm;
import org.springframework.security.oauth2.jwt.*;
import org.springframework.stereotype.Component;

import java.time.Instant;
import java.util.List;

import static io.github.susimsek.springbootldapjwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Component
@RequiredArgsConstructor
public class JweUtil {

    private final JwtEncoder jwtEncoder;
    private final RSAKey signingKey;
    private final RSAKey encryptionKey;
    private final JwtProperties props;

    public TokenDTO generateToken(Authentication authentication) throws JOSEException {
        String subject = authentication.getName();
        List&lt;String&gt; roles = authentication.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority)
            .toList();

        Instant now = Instant.now();
        long expiresIn = props.getExpirationDuration().getSeconds();
        Instant exp = now.plusSeconds(expiresIn);

        JwtClaimsSet claims = JwtClaimsSet.builder()
            .issuer(props.getIssuer())
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build();

        JwsHeader jwsHeader = JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.getKeyID())
            .build();

        String jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .getTokenValue();

        JWEHeader jweHeader = new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.getKeyID())
            .build();

        JWEObject jweObject = new JWEObject(jweHeader, new Payload(jws));
        jweObject.encrypt(new RSAEncrypter(encryptionKey.toRSAPublicKey()));
        String token = jweObject.serialize();

        return new TokenDTO(token, &quot;Bearer&quot;, expiresIn);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.security

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JOSEException
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWEHeader
import com.nimbusds.jose.JWEObject
import com.nimbusds.jose.Payload
import com.nimbusds.jose.crypto.RSAEncrypter
import com.nimbusds.jose.jwk.RSAKey
import io.github.susimsek.springbootldapjwedemo.config.JwtProperties
import io.github.susimsek.springbootldapjwedemo.dto.TokenDTO
import lombok.RequiredArgsConstructor
import org.springframework.security.core.Authentication
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm
import org.springframework.security.oauth2.jwt.JwtClaimsSet
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.JwtEncoderParameters
import org.springframework.stereotype.Component

import java.time.Instant

@Component
@RequiredArgsConstructor
class JweUtil(
    private val jwtEncoder: JwtEncoder,
    private val signingKey: RSAKey,
    private val encryptionKey: RSAKey,
    private val props: JwtProperties
) {
    fun generateToken(authentication: Authentication): TokenDTO {
        val subject = authentication.name
        val roles = authentication.authorities.map { it.authority }

        val now = Instant.now()
        val expiresIn = props.expirationDuration.seconds
        val exp = now.plusSeconds(expiresIn)

        val claims = JwtClaimsSet.builder()
            .issuer(props.issuer)
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build()

        val jwsHeader = org.springframework.security.oauth2.jwt.JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.keyID)
            .build()

        val jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .tokenValue

        val jweHeader = JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.keyID)
            .build()

        val jweObject = JWEObject(jweHeader, Payload(jws))
        jweObject.encrypt(RSAEncrypter(encryptionKey.toRSAPublicKey()))
        val token = jweObject.serialize()

        return TokenDTO(token, &quot;Bearer&quot;, expiresIn)
    }
}</code></pre>
<h3>KeyUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.security;

import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.KeyUse;
import com.nimbusds.jose.jwk.RSAKey;
import lombok.experimental.UtilityClass;

import java.security.KeyFactory;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.util.Base64;

@UtilityClass
public class KeyUtils {
    public RSAKey buildRsaKey(
            String pubPem,
            String privPem,
            String kid,
            boolean forSign
    ) throws Exception {
        String pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);
        String privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);

        byte[] decodedPub = Base64.getDecoder().decode(pubContent);
        byte[] decodedPriv = Base64.getDecoder().decode(privContent);

        KeyFactory kf = KeyFactory.getInstance(&quot;RSA&quot;);
        RSAPublicKey publicKey = (RSAPublicKey) kf.generatePublic(new X509EncodedKeySpec(decodedPub));
        RSAPrivateKey privateKey = (RSAPrivateKey) kf.generatePrivate(new PKCS8EncodedKeySpec(decodedPriv));

        RSAKey.Builder builder = new RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid);

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE);
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION);
        }

        return builder.build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.security

import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.KeyUse
import com.nimbusds.jose.jwk.RSAKey
import java.security.KeyFactory
import java.security.interfaces.RSAPrivateKey
import java.security.interfaces.RSAPublicKey
import java.security.spec.PKCS8EncodedKeySpec
import java.security.spec.X509EncodedKeySpec
import java.util.Base64

object KeyUtils {
    @JvmStatic
    @Throws(Exception::class)
    fun buildRsaKey(
        pubPem: String,
        privPem: String,
        kid: String,
        forSign: Boolean
    ): RSAKey {
        val pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)
        val privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)

        val decodedPub = Base64.getDecoder().decode(pubContent)
        val decodedPriv = Base64.getDecoder().decode(privContent)

        val kf = KeyFactory.getInstance(&quot;RSA&quot;)
        val publicKey = kf.generatePublic(X509EncodedKeySpec(decodedPub)) as RSAPublicKey
        val privateKey = kf.generatePrivate(PKCS8EncodedKeySpec(decodedPriv)) as RSAPrivateKey

        val builder = RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid)

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE)
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION)
        }

        return builder.build()
    }
}</code></pre>
<h3>SecurityUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.security;

import lombok.experimental.UtilityClass;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.oauth2.jwt.Jwt;

import java.util.Optional;

@UtilityClass
public class SecurityUtils {

    public static final String AUTHORITIES_KEY = &quot;auth&quot;;

    public Optional&lt;String&gt; getCurrentUserLogin() {
        var ctx = SecurityContextHolder.getContext();
        return Optional.ofNullable(extractPrincipal(ctx.getAuthentication()));
    }

    private String extractPrincipal(Authentication authentication) {
        if (authentication == null) {
            return null;
        }
        Object principal = authentication.getPrincipal();
        if (principal instanceof Jwt jwt) {
            return jwt.getSubject();
        }
        if (principal instanceof UserDetails ud) {
            return ud.getUsername();
        }
        if (principal instanceof String username) {
            return username;
        }
        return null;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.security

import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.security.core.userdetails.UserDetails
import org.springframework.security.oauth2.jwt.Jwt
import java.util.Optional

object SecurityUtils {
  const val AUTHORITIES_KEY = &quot;auth&quot;

  fun getCurrentUserLogin(): Optional&lt;String&gt; {
    val authentication: Authentication? = SecurityContextHolder.getContext().authentication
    return Optional.ofNullable(extractPrincipal(authentication))
  }

  private fun extractPrincipal(authentication: Authentication?): String? {
    return when (val principal = authentication?.principal) {
      is Jwt -&gt; principal.subject
      is UserDetails -&gt; principal.username
      is String -&gt; principal
      else -&gt; null
    }
  }
}</code></pre>
<hr />
<h1>üîê Adƒ±m 5: Kimlik Doƒürulama ve G√ºvenli Endpointler</h1>
<p>Bu b√∂l√ºmde, a≈üaƒüƒ±dakileri ger√ßekle≈ütirmek i√ßin gerekli REST controller ve DTO‚Äôlarƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>AuthController: Kullanƒ±cƒ±larƒ± doƒürular, JWE token‚Äôlarƒ± olu≈üturur ve g√ºvenli cookie ayarlar.</li>
<li>HelloController: Kimliƒüi doƒürulanmƒ±≈ü kullanƒ±cƒ±lar ve yalnƒ±zca admine √∂zel pathler i√ßin g√ºvenli endpointler sunar.</li>
<li>LoginRequestDTO: Login isteƒüi payloadƒ±nƒ± (kullanƒ±cƒ± adƒ±/parola) modelleyen DTO.</li>
<li>TokenDTO: Token ve ge√ßerlilik s√ºresini i√ßeren kimlik doƒürulama yanƒ±tƒ±nƒ± modelleyen DTO.</li>
</ul>
<p>Bu bile≈üenler, login i≈ülemi, token olu≈üturma, cookie y√∂netimi ve kaynak korumasƒ±nƒ± i≈üleyerek stateless(durumsuz) kimlik doƒürulama akƒ±≈üƒ±nƒ± tamamlar.</p>
<p>Bu b√∂l√ºmde, kullanƒ±cƒ± kimlik doƒürulamasƒ±nƒ±, token olu≈üturmayƒ± ve korunan kaynak eri≈üimini y√∂netmek i√ßin REST controller ve DTO‚Äôlarƒ± olu≈üturuyoruz.</p>
<h3>AuthController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.controller;

import io.github.susimsek.springbootldapjwedemo.dto.LoginRequestDTO;
import io.github.susimsek.springbootldapjwedemo.dto.TokenDTO;
import io.github.susimsek.springbootldapjwedemo.security.CookieUtils;
import io.github.susimsek.springbootldapjwedemo.security.JweUtil;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseCookie;
import org.springframework.http.ResponseEntity;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequiredArgsConstructor
@RequestMapping(&quot;/api/auth&quot;)
public class AuthController {

    private final AuthenticationManager authenticationManager;
    private final JweUtil jweUtil;

    @PostMapping(&quot;/login&quot;)
    public ResponseEntity&lt;TokenDTO&gt; login(@RequestBody LoginRequestDTO loginRequest) throws Exception {
        // Authenticate user
        var authToken = new UsernamePasswordAuthenticationToken(
            loginRequest.username(), loginRequest.password()
        );
        Authentication auth = authenticationManager.authenticate(authToken);
        SecurityContextHolder.getContext().setAuthentication(auth);

        // Generate JWE token and cookie
        TokenDTO tokenDto = jweUtil.generateToken(auth);
        ResponseCookie cookie = CookieUtils.createAccessTokenCookie(tokenDto);

        return ResponseEntity.ok()
            .header(HttpHeaders.SET_COOKIE, cookie.toString())
            .body(tokenDto);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.controller

import io.github.susimsek.springbootldapjwedemo.dto.LoginRequestDTO
import io.github.susimsek.springbootldapjwedemo.dto.TokenDTO
import io.github.susimsek.springbootldapjwedemo.security.CookieUtils
import io.github.susimsek.springbootldapjwedemo.security.JweUtil
import lombok.RequiredArgsConstructor
import org.springframework.http.HttpHeaders
import org.springframework.http.ResponseCookie
import org.springframework.http.ResponseEntity
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken
import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.web.bind.annotation.PostMapping
import org.springframework.web.bind.annotation.RequestBody
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequiredArgsConstructor
@RequestMapping(&quot;/api/auth&quot;)
class AuthController(
    private val authenticationManager: AuthenticationManager,
    private val jweUtil: JweUtil
) {

    @PostMapping(&quot;/login&quot;)
    fun login(@RequestBody loginRequest: LoginRequestDTO): ResponseEntity&lt;TokenDTO&gt; {
        val authToken = UsernamePasswordAuthenticationToken(
            loginRequest.username, loginRequest.password
        )
        val auth: Authentication = authenticationManager.authenticate(authToken)
        SecurityContextHolder.getContext().authentication = auth

        val tokenDto: TokenDTO = jweUtil.generateToken(auth)
        val cookie: ResponseCookie = CookieUtils.createAccessTokenCookie(tokenDto)

        return ResponseEntity.ok()
            .header(HttpHeaders.SET_COOKIE, cookie.toString())
            .body(tokenDto)
    }
}</code></pre>
<h3>HelloController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.controller;

import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.oauth2.jwt.Jwt;
import org.springframework.web.bind.annotation.*;

import static io.github.susimsek.springbootldapjwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@RestController
@RequestMapping(&quot;/api/hello&quot;)
public class HelloController {

    @GetMapping
    public String helloAll(@AuthenticationPrincipal Jwt jwt) {
        String user = jwt.getSubject();
        var roles = jwt.getClaimAsStringList(AUTHORITIES_KEY);
        return &quot;Hello, &quot; + user + &quot;! Your roles: &quot; + roles;
    }

    @GetMapping(&quot;/admin&quot;)
    public String helloAdmin(@AuthenticationPrincipal Jwt jwt) {
        return &quot;Hello Admin, &quot; + jwt.getSubject() + &quot;!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.controller

import org.springframework.security.core.annotation.AuthenticationPrincipal
import org.springframework.security.oauth2.jwt.Jwt
import org.springframework.web.bind.annotation.*

import io.github.susimsek.springbootldapjwedemo.security.SecurityUtils.AUTHORITIES_KEY

@RestController
@RequestMapping(&quot;/api/hello&quot;)
class HelloController {

    @GetMapping
    fun helloAll(@AuthenticationPrincipal jwt: Jwt): String {
        val user = jwt.subject
        val roles = jwt.getClaimAsStringList(AUTHORITIES_KEY)
        return &quot;Hello, \$user! Your roles: \$roles&quot;
    }

    @GetMapping(&quot;/admin&quot;)
    fun helloAdmin(@AuthenticationPrincipal jwt: Jwt): String {
        return &quot;Hello Admin, \${jwt.subject}!&quot;
    }
}</code></pre>
<h3>LoginRequestDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.dto;

public record LoginRequestDTO(
    String username,
    String password
) { }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.dto

data class LoginRequestDTO(
    val username: String,
    val password: String
)</code></pre>
<h3>TokenDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootldapjwedemo.dto;

public record TokenDTO(
    String accessToken,
    String tokenType,
    long accessTokenExpiresIn
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootldapjwedemo.dto

import kotlin.Long

data class TokenDTO(
    val accessToken: String,
    val tokenType: String,
    val accessTokenExpiresIn: Long
)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±r</h2>
<pre><code class="language-bash">./mvnw spring-boot:run
# or
gradle bootRun</code></pre>
<hr />
<h2>üß™ Endpoint Testi</h2>
<h3>Admin Akƒ±≈üƒ±</h3>
<p>admin olarak giri≈ü yapƒ±n ve `Set-Cookie` ba≈ülƒ±ƒüƒ±ndan JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/api/auth/login \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;adminpass&quot;}&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
<li>Yanƒ±t:</li>
</ul>
<pre><code class="language-json">{
  &quot;accessToken&quot;: &quot;&lt;jwe-token&gt;&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;accessTokenExpiresIn&quot;: 3600
}</code></pre>
<p>cookie kullanarak `hello` endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Veya Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>admin-√∂zel endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello/admin</code></pre>
<h3>Kullanƒ±cƒ± Akƒ±≈üƒ±</h3>
<p>user olarak giri≈ü yapƒ±n ve cookie‚Äôden JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/api/auth/login \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;username&quot;:&quot;user&quot;,&quot;password&quot;:&quot;userpass&quot;}&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
</ul>
<p>cookie kullanarak `hello` endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Admin endpointini deneyince (403 Forbidden d√∂ner):</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello/admin
# HTTP/1.1 403 Forbidden</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot LDAP ve JWE Kimlik Doƒürulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[G√ºvenlik]]></category>
      <category><![CDATA[JWT]]></category>
      <category><![CDATA[JWE]]></category>
      <category><![CDATA[LDAP]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-ldap-jwe-auth-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot JWE Kimlik Doƒürulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-jwe-authentication</link>
      <description><![CDATA[JWT‚Äôlerinizi JWE ile ≈üifreleyerek gizlilik ve b√ºt√ºnl√ºƒü√º saƒülamak i√ßin Spring Boot API‚Äôlerinizi nasƒ±l g√ºvence altƒ±na alacaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Sat, 03 May 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-jwe-authentication</guid>
      <content:encoded><![CDATA[<p>Spring Boot, mikroservislerinizdeki JWT‚Äôlerin b√ºt√ºnl√ºƒü√ºn√º ve gizliliƒüini korumak i√ßin JWS imzalama ile JWE ≈üifrelemeyi bir arada kullanmanƒ±za olanak tanƒ±r.</p>
<hr />
<h2>üåü Neden JWE Kimlik Doƒürulama Kullanmalƒ±?</h2>
<ul>
<li>B√ºt√ºnl√ºk: Token‚Äôlarƒ±n imzalanmasƒ±nƒ± (JWS) saƒülayarak tahrifatƒ± √∂nler.</li>
<li>Gizlilik: Hassas token alanlarƒ±nƒ± yalnƒ±zca √∂zel anahtara sahip olanlarƒ±n okuyabileceƒüi ≈üekilde ≈üifreler (JWE).</li>
<li>Standartlara Dayalƒ±: JOSE (JWS, JWE) spesifikasyonlarƒ±na uygundur.</li>
<li>Spring Desteƒüi: Spring Security‚Äônin OAuth2 Resource Server √∂zelliƒüi, JWE+JWS i≈ü akƒ±≈üƒ±nƒ± sorunsuzca y√∂netir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>‚òï Java Development Kit (JDK) 17 veya √ºzeri</li>
<li>üì¶ Spring Boot 3.2+</li>
<li>üî§ IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekle</h2>
<p>Bu satƒ±rlarƒ± `pom.xml` veya `build.gradle` dosyanƒ±za ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
  &lt;artifactId&gt;spring-security-oauth2-resource-server&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
  &lt;artifactId&gt;lombok&lt;/artifactId&gt;
  &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
implementation &#39;org.springframework.security:spring-security-oauth2-resource-server&#39;
compileOnly &#39;org.projectlombok:lombok&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Anahtar Yapƒ±landƒ±rmasƒ±</h2>
<p>RSA anahtarlarƒ±nƒ± ve kullanƒ±cƒ± kimlik bilgilerini `application.yml` dosyasƒ±nda tanƒ±mlayƒ±n:</p>
<pre><code class="language-yaml">security:
  admin:
    username: admin
    password: adminpass
  user:
    username: user
    password: userpass
  jwt:
    issuer: demo-issuer
    expiration-duration: 3600s
    signing:
      key-id: signing-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjZEcz5itWkDGOSqZdB5P
        JE0ccOCckskp0hN3kQbT1qnv+9/k66jlWgVi4HSTppwdNF/Ylu5u541Qj+Okyg+u
        8o2PvKo5CfgvTDsFLTrZHUXU6hCSGatLAQoeN6lT8wzov2r4DFecXrIqcO6SvMB5
        ecPqsfiTi4trsNKgJ4cWS6gILH62ISd1ipUadfpnUzDMO1OulV0CJNV6bcBk7Es9
        RW6AHfg9j8osSanpwvRM4MJkB0SRxYUnrN9faGpkBZISZJ8TShhaTHEGfSNgKe5y
        8iu+AMGGZu8DYczVmqS3Ske1fq6y5HEGCma7Mo019GmwKeHBo1obuET6cZRygj4y
        twIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCNkRzPmK1aQMY5
        Kpl0Hk8kTRxw4JySySnSE3eRBtPWqe/73+TrqOVaBWLgdJOmnB00X9iW7m7njVCP
        46TKD67yjY+8qjkJ+C9MOwUtOtkdRdTqEJIZq0sBCh43qVPzDOi/avgMV5xesipw
        7pK8wHl5w+qx+JOLi2uw0qAnhxZLqAgsfrYhJ3WKlRp1+mdTMMw7U66VXQIk1Xpt
        wGTsSz1FboAd+D2PyixJqenC9EzgwmQHRJHFhSes319oamQFkhJknxNKGFpMcQZ9
        I2Ap7nLyK74AwYZm7wNhzNWapLdKR7V+rrLkcQYKZrsyjTX0abAp4cGjWhu4RPpx
        lHKCPjK3AgMBAAECggEABMo/sNCIMREXA/EqjxDFecN4LmOTOK5A0YBiH9Cc01sd
        qSaavtSQqhqbjV+0bUNEA7UohXbc3s3bx3qa5VFhiIh8sBQMaQdyRkCK/MxMc16d
        BSx5XQ/8MjVO73A1zHgH2g47BWPjgRrDL94KrgNPOO0FoG76QxL9GlcOHzhFa1rf
        xbb2auLBtflKy+5TZNnB/sbFC9ISpWywzfblD2Fsvxupl0vNWtA0Y2rPbKMZRnY+
        V6NC38yxW3HHAdWQRYLGOitM59I0HBgnjQKzTBNIsjPnJA2BSZvMBtQ1e3RQV0qE
        8VVoktZ8A0KDUxqdKWYlGYAY5hIw1y3UUsPRUbS3fQKBgQDAZehu+Kb5Sw+h00Qu
        vViNHDvi0PwmhQrHVpgjrppCnWsTk6FJFm+EBLY+87usXuRCnfZ1semb6P+yjLh2
        bJ9IXIrFAztcyE+7eZfn0H7mHA7E2ICKTjNdKbjy8kHViHpgdXREnAOrFTTk/BqW
        dq+weG2OuxYczWsY4XliWaVyiwKBgQC8XYExpSmoyI37o+jr9405k30tbGUw4X+/
        xYOvSUuafI8IOSLfKTpsvkMN3hxpJO6apIRAjOALbotKUA5FrHQPenuBWOr3mBJT
        euLiaWphqU8YN5dbNd+JhC/Jh5DLhY5FpB2Fv2MKSoF7+onpjDy9pEU5aReeBB0v
        ekUw4nWiBQKBgHxyrnjxP1frFG5xMB4nfZqw04+v7BmiXsl3mqsh6kgCeNtN17pl
        17YGMjfgAdnJ+02XzW5tqRSfDp3YZgy7z//HVD+BCqnGK8SxLu/ULfD73xW2kNZl
        JNYzAZ2r06eiQr4X2x/x5nGIIxGmfDAtDxFPpFX5b6ErwgVy+sgCAoFnAoGAWSpu
        EMEdQk+FnnwNsz2g9YNSuyDXmdb08SOfXWd1yXBzCLJ7RmYuyPEbrsHYcxFPfZap
        ICFPoTm35/qTdvnWiskxE56yw3eSHUBLjF/YQtixn0YZeMy8v0z6jgyFR0I2gdLZ
        QsnBKUrxlm2XwR1oV2Eef7m2u085PZNEk4pvor0CgYA6n060r48/CgRVslAeGder
        fZ3n+2ru8q2UVB38evepjLifn5+tKdFzZ7/NckXMC0NOVzm74qG46VFLMw5TtyT4
        /hRvGSYxA6dMjXy+tcrAns9Isrz2PnYFntlbhU6hw0um809tFunbvITfyeOjAsDW
        stC4thnhzXXT1Y3RfFtYEg==
        -----END PRIVATE KEY-----
    encryption:
      key-id: encryption-key
      public-key: |-
        -----BEGIN PUBLIC KEY-----
        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtU7Vu4tML8qg9BISaUH0
        BTU0+qkHJS3TUl3R0hEPttZJGf8EgT7bpWqRjdhMC2SYt2ifNF82EgMo/eva1rLn
        wYtCsxjJ7oB4U2m16/JKHtphmMUGhSLgbp+Y8pGAQ+P6u4HLlI0qbL92Syb6QCTr
        nYIlzZ2uUAvUQg/SbuAvdS4kdauZtpMNbhryusMVvILVBC5yUhfLJAkjbU3qWo/n
        2NKPr4kjwwFh6FaAf0HLsXCFmJbPPok6WMZeDqPORPZCt5gU2t04fS7s/2SSbhQ/
        i+7yyT4pl44cUlNLLN3Qo73sai5H90q7Dvmk3M5/YMJB0Ueyb705LHyOO5xA618s
        qQIDAQAB
        -----END PUBLIC KEY-----
      private-key: |-
        -----BEGIN PRIVATE KEY-----
        MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC1TtW7i0wvyqD0
        EhJpQfQFNTT6qQclLdNSXdHSEQ+21kkZ/wSBPtulapGN2EwLZJi3aJ80XzYSAyj9
        69rWsufBi0KzGMnugHhTabXr8koe2mGYxQaFIuBun5jykYBD4/q7gcuUjSpsv3ZL
        JvpAJOudgiXNna5QC9RCD9Ju4C91LiR1q5m2kw1uGvK6wxW8gtUELnJSF8skCSNt
        Tepaj+fY0o+viSPDAWHoVoB/QcuxcIWYls8+iTpYxl4Oo85E9kK3mBTa3Th9Luz/
        ZJJuFD+L7vLJPimXjhxSU0ss3dCjvexqLkf3SrsO+aTczn9gwkHRR7JvvTksfI47
        nEDrXyypAgMBAAECggEAREnJHrY8n9OGA+e6n4KD0mJT7gUz98Dm0yMbIC/k50yW
        hAAVRkjSmd8lq3NIURI2ov342NTznJ0sF1d6OVtxBujY2nP/uqEQsPoj1xaO7Ef8
        cnnjFsooFgJurQ44bVm02mLstqrky8jhWTT5FKfTRqP6cRNu0B9kdu1WqQQvW8a/
        C8xD8XUFzzJFQsEstJ076NjlZNH3EeqFiLxyVdV7tPEJRnOe2V2BAAgda3ByA6Jc
        Nd4xYHTVr5rZ+KES9gaAgb86+S7hNigsxz5Gp58NimLEyz1Qd+d9QCgPRgKOV5Uq
        0ci6c28ZrxW9wa/2CGCpoow1V7hRy1fZ24g2Tz91cQKBgQDbSdP/FQYuem0pUf8u
        mA/niEC8Jz30FW3ix5aqbQ8YRudK48Xy8F7AWnlS0wT2k/Xaeppn9YSPK4HlsNk2
        1gnpNfzdqXpJQtuxcPPeFNzUdXzBrsLXYqtlhOX/afrzqMhp73gkqoxXtqwD7BqN
        VfMcVXsWrEZQrRPBn/RUnnLdJwKBgQDTqUGupm93UlhoPgLXHGF/seQwPPHcU6lS
        SS9l512Ie21B+vZecgO4r77BXJwbY4rZVA5/m+wrsNmsT2f8yfdbs84cBDDWiKy5
        t2Um8zrus+BCIffxc9Fck9/htK33jLLcYwdSAm3a9pJxR9f/kAdredSTGBNJ3W/2
        rfh3cdNprwKBgDi7WfBFRSsjGzi0cPth9cNlubGzyVBrdtlT34PJ4Tzboxz53o1i
        aHEFNxwZYdBVKSbTzzyUBS5xCBMfdKK+LyQ5hmjmXq+zb1jxqvXKmfMRTixhhSDp
        8wO5pTM1/Omqwea+QGvj/5j1tnzxSVFFajbrWoPcH/jhPho6wqBducPDAoGBALOJ
        MEOavZXy7TaO0w3v7uvH0wzvxR/kfw1jMqc3l2j7ePOskmoOQAXaXO3bRjcdOlua
        Jyoq8islOZ4lRMlx7zWD0OKG035GNGzbmRtu2aA8R48RDSVr3jyu2gqznZULbXPv
        M/hmQxSmbhVUoW0PmJubnaqfk0zmXeBaNRXsIS3VAoGBALdsAtqR23PVeL6sYj2l
        dRNTDXpfvjFqJ5NThRO/4mT0CrPHQVj+Mz2bTc/Dxiwi8s8m3L+g23i3hodh/QMb
        Iz+UbcJZBGAKsFbPKGOtj6Bi07y/L11mcuNJzOWe61/JbVmJss0s+N/v3XucK/Ge
        CUaGOccsMO221v6JoBh9J3Hz
        -----END PRIVATE KEY-----</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: G√ºvenlik Yapƒ±landƒ±rmasƒ±</h2>
<p>Bu b√∂l√ºmde, JWE tabanlƒ± kimlik doƒürulama i√ßin gerekli olan bean‚Äôleri ve ayarlarƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>AdminProperties: Admin kullanƒ±cƒ± adƒ± ve ≈üifresini `application.properties` veya `application.yml` √ºzerinden okur.</li>
<li>UserProperties: Kullanƒ±cƒ± kimlik bilgilerini yapƒ±landƒ±rmadan y√ºkler.</li>
<li>JwtProperties: JWT encoder/decoder i√ßin imzalama ve ≈üifreleme anahtar √ßiftlerini, issuer bilgisini ve expire s√ºresini tanƒ±mlar.</li>
<li>SecurityJwtConfig: RSA JWK nesnelerini olu≈üturur, JWT encoder/decoder‚Äôƒ±, authentication converter ve token resolveri yapƒ±landƒ±rƒ±r.</li>
<li>SecurityConfig: Bellek i√ßi (in-memory) kullanƒ±cƒ±larƒ± tanƒ±mlar ve stateless bir g√ºvenlik filtresi zinciri kurarak ilgili URL‚Äôleri yetkilendirmeye tabi tutar.</li>
</ul>
<h3>AdminProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.admin&quot;)
@Data
public class AdminProperties {
    private String username;
    private String password;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration

@Configuration
@ConfigurationProperties(prefix = &quot;security.admin&quot;)
class AdminProperties {
  lateinit var username: String
  lateinit var password: String
}</code></pre>
<h3>SecurityJwtConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.config;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.JWKSet;
import com.nimbusds.jose.jwk.RSAKey;
import com.nimbusds.jose.jwk.source.JWKSource;
import com.nimbusds.jose.proc.JWEDecryptionKeySelector;
import com.nimbusds.jose.proc.JWSVerificationKeySelector;
import com.nimbusds.jose.proc.SecurityContext;
import com.nimbusds.jwt.proc.DefaultJWTProcessor;
import io.github.susimsek.springbootjwedemo.security.CookieBearerTokenResolver;
import io.github.susimsek.springbootjwedemo.security.KeyUtils;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.oauth2.jwt.JwtDecoder;
import org.springframework.security.oauth2.jwt.JwtEncoder;
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder;
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder;
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter;
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;

import java.util.List;

import static io.github.susimsek.springbootjwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Configuration
public class SecurityJwtConfig {

    private final JwtProperties props;
    public SecurityJwtConfig(JwtProperties props) { this.props = props; }

    @Bean
    public RSAKey signingKey() throws Exception {
        return KeyUtils.buildRsaKey(
            props.getSigning().getPublicKey(),
            props.getSigning().getPrivateKey(),
            props.getSigning().getKeyId(),
            true
        );
    }

    @Bean
    public RSAKey encryptionKey() throws Exception {
        return KeyUtils.buildRsaKey(
            props.getEncryption().getPublicKey(),
            props.getEncryption().getPrivateKey(),
            props.getEncryption().getKeyId(),
            false
        );
    }

    @Bean
    public JWKSource&lt;SecurityContext&gt; jwkSource(RSAKey signingKey, RSAKey encryptionKey) {
        JWKSet jwkSet = new JWKSet(List.of(
            signingKey,
            encryptionKey
        ));
        return (jwkSelector, context) -&gt; jwkSelector.select(jwkSet);
    }

    @Bean
    public JwtDecoder jwtDecoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
        DefaultJWTProcessor&lt;SecurityContext&gt; jwtProcessor = new DefaultJWTProcessor&lt;&gt;();
        JWEDecryptionKeySelector&lt;SecurityContext&gt; jweKeySelector =
            new JWEDecryptionKeySelector&lt;&gt;(
                JWEAlgorithm.RSA_OAEP_256,
                EncryptionMethod.A128GCM,
                jwkSource
            );
        jwtProcessor.setJWEKeySelector(jweKeySelector);

        JWSVerificationKeySelector&lt;SecurityContext&gt; jwsKeySelector =
            new JWSVerificationKeySelector&lt;&gt;(
                JWSAlgorithm.RS256,
                jwkSource
            );
        jwtProcessor.setJWSKeySelector(jwsKeySelector);
        jwtProcessor.setJWTClaimsSetVerifier((claims, context) -&gt; {});

        return new NimbusJwtDecoder(jwtProcessor);
    }

    @Bean
    public JwtEncoder jwtEncoder(JWKSource&lt;SecurityContext&gt; jwkSource) {
        return new NimbusJwtEncoder(jwkSource);
    }

    @Bean
    public JwtAuthenticationConverter jwtAuthenticationConverter() {
        JwtGrantedAuthoritiesConverter converter = new JwtGrantedAuthoritiesConverter();
        converter.setAuthorityPrefix(&quot;&quot;);
        converter.setAuthoritiesClaimName(AUTHORITIES_KEY);

        JwtAuthenticationConverter authConverter = new JwtAuthenticationConverter();
        authConverter.setJwtGrantedAuthoritiesConverter(converter);
        return authConverter;
    }

    @Bean
    public BearerTokenResolver bearerTokenResolver() {
        CookieBearerTokenResolver resolver = new CookieBearerTokenResolver();
        resolver.setAllowUriQueryParameter(false);
        resolver.setAllowFormEncodedBodyParameter(false);
        resolver.setAllowCookie(true);
        return resolver;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.config

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.JWKSet
import com.nimbusds.jose.jwk.RSAKey
import com.nimbusds.jose.jwk.source.JWKSource
import com.nimbusds.jose.proc.JWEDecryptionKeySelector
import com.nimbusds.jose.proc.JWSVerificationKeySelector
import com.nimbusds.jose.proc.SecurityContext
import com.nimbusds.jwt.proc.DefaultJWTProcessor
import io.github.susimsek.springbootjwedemo.security.CookieBearerTokenResolver
import io.github.susimsek.springbootjwedemo.security.KeyUtils
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.oauth2.jwt.JwtDecoder
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.NimbusJwtDecoder
import org.springframework.security.oauth2.jwt.NimbusJwtEncoder
import org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter
import org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver

@Configuration
class SecurityJwtConfig(private val props: JwtProperties) {

    @Bean
    @Throws(Exception::class)
    fun signingKey(): RSAKey =
        KeyUtils.buildRsaKey(
            props.signing.publicKey,
            props.signing.privateKey,
            props.signing.keyId,
            true
        )

    @Bean
    @Throws(Exception::class)
    fun encryptionKey(): RSAKey =
        KeyUtils.buildRsaKey(
            props.encryption.publicKey,
            props.encryption.privateKey,
            props.encryption.keyId,
            false
        )

    @Bean
    fun jwkSource(signingKey: RSAKey, encryptionKey: RSAKey): JWKSource&lt;SecurityContext&gt; {
        val jwkSet = JWKSet(listOf(signingKey, encryptionKey))
        return JWKSource { jwkSelector, context -&gt; jwkSelector.select(jwkSet) }
    }

    @Bean
    fun jwtDecoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtDecoder {
        val jwtProcessor = DefaultJWTProcessor&lt;SecurityContext&gt;()
        val jweKeySelector = JWEDecryptionKeySelector(
            JWEAlgorithm.RSA_OAEP_256,
            EncryptionMethod.A128GCM,
            jwkSource
        )
        jwtProcessor.jweKeySelector = jweKeySelector
        val jwsKeySelector = JWSVerificationKeySelector(
            JWSAlgorithm.RS256,
            jwkSource
        )
        jwtProcessor.jwsKeySelector = jwsKeySelector
        jwtProcessor.jwtClaimsSetVerifier = { _, _ -&gt; }
        return NimbusJwtDecoder(jwtProcessor)
    }

    @Bean
    fun jwtEncoder(jwkSource: JWKSource&lt;SecurityContext&gt;): JwtEncoder =
        NimbusJwtEncoder(jwkSource)

    @Bean
    fun jwtAuthenticationConverter(): JwtAuthenticationConverter {
        val converter = JwtGrantedAuthoritiesConverter().apply {
            setAuthorityPrefix(&quot;&quot;)
            setAuthoritiesClaimName(AUTHORITIES_KEY)
        }
        return JwtAuthenticationConverter().apply {
            setJwtGrantedAuthoritiesConverter(converter)
        }
    }

    @Bean
    fun bearerTokenResolver(): BearerTokenResolver =
        CookieBearerTokenResolver().apply {
            setAllowUriQueryParameter(false)
            setAllowFormEncodedBodyParameter(false)
            setAllowCookie(true)
        }
}</code></pre>
<h3>SecurityConfig</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.config;

import io.github.susimsek.springbootjwedemo.security.AuthoritiesConstants;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.ProviderManager;
import org.springframework.security.authentication.dao.DaoAuthenticationProvider;
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher;
import org.springframework.web.servlet.handler.HandlerMappingIntrospector;

import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
@EnableMethodSecurity(securedEnabled = true)
public class SecurityConfig {

    @Bean
    public InMemoryUserDetailsManager userDetailsService(AdminProperties adminProps,
                                                         UserProperties userProps,
                                                         PasswordEncoder passwordEncoder) {
        var admin = User.withUsername(adminProps.getUsername())
            .password(passwordEncoder.encode(adminProps.getPassword()))
            .authorities(AuthoritiesConstants.ADMIN)
            .build();

        var user = User.withUsername(userProps.getUsername())
            .password(passwordEncoder.encode(userProps.getPassword()))
            .authorities(AuthoritiesConstants.USER)
            .build();

        return new InMemoryUserDetailsManager(admin, user);
    }

    @Bean public PasswordEncoder passwordEncoder() { return new BCryptPasswordEncoder(); }

    @Bean
    public AuthenticationManager authenticationManager(UserDetailsService uds) {
        var provider = new DaoAuthenticationProvider();
        provider.setUserDetailsService(uds);
        provider.setPasswordEncoder(passwordEncoder());
        return new ProviderManager(provider);
    }

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http,
                                           MvcRequestMatcher.Builder mvc) throws Exception {
        http
            .cors(withDefaults())
            .csrf(AbstractHttpConfigurer::disable)
            .authorizeHttpRequests(authz -&gt;
                authz
                    .requestMatchers(mvc.pattern(&quot;/*.ico&quot;), mvc.pattern(&quot;/*.png&quot;), mvc.pattern(&quot;/*.svg&quot;),
                        mvc.pattern(&quot;/*.webapp&quot;)
                    ).permitAll()
                    .requestMatchers(&quot;/actuator/**&quot;).permitAll()
                    .requestMatchers(
                        &quot;/v3/api-docs/**&quot;,
                        &quot;/swagger-ui.html&quot;,
                        &quot;/swagger-ui/**&quot;
                    ).permitAll()
                    .requestMatchers(mvc.pattern(&quot;/api/auth/login&quot;)).permitAll()
                    .requestMatchers(mvc.pattern(&quot;/api/hello/admin&quot;)).hasAuthority(AuthoritiesConstants.ADMIN)
                .anyRequest().authenticated()
            )
            .sessionManagement(session -&gt;
                session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            .oauth2ResourceServer(oauth2 -&gt; oauth2
                .jwt(withDefaults())
            );
        return http.build();
    }

    @Bean
    public MvcRequestMatcher.Builder mvc(HandlerMappingIntrospector introspector) {
        return new MvcRequestMatcher.Builder(introspector);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.config

import io.github.susimsek.springbootjwedemo.security.AuthoritiesConstants
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.ProviderManager
import org.springframework.security.authentication.dao.DaoAuthenticationProvider
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.config.http.SessionCreationPolicy
import org.springframework.security.core.userdetails.User
import org.springframework.security.core.userdetails.UserDetailsService
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder
import org.springframework.security.crypto.password.PasswordEncoder
import org.springframework.security.provisioning.InMemoryUserDetailsManager
import org.springframework.security.web.SecurityFilterChain
import org.springframework.security.web.servlet.util.matcher.MvcRequestMatcher
import org.springframework.web.servlet.handler.HandlerMappingIntrospector
import org.springframework.security.config.Customizer.withDefaults

@Configuration
@EnableMethodSecurity(securedEnabled = true)
class SecurityConfig {

    @Bean
    fun userDetailsService(
        adminProps: AdminProperties,
        userProps: UserProperties,
        passwordEncoder: PasswordEncoder
    ): UserDetailsService {
        val admin = User.withUsername(adminProps.username)
            .password(passwordEncoder.encode(adminProps.password))
            .authorities(AuthoritiesConstants.ADMIN)
            .build()
        val user = User.withUsername(userProps.username)
            .password(passwordEncoder.encode(userProps.password))
            .authorities(AuthoritiesConstants.USER)
            .build()
        return InMemoryUserDetailsManager(admin, user)
    }

    @Bean
    fun passwordEncoder(): PasswordEncoder = BCryptPasswordEncoder()

    @Bean
    fun authenticationManager(uds: UserDetailsService): AuthenticationManager {
        val provider = DaoAuthenticationProvider().apply {
            setUserDetailsService(uds)
            setPasswordEncoder(passwordEncoder())
        }
        return ProviderManager(provider)
    }

    @Bean
    fun filterChain(http: HttpSecurity, mvc: MvcRequestMatcher.Builder): SecurityFilterChain =
        http.cors(withDefaults())
            .csrf { it.disable() }
            .authorizeHttpRequests { authz -&gt;
                authz
                    .requestMatchers(mvc.pattern(&quot;/*.ico&quot;), mvc.pattern(&quot;/*.png&quot;), mvc.pattern(&quot;/*.svg&quot;), mvc.pattern(&quot;/*.webapp&quot;)).permitAll()
                    .requestMatchers(&quot;/actuator/**&quot;).permitAll()
                    .requestMatchers(&quot;/v3/api-docs/**&quot;, &quot;/swagger-ui.html&quot;, &quot;/swagger-ui/**&quot;).permitAll()
                    .requestMatchers(mvc.pattern(&quot;/api/auth/login&quot;)).permitAll()
                    .requestMatchers(mvc.pattern(&quot;/api/hello/admin&quot;)).hasAuthority(AuthoritiesConstants.ADMIN)
                    .anyRequest().authenticated()
            }
            .sessionManagement { it.sessionCreationPolicy(SessionCreationPolicy.STATELESS) }
            .oauth2ResourceServer { it.jwt(withDefaults()) }
            .build()

    @Bean
    fun mvc(introspector: HandlerMappingIntrospector): MvcRequestMatcher.Builder =
        MvcRequestMatcher.Builder(introspector)
}</code></pre>
<h3>JwtProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

import java.time.Duration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
@Data
public class JwtProperties {

    @Data
    public static class Pair {
        private String publicKey;
        private String privateKey;
        private String keyId;
    }

    private Pair signing;
    private Pair encryption;
    private String issuer;
    private Duration expirationDuration;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration
import java.time.Duration

@Configuration
@ConfigurationProperties(prefix = &quot;security.jwt&quot;)
class JwtProperties {

  class Pair {
    lateinit var publicKey: String
    lateinit var privateKey: String
    lateinit var keyId: String
  }

  lateinit var signing: Pair
  lateinit var encryption: Pair
  lateinit var issuer: String
  lateinit var expirationDuration: Duration
}</code></pre>
<h3>UserProperties</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.config;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;

@Configuration
@ConfigurationProperties(prefix = &quot;security.user&quot;)
@Data
public class UserProperties {
    private String username;
    private String password;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.config

import org.springframework.boot.context.properties.ConfigurationProperties
import org.springframework.context.annotation.Configuration

@Configuration
@ConfigurationProperties(prefix = &quot;security.user&quot;)
class UserProperties {
  lateinit var username: String
  lateinit var password: String
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: G√ºvenli JWE Token Yardƒ±mcƒ± Sƒ±nƒ±flarƒ± Olu≈üturun</h2>
<p>Bu b√∂l√ºmde, Spring Boot uygulamanƒ±zda JSON Web Encryption (JWE) tokenlarƒ± olu≈üturmak, ≈üifrelemek ve √ß√∂zmek i√ßin gereken temel yardƒ±mcƒ± sƒ±nƒ±flarƒ± ve sabitleri tanƒ±mlƒ±yoruz. Bu bile≈üenler ≈üunlarƒ± saƒülar:</p>
<ul>
<li>AuthoritiesConstants: `ROLE_` √∂n ekiyle rol isimlerini merkezile≈ütirir.</li>
<li>CookieBearerTokenResolver: Bearer token‚Äôlarƒ± yetkilendirme ba≈ülƒ±klarƒ±ndan veya HTTP √ßerezlerinden √ß√∂zer.</li>
<li>CookieUtils: Eri≈üim token‚Äôlarƒ± i√ßin HTTP-only ve secure √ßerezler olu≈üturur.</li>
<li>JweUtil: Nimbus k√ºt√ºphanesi ile RSA anahtarlarƒ± kullanarak JWT‚Äôleri imzalar (JWS) ve ≈üifreler (JWE).</li>
<li>KeyUtils: PEM formatƒ±ndaki anahtar √ßiftinden RSA JWK‚Äôleri olu≈üturur.</li>
<li>SecurityUtils: SecurityContext oturum a√ßan kullanƒ±cƒ±nƒ±n bilgisini sunar.</li>
</ul>
<p>Bu yardƒ±mcƒ±lar, Spring Security ile durumsuz (stateless) JWE tabanlƒ± bir kimlik doƒürulama akƒ±≈üƒ±nƒ±n temelini olu≈üturur.</p>
<h3>AuthoritiesConstants</h3>
<h3>Java</h3>
<pre><code class="language-java">
package io.github.susimsek.springbootjwedemo.security;

import lombok.AccessLevel;
import lombok.NoArgsConstructor;

@NoArgsConstructor(access = AccessLevel.PRIVATE)
public final class AuthoritiesConstants {
    public static final String ADMIN = &quot;ROLE_ADMIN&quot;;
    public static final String USER = &quot;ROLE_USER&quot;;
    public static final String ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">
package io.github.susimsek.springbootjwedemo.security

object AuthoritiesConstants {
  const val ADMIN = &quot;ROLE_ADMIN&quot;
  const val USER = &quot;ROLE_USER&quot;
  const val ANONYMOUS = &quot;ROLE_ANONYMOUS&quot;
}</code></pre>
<h3>CookieBearerTokenResolver</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.security;

import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletRequest;
import lombok.Setter;
import org.springframework.http.HttpMethod;
import org.springframework.security.oauth2.core.OAuth2AuthenticationException;
import org.springframework.security.oauth2.server.resource.BearerTokenError;
import org.springframework.security.oauth2.server.resource.BearerTokenErrors;
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver;
import org.springframework.util.StringUtils;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

@Setter
public class CookieBearerTokenResolver implements BearerTokenResolver {
    private static final String ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;;
    private static final Pattern AUTHORIZATION_PATTERN =
        Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE);

    private boolean allowFormEncodedBodyParameter = false;
    private boolean allowUriQueryParameter       = false;
    private boolean allowCookie                  = true;
    private String  bearerTokenHeaderName       = &quot;Authorization&quot;;
    private String  cookieName                  = &quot;accessToken&quot;;

    @Override
    public String resolve(HttpServletRequest request) {
        String headerToken = resolveFromAuthorizationHeader(request);
        String queryToken  = resolveAccessTokenFromQueryString(request);
        String bodyToken   = resolveAccessTokenFromBody(request);
        String cookieToken = (headerToken == null &amp;&amp; queryToken == null &amp;&amp; bodyToken == null)
            ? resolveFromCookie(request)
            : null;

        return resolveToken(headerToken, queryToken, bodyToken, cookieToken);
    }

    private String resolveFromAuthorizationHeader(HttpServletRequest request) {
        String authorization = request.getHeader(this.bearerTokenHeaderName);
        if (!StringUtils.hasText(authorization) || !authorization.toLowerCase().startsWith(&quot;bearer&quot;)) {
            return null;
        }
        Matcher matcher = AUTHORIZATION_PATTERN.matcher(authorization.trim());
        if (!matcher.matches()) {
            BearerTokenError error = BearerTokenErrors.invalidToken(&quot;Bearer token is malformed&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return matcher.group(&quot;token&quot;);
    }

    private String resolveAccessTokenFromQueryString(HttpServletRequest request) {
        if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.getMethod())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveAccessTokenFromBody(HttpServletRequest request) {
        if (allowFormEncodedBodyParameter
            &amp;&amp; HttpMethod.POST.matches(request.getMethod())
            &amp;&amp; &quot;application/x-www-form-urlencoded&quot;.equals(request.getContentType())) {
            return resolveToken(request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME));
        }
        return null;
    }

    private String resolveFromCookie(HttpServletRequest request) {
        if (!allowCookie || request.getCookies() == null) {
            return null;
        }
        for (Cookie cookie : request.getCookies()) {
            if (cookieName.equals(cookie.getName())) {
                String val = cookie.getValue();
                return StringUtils.hasText(val) ? val : null;
            }
        }
        return null;
    }

    private String resolveToken(String... tokens) {
        String found = null;
        for (String token : tokens) {
            if (token == null) continue;
            if (found != null) {
                BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens in the request&quot;);
                throw new OAuth2AuthenticationException(error);
            }
            found = token;
        }
        if (found != null &amp;&amp; found.isBlank()) {
            BearerTokenError error = BearerTokenErrors.invalidRequest(&quot;The requested token parameter is an empty string&quot;);
            throw new OAuth2AuthenticationException(error);
        }
        return found;
    }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.security

import jakarta.servlet.http.Cookie
import jakarta.servlet.http.HttpServletRequest
import org.springframework.http.HttpMethod
import org.springframework.security.oauth2.core.OAuth2AuthenticationException
import org.springframework.security.oauth2.server.resource.BearerTokenError
import org.springframework.security.oauth2.server.resource.BearerTokenErrors
import org.springframework.security.oauth2.server.resource.web.BearerTokenResolver
import org.springframework.util.StringUtils
import java.util.regex.Pattern

class CookieBearerTokenResolver {
    var allowFormEncodedBodyParameter: Boolean = false
    var allowUriQueryParameter: Boolean = false
    var allowCookie: Boolean = true
    var bearerTokenHeaderName: String = &quot;Authorization&quot;
    var cookieName: String = &quot;accessToken&quot;

    companion object {
        private const val ACCESS_TOKEN_PARAMETER_NAME = &quot;access_token&quot;
        private val AUTHORIZATION_PATTERN =
            Pattern.compile(&quot;^Bearer (?&lt;token&gt;[A-Za-z0-9-._~+/]+=*)$&quot;, Pattern.CASE_INSENSITIVE)
    }

    fun resolve(request: HttpServletRequest): String? {
        val header = resolveFromAuthorizationHeader(request)
        val query  = if (allowUriQueryParameter &amp;&amp; HttpMethod.GET.matches(request.method))
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val body   = if (allowFormEncodedBodyParameter &amp;&amp; HttpMethod.POST.matches(request.method)
            &amp;&amp; request.contentType == &quot;application/x-www-form-urlencoded&quot;)
            request.getParameterValues(ACCESS_TOKEN_PARAMETER_NAME)?.let(::resolveToken)
        else null
        val cookie = if (header == null &amp;&amp; query == null &amp;&amp; body == null)
            resolveFromCookie(request)
        else null
        return listOf(header, query, body, cookie).filterNotNull().let {
            if (it.size &gt; 1) throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Found multiple bearer tokens&quot;))
            it.firstOrNull()?: null
        }
    }

    private fun resolveFromAuthorizationHeader(request: HttpServletRequest): String? {
        val auth = request.getHeader(bearerTokenHeaderName) ?: return null
        if (!auth.startsWith(&quot;Bearer &quot;, true)) return null
        val matcher = AUTHORIZATION_PATTERN.matcher(auth.trim())
        return if (matcher.matches()) matcher.group(&quot;token&quot;)
        else throw OAuth2AuthenticationException(BearerTokenErrors.invalidToken(&quot;Malformed token&quot;))
    }

    private fun resolveFromCookie(request: HttpServletRequest): String? {
        if (!allowCookie) return null
        return request.cookies?.firstOrNull { it.name == cookieName }?.value?.takeIf { it.isNotBlank() }
    }

    private fun resolveToken(tokens: Array&lt;String&gt;): String? {
        return tokens.filter { it.isNotBlank() }.let {
            when {
                it.isEmpty() -&gt; null
                it.size &gt; 1   -&gt; throw OAuth2AuthenticationException(BearerTokenErrors.invalidRequest(&quot;Multiple tokens&quot;))
                else          -&gt; it[0]
            }
        }
    }</code></pre>
<h3>CookieUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.security;

import io.github.susimsek.springbootjwedemo.dto.TokenDTO;
import lombok.experimental.UtilityClass;
import org.springframework.http.ResponseCookie;

@UtilityClass
public class CookieUtils {

    private static final String COOKIE_NAME = &quot;accessToken&quot;;

    public ResponseCookie createAccessTokenCookie(TokenDTO tokenDto) {
        return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
            .httpOnly(true)
            .secure(true)
            .path(&quot;/&quot;)
            .maxAge(tokenDto.accessTokenExpiresIn())
            .sameSite(&quot;Strict&quot;)
            .build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.security

import io.github.susimsek.springbootjwedemo.dto.TokenDTO
import org.springframework.http.ResponseCookie

object CookieUtils {

  private const val COOKIE_NAME = &quot;accessToken&quot;

  fun createAccessTokenCookie(tokenDto: TokenDTO): ResponseCookie {
    return ResponseCookie.from(COOKIE_NAME, tokenDto.accessToken())
      .httpOnly(true)
      .secure(true)
      .path(&quot;/&quot;)
      .maxAge(tokenDto.accessTokenExpiresIn())
      .sameSite(&quot;Strict&quot;)
      .build()
  }
}</code></pre>
<h3>JweUtil</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.security;

import com.nimbusds.jose.EncryptionMethod;
import com.nimbusds.jose.JOSEException;
import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWEHeader;
import com.nimbusds.jose.JWEObject;
import com.nimbusds.jose.Payload;
import com.nimbusds.jose.crypto.RSAEncrypter;
import com.nimbusds.jose.jwk.RSAKey;
import io.github.susimsek.springbootjwedemo.config.JwtProperties;
import io.github.susimsek.springbootjwedemo.dto.TokenDTO;
import lombok.RequiredArgsConstructor;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm;
import org.springframework.security.oauth2.jwt.*;
import org.springframework.stereotype.Component;

import java.time.Instant;
import java.util.List;

import static io.github.susimsek.springbootjwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@Component
@RequiredArgsConstructor
public class JweUtil {

    private final JwtEncoder jwtEncoder;
    private final RSAKey signingKey;
    private final RSAKey encryptionKey;
    private final JwtProperties props;

    public TokenDTO generateToken(Authentication authentication) throws JOSEException {
        String subject = authentication.getName();
        List&lt;String&gt; roles = authentication.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority)
            .toList();

        Instant now = Instant.now();
        long expiresIn = props.getExpirationDuration().getSeconds();
        Instant exp = now.plusSeconds(expiresIn);

        JwtClaimsSet claims = JwtClaimsSet.builder()
            .issuer(props.getIssuer())
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build();

        JwsHeader jwsHeader = JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.getKeyID())
            .build();

        String jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .getTokenValue();

        JWEHeader jweHeader = new JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.getKeyID())
            .build();

        JWEObject jweObject = new JWEObject(jweHeader, new Payload(jws));
        jweObject.encrypt(new RSAEncrypter(encryptionKey.toRSAPublicKey()));
        String token = jweObject.serialize();

        return new TokenDTO(token, &quot;Bearer&quot;, expiresIn);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.security

import com.nimbusds.jose.EncryptionMethod
import com.nimbusds.jose.JOSEException
import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWEHeader
import com.nimbusds.jose.JWEObject
import com.nimbusds.jose.Payload
import com.nimbusds.jose.crypto.RSAEncrypter
import com.nimbusds.jose.jwk.RSAKey
import io.github.susimsek.springbootjwedemo.config.JwtProperties
import io.github.susimsek.springbootjwedemo.dto.TokenDTO
import lombok.RequiredArgsConstructor
import org.springframework.security.core.Authentication
import org.springframework.security.oauth2.jose.jws.SignatureAlgorithm
import org.springframework.security.oauth2.jwt.JwtClaimsSet
import org.springframework.security.oauth2.jwt.JwtEncoder
import org.springframework.security.oauth2.jwt.JwtEncoderParameters
import org.springframework.stereotype.Component

import java.time.Instant

@Component
@RequiredArgsConstructor
class JweUtil(
    private val jwtEncoder: JwtEncoder,
    private val signingKey: RSAKey,
    private val encryptionKey: RSAKey,
    private val props: JwtProperties
) {
    fun generateToken(authentication: Authentication): TokenDTO {
        val subject = authentication.name
        val roles = authentication.authorities.map { it.authority }

        val now = Instant.now()
        val expiresIn = props.expirationDuration.seconds
        val exp = now.plusSeconds(expiresIn)

        val claims = JwtClaimsSet.builder()
            .issuer(props.issuer)
            .issuedAt(now)
            .expiresAt(exp)
            .subject(subject)
            .claim(AUTHORITIES_KEY, roles)
            .build()

        val jwsHeader = org.springframework.security.oauth2.jwt.JwsHeader.with(SignatureAlgorithm.RS256)
            .keyId(signingKey.keyID)
            .build()

        val jws = jwtEncoder
            .encode(JwtEncoderParameters.from(jwsHeader, claims))
            .tokenValue

        val jweHeader = JWEHeader.Builder(JWEAlgorithm.RSA_OAEP_256, EncryptionMethod.A128GCM)
            .contentType(&quot;JWT&quot;)
            .keyID(encryptionKey.keyID)
            .build()

        val jweObject = JWEObject(jweHeader, Payload(jws))
        jweObject.encrypt(RSAEncrypter(encryptionKey.toRSAPublicKey()))
        val token = jweObject.serialize()

        return TokenDTO(token, &quot;Bearer&quot;, expiresIn)
    }
}</code></pre>
<h3>KeyUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.security;

import com.nimbusds.jose.JWEAlgorithm;
import com.nimbusds.jose.JWSAlgorithm;
import com.nimbusds.jose.jwk.KeyUse;
import com.nimbusds.jose.jwk.RSAKey;
import lombok.experimental.UtilityClass;

import java.security.KeyFactory;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import java.util.Base64;

@UtilityClass
public class KeyUtils {
    public RSAKey buildRsaKey(
            String pubPem,
            String privPem,
            String kid,
            boolean forSign
    ) throws Exception {
        String pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);
        String privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replaceAll(&quot;\\s&quot;, &quot;&quot;);

        byte[] decodedPub = Base64.getDecoder().decode(pubContent);
        byte[] decodedPriv = Base64.getDecoder().decode(privContent);

        KeyFactory kf = KeyFactory.getInstance(&quot;RSA&quot;);
        RSAPublicKey publicKey = (RSAPublicKey) kf.generatePublic(new X509EncodedKeySpec(decodedPub));
        RSAPrivateKey privateKey = (RSAPrivateKey) kf.generatePrivate(new PKCS8EncodedKeySpec(decodedPriv));

        RSAKey.Builder builder = new RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid);

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE);
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION);
        }

        return builder.build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.security

import com.nimbusds.jose.JWEAlgorithm
import com.nimbusds.jose.JWSAlgorithm
import com.nimbusds.jose.jwk.KeyUse
import com.nimbusds.jose.jwk.RSAKey
import java.security.KeyFactory
import java.security.interfaces.RSAPrivateKey
import java.security.interfaces.RSAPublicKey
import java.security.spec.PKCS8EncodedKeySpec
import java.security.spec.X509EncodedKeySpec
import java.util.Base64

object KeyUtils {
    @JvmStatic
    @Throws(Exception::class)
    fun buildRsaKey(
        pubPem: String,
        privPem: String,
        kid: String,
        forSign: Boolean
    ): RSAKey {
        val pubContent = pubPem
            .replace(&quot;-----BEGIN PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PUBLIC KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)
        val privContent = privPem
            .replace(&quot;-----BEGIN PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(&quot;-----END PRIVATE KEY-----&quot;, &quot;&quot;)
            .replace(Regex(&quot;\\s&quot;), &quot;&quot;)

        val decodedPub = Base64.getDecoder().decode(pubContent)
        val decodedPriv = Base64.getDecoder().decode(privContent)

        val kf = KeyFactory.getInstance(&quot;RSA&quot;)
        val publicKey = kf.generatePublic(X509EncodedKeySpec(decodedPub)) as RSAPublicKey
        val privateKey = kf.generatePrivate(PKCS8EncodedKeySpec(decodedPriv)) as RSAPrivateKey

        val builder = RSAKey.Builder(publicKey)
            .privateKey(privateKey)
            .keyID(kid)

        if (forSign) {
            builder
                .algorithm(JWSAlgorithm.RS256)
                .keyUse(KeyUse.SIGNATURE)
        } else {
            builder
                .algorithm(JWEAlgorithm.RSA_OAEP_256)
                .keyUse(KeyUse.ENCRYPTION)
        }

        return builder.build()
    }
}</code></pre>
<h3>SecurityUtils</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.security;

import lombok.experimental.UtilityClass;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.oauth2.jwt.Jwt;

import java.util.Optional;

@UtilityClass
public class SecurityUtils {

    public static final String AUTHORITIES_KEY = &quot;auth&quot;;

    public Optional&lt;String&gt; getCurrentUserLogin() {
        var ctx = SecurityContextHolder.getContext();
        return Optional.ofNullable(extractPrincipal(ctx.getAuthentication()));
    }

    private String extractPrincipal(Authentication authentication) {
        if (authentication == null) {
            return null;
        }
        Object principal = authentication.getPrincipal();
        if (principal instanceof Jwt jwt) {
            return jwt.getSubject();
        }
        if (principal instanceof UserDetails ud) {
            return ud.getUsername();
        }
        if (principal instanceof String username) {
            return username;
        }
        return null;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.security

import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.security.core.userdetails.UserDetails
import org.springframework.security.oauth2.jwt.Jwt
import java.util.Optional

object SecurityUtils {
  const val AUTHORITIES_KEY = &quot;auth&quot;

  fun getCurrentUserLogin(): Optional&lt;String&gt; {
    val authentication: Authentication? = SecurityContextHolder.getContext().authentication
    return Optional.ofNullable(extractPrincipal(authentication))
  }

  private fun extractPrincipal(authentication: Authentication?): String? {
    return when (val principal = authentication?.principal) {
      is Jwt -&gt; principal.subject
      is UserDetails -&gt; principal.username
      is String -&gt; principal
      else -&gt; null
    }
  }
}</code></pre>
<hr />
<h1>üîê Adƒ±m 5: Kimlik Doƒürulama ve G√ºvenli Endpointler</h1>
<p>Bu b√∂l√ºmde, a≈üaƒüƒ±dakileri ger√ßekle≈ütirmek i√ßin gerekli REST controller ve DTO‚Äôlarƒ± tanƒ±mlƒ±yoruz:</p>
<ul>
<li>AuthController: Kullanƒ±cƒ±larƒ± doƒürular, JWE token‚Äôlarƒ± olu≈üturur ve g√ºvenli cookie ayarlar.</li>
<li>HelloController: Kimliƒüi doƒürulanmƒ±≈ü kullanƒ±cƒ±lar ve yalnƒ±zca admine √∂zel pathler i√ßin g√ºvenli endpointler sunar.</li>
<li>LoginRequestDTO: Login isteƒüi payloadƒ±nƒ± (kullanƒ±cƒ± adƒ±/parola) modelleyen DTO.</li>
<li>TokenDTO: Token ve ge√ßerlilik s√ºresini i√ßeren kimlik doƒürulama yanƒ±tƒ±nƒ± modelleyen DTO.</li>
</ul>
<p>Bu bile≈üenler, login i≈ülemi, token olu≈üturma, cookie y√∂netimi ve kaynak korumasƒ±nƒ± i≈üleyerek stateless(durumsuz) kimlik doƒürulama akƒ±≈üƒ±nƒ± tamamlar.</p>
<p>Bu b√∂l√ºmde, kullanƒ±cƒ± kimlik doƒürulamasƒ±nƒ±, token olu≈üturmayƒ± ve korunan kaynak eri≈üimini y√∂netmek i√ßin REST controller ve DTO‚Äôlarƒ± olu≈üturuyoruz.</p>
<h3>AuthController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.controller;

import io.github.susimsek.springbootjwedemo.dto.LoginRequestDTO;
import io.github.susimsek.springbootjwedemo.dto.TokenDTO;
import io.github.susimsek.springbootjwedemo.security.CookieUtils;
import io.github.susimsek.springbootjwedemo.security.JweUtil;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseCookie;
import org.springframework.http.ResponseEntity;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequiredArgsConstructor
@RequestMapping(&quot;/api/auth&quot;)
public class AuthController {

    private final AuthenticationManager authenticationManager;
    private final JweUtil jweUtil;

    @PostMapping(&quot;/login&quot;)
    public ResponseEntity&lt;TokenDTO&gt; login(@RequestBody LoginRequestDTO loginRequest) throws Exception {
        // Authenticate user
        var authToken = new UsernamePasswordAuthenticationToken(
            loginRequest.username(), loginRequest.password()
        );
        Authentication auth = authenticationManager.authenticate(authToken);
        SecurityContextHolder.getContext().setAuthentication(auth);

        // Generate JWE token and cookie
        TokenDTO tokenDto = jweUtil.generateToken(auth);
        ResponseCookie cookie = CookieUtils.createAccessTokenCookie(tokenDto);

        return ResponseEntity.ok()
            .header(HttpHeaders.SET_COOKIE, cookie.toString())
            .body(tokenDto);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.controller

import io.github.susimsek.springbootjwedemo.dto.LoginRequestDTO
import io.github.susimsek.springbootjwedemo.dto.TokenDTO
import io.github.susimsek.springbootjwedemo.security.CookieUtils
import io.github.susimsek.springbootjwedemo.security.JweUtil
import lombok.RequiredArgsConstructor
import org.springframework.http.HttpHeaders
import org.springframework.http.ResponseCookie
import org.springframework.http.ResponseEntity
import org.springframework.security.authentication.AuthenticationManager
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken
import org.springframework.security.core.Authentication
import org.springframework.security.core.context.SecurityContextHolder
import org.springframework.web.bind.annotation.PostMapping
import org.springframework.web.bind.annotation.RequestBody
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequiredArgsConstructor
@RequestMapping(&quot;/api/auth&quot;)
class AuthController(
    private val authenticationManager: AuthenticationManager,
    private val jweUtil: JweUtil
) {

    @PostMapping(&quot;/login&quot;)
    fun login(@RequestBody loginRequest: LoginRequestDTO): ResponseEntity&lt;TokenDTO&gt; {
        val authToken = UsernamePasswordAuthenticationToken(
            loginRequest.username, loginRequest.password
        )
        val auth: Authentication = authenticationManager.authenticate(authToken)
        SecurityContextHolder.getContext().authentication = auth

        val tokenDto: TokenDTO = jweUtil.generateToken(auth)
        val cookie: ResponseCookie = CookieUtils.createAccessTokenCookie(tokenDto)

        return ResponseEntity.ok()
            .header(HttpHeaders.SET_COOKIE, cookie.toString())
            .body(tokenDto)
    }
}</code></pre>
<h3>HelloController</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.controller;

import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.oauth2.jwt.Jwt;
import org.springframework.web.bind.annotation.*;

import static io.github.susimsek.springbootjwedemo.security.SecurityUtils.AUTHORITIES_KEY;

@RestController
@RequestMapping(&quot;/api/hello&quot;)
public class HelloController {

    @GetMapping
    public String helloAll(@AuthenticationPrincipal Jwt jwt) {
        String user = jwt.getSubject();
        var roles = jwt.getClaimAsStringList(AUTHORITIES_KEY);
        return &quot;Hello, &quot; + user + &quot;! Your roles: &quot; + roles;
    }

    @GetMapping(&quot;/admin&quot;)
    public String helloAdmin(@AuthenticationPrincipal Jwt jwt) {
        return &quot;Hello Admin, &quot; + jwt.getSubject() + &quot;!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.controller

import org.springframework.security.core.annotation.AuthenticationPrincipal
import org.springframework.security.oauth2.jwt.Jwt
import org.springframework.web.bind.annotation.*

import io.github.susimsek.springbootjwedemo.security.SecurityUtils.AUTHORITIES_KEY

@RestController
@RequestMapping(&quot;/api/hello&quot;)
class HelloController {

    @GetMapping
    fun helloAll(@AuthenticationPrincipal jwt: Jwt): String {
        val user = jwt.subject
        val roles = jwt.getClaimAsStringList(AUTHORITIES_KEY)
        return &quot;Hello, \$user! Your roles: \$roles&quot;
    }

    @GetMapping(&quot;/admin&quot;)
    fun helloAdmin(@AuthenticationPrincipal jwt: Jwt): String {
        return &quot;Hello Admin, \${jwt.subject}!&quot;
    }
}</code></pre>
<h3>LoginRequestDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.dto;

public record LoginRequestDTO(
    String username,
    String password
) { }</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.dto

data class LoginRequestDTO(
    val username: String,
    val password: String
)</code></pre>
<h3>TokenDTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package io.github.susimsek.springbootjwedemo.dto;

public record TokenDTO(
    String accessToken,
    String tokenType,
    long accessTokenExpiresIn
) {}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package io.github.susimsek.springbootjwedemo.dto

import kotlin.Long

data class TokenDTO(
    val accessToken: String,
    val tokenType: String,
    val accessTokenExpiresIn: Long
)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±r</h2>
<pre><code class="language-bash">./mvnw spring-boot:run
# or
gradle bootRun</code></pre>
<hr />
<h2>üß™ Endpoint Testi</h2>
<h3>Admin Akƒ±≈üƒ±</h3>
<p>admin olarak giri≈ü yapƒ±n ve `Set-Cookie` ba≈ülƒ±ƒüƒ±ndan JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/api/auth/login \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;adminpass&quot;}&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
<li>Yanƒ±t:</li>
</ul>
<pre><code class="language-json">{
  &quot;accessToken&quot;: &quot;&lt;jwe-token&gt;&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;accessTokenExpiresIn&quot;: 3600
}</code></pre>
<p>cookie kullanarak `hello` endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Veya Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>admin-√∂zel endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello/admin</code></pre>
<h3>Kullanƒ±cƒ± Akƒ±≈üƒ±</h3>
<p>user olarak giri≈ü yapƒ±n ve cookie‚Äôden JWE tokeni yakalayƒ±n:</p>
<pre><code class="language-bash">curl -i -X POST http://localhost:8080/api/auth/login \
  -H &quot;Content-Type: application/json&quot; \
  -d &#39;{&quot;username&quot;:&quot;user&quot;,&quot;password&quot;:&quot;userpass&quot;}&#39;</code></pre>
<ul>
<li>Set-Cookie ba≈ülƒ±ƒüƒ± `accessToken=&lt;jwe-token&gt;` i√ßerir</li>
</ul>
<p>cookie kullanarak `hello` endpointine eri≈üin:</p>
<pre><code class="language-bash">curl -b &quot;accessToken=&lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Authorization ba≈ülƒ±ƒüƒ±yla:</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello</code></pre>
<p>Admin endpointini deneyince (403 Forbidden d√∂ner):</p>
<pre><code class="language-bash">curl -H &quot;Authorization: Bearer &lt;jwe-token&gt;&quot; http://localhost:8080/api/hello/admin
# HTTP/1.1 403 Forbidden</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot JWE Kimlik Doƒürulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[G√ºvenlik]]></category>
      <category><![CDATA[JWT]]></category>
      <category><![CDATA[JWE]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-jwe-auth-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot HTTP Interface Client]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-http-interface-client</link>
      <description><![CDATA[Deklaratif, tip g√ºvenli HTTP √ßaƒürƒ±larƒ± i√ßin Spring Boot 3.2+ HTTP Interface Client nasƒ±l kullanƒ±lƒ±r √∂ƒürenin.]]></description>
      <pubDate>Sun, 27 Apr 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-http-interface-client</guid>
      <content:encoded><![CDATA[<p>Spring Boot 3.2+ ile Java veya Kotlin aray√ºzleri √ºzerinden deklaratif ve tip g√ºvenli HTTP istemcileri tanƒ±mlayabilirsiniz. Bu makalede JSONPlaceholder API √∂rneƒüi ile ba≈ütan sona nasƒ±l yapƒ±landƒ±racaƒüƒ±nƒ±zƒ± √∂ƒüreneceksiniz.</p>
<hr />
<h2>üåü Neden HTTP Aray√ºz ƒ∞stemcisi?</h2>
<ul>
<li>Deklaratif: Bir aray√ºz tanƒ±mlayƒ±p HTTP √ßaƒürƒ±larƒ±nƒ± y√∂ntem anotasyonlarƒ±yla e≈üleyin.</li>
<li>Tip g√ºvenli: Yanlƒ±≈ü imzalar veya hatalƒ± yol konfig√ºrasyonlarƒ± derleme zamanƒ±nda yakalanƒ±r.</li>
<li>Azaltƒ±lmƒ±≈ü tekrar eden kod: Tek bir bean tanƒ±mƒ±, manuel proxy veya template koduna gerek yok.</li>
<li>Spring Dostu: Spring Framework 6.2‚Äônin `@HttpExchange`, `@GetExchange` ve `WebClientAdapter` bile≈üenlerini kullanƒ±r.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>‚òï Java Development Kit (JDK) 21 veya √ºst√º</li>
<li>üì¶ Spring Boot 3.2+</li>
<li>üî§ IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekle</h2>
<p>Projenizin yapƒ± dosyasƒ±na Web starter‚Äôƒ± ekleyin:</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Temel URL Ayarƒ±</h2>
<p>`application.yml` veya `application.properties` dosyanƒ±za ekleyin:</p>
<pre><code class="language-yaml">jsonplaceholder:
  base-url: https://jsonplaceholder.typicode.com</code></pre>
<pre><code class="language-properties">jsonplaceholder.base-url=https://jsonplaceholder.typicode.com</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: DTO ve ƒ∞stemci Aray√ºz√º Tanƒ±mla</h2>
<h3>Java</h3>
<pre><code class="language-java">// src/main/java/com/example/client/dto/PostDTO.java
package com.example.client.dto;

public record PostDTO(
    Integer userId,
    Integer id,
    String title,
    String body
) {}

// src/main/java/com/example/client/JsonPlaceholderClient.java
package com.example.client;

import com.example.client.dto.PostDTO;
import org.springframework.web.service.annotation.GetExchange;
import org.springframework.web.service.annotation.HttpExchange;
import org.springframework.web.bind.annotation.PathVariable;
import java.util.List;

@HttpExchange(url = &quot;${jsonplaceholder.base-url}&quot;, accept = &quot;application/json&quot;)
public interface JsonPlaceholderClient {

    @GetExchange(&quot;/posts&quot;)
    List&lt;PostDTO&gt; getPosts();

    @GetExchange(&quot;/posts/{id}&quot;)
    PostDTO getPost(@PathVariable(&quot;id&quot;) Integer id);
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">// src/main/kotlin/com/example/client/dto/PostDTO.kt
package com.example.client.dto

data class PostDTO(
    val userId: Int,
    val id: Int,
    val title: String,
    val body: String
)

// src/main/kotlin/com/example/client/JsonPlaceholderClient.kt
package com.example.client

import com.example.client.dto.PostDTO
import org.springframework.web.service.annotation.GetExchange
import org.springframework.web.service.annotation.HttpExchange
import org.springframework.web.bind.annotation.PathVariable

@HttpExchange(url = &quot;${jsonplaceholder.base-url}&quot;, accept = &quot;application/json&quot;)
interface JsonPlaceholderClient {

    @GetExchange(&quot;/posts&quot;)
    fun getPosts(): List&lt;PostDTO&gt;

    @GetExchange(&quot;/posts/{id}&quot;)
    fun getPost(@PathVariable(&quot;id&quot;) id: Int): PostDTO
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: ƒ∞stemci Bean‚Äôini Yapƒ±landƒ±r</h2>
<h3>Java</h3>
<pre><code class="language-java">// src/main/java/com/example/config/HttpClientConfig.java
package com.example.config;

import com.example.client.JsonPlaceholderClient;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.client.support.RestClientAdapter;
import org.springframework.web.service.invoker.HttpServiceProxyFactory;
import org.springframework.web.service.invoker.RestClient;

@Configuration
public class HttpClientConfig {

    @Bean
    public JsonPlaceholderClient jsonPlaceholderClient(RestClient.Builder restClientBuilder) {
        RestClient restClient = restClientBuilder
            .baseUrl(&quot;https://jsonplaceholder.typicode.com&quot;)
            .build();

        var factory = HttpServiceProxyFactory
            .builderFor(RestClientAdapter.create(restClient))
            .build();

        return factory.createClient(JsonPlaceholderClient.class);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">// src/main/kotlin/com/example/config/HttpClientConfig.kt
package com.example.config

import com.example.client.JsonPlaceholderClient
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.web.client.support.RestClientAdapter
import org.springframework.web.service.invoker.HttpServiceProxyFactory
import org.springframework.web.service.invoker.RestClient

@Configuration
class HttpClientConfig {

    @Bean
    fun jsonPlaceholderClient(restClientBuilder: RestClient.Builder): JsonPlaceholderClient {
        val restClient = restClientBuilder
            .baseUrl(&quot;https://jsonplaceholder.typicode.com&quot;)
            .build()

        val factory = HttpServiceProxyFactory
            .builderFor(RestClientAdapter.create(restClient))
            .build()

        return factory.createClient(JsonPlaceholderClient::class.java)
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: Servis ve Controller Olu≈üturun</h2>
<h3>Java</h3>
<pre><code class="language-java">// src/main/java/com/example/service/PostService.java
package com.example.service;

import com.example.client.JsonPlaceholderClient;
import com.example.client.dto.PostDTO;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import java.util.List;

@Service
@RequiredArgsConstructor
public class PostService {
    private final JsonPlaceholderClient client;

    public List&lt;PostDTO&gt; getAllPosts() {
        return client.getPosts();
    }

    public PostDTO getPostById(Integer id) {
        return client.getPost(id);
    }
}

// src/main/java/com/example/controller/PostController.java
package com.example.controller;

import com.example.client.dto.PostDTO;
import com.example.service.PostService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import java.util.List;

@RestController
@RequestMapping(&quot;/posts&quot;)
@RequiredArgsConstructor
public class PostController {
    private final PostService postService;

    @GetMapping
    public List&lt;PostDTO&gt; getAllPosts() {
        return postService.getAllPosts();
    }

    @GetMapping(&quot;/{id}&quot;)
    public ResponseEntity&lt;PostDTO&gt; getPostById(@PathVariable Integer id) {
        PostDTO post = postService.getPostById(id);
        return post != null ? ResponseEntity.ok(post) : ResponseEntity.notFound().build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">// src/main/kotlin/com/example/service/PostService.kt
package com.example.service

import com.example.client.JsonPlaceholderClient
import com.example.client.dto.PostDTO
import org.springframework.stereotype.Service

@Service
class PostService(private val client: JsonPlaceholderClient) {
    fun getAllPosts(): List&lt;PostDTO&gt; = client.getPosts()
    fun getPostById(id: Int): PostDTO = client.getPost(id)
}

// src/main/kotlin/com/example/controller/PostController.kt
package com.example.controller

import com.example.client.dto.PostDTO
import com.example.service.PostService
import org.springframework.http.ResponseEntity
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/posts&quot;)
class PostController(private val postService: PostService) {
    @GetMapping
    fun getAllPosts(): List&lt;PostDTO&gt; = postService.getAllPosts()

    @GetMapping(&quot;/{id}&quot;)
    fun getPostById(@PathVariable id: Int): ResponseEntity&lt;PostDTO&gt; =
        ResponseEntity.ok(postService.getPostById(id))
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±r</h2>
<pre><code class="language-bash">./mvnw spring-boot:run
# veya
gradle bootRun</code></pre>
<hr />
<h2>üß™ Endpointleri Test Et</h2>
<pre><code class="language-bash">curl http://localhost:8080/posts
curl http://localhost:8080/posts/1</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot HTTP Interface Client i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[REST API]]></category>
      <category><![CDATA[Rest Client]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-http-interface-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Sanal Thread‚Äôli Asenkron G√∂revler]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-async-tasks-virtual</link>
      <description><![CDATA[Spring Boot‚Äôta JDK 21 sanal thread‚Äôleri ve `@Async` anotasyonunu kullanarak hafif ve √∂l√ßeklenebilir asenkron g√∂revleri nasƒ±l olu≈üturacaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Sat, 26 Apr 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-async-tasks-virtual</guid>
      <content:encoded><![CDATA[<p>Spring Boot 3.2 ve √ºzeri s√ºr√ºmler, JDK 21‚Äôin sanal thread desteƒüini otomatik olarak yapƒ±landƒ±rarak `@Async` anotasyonuyla basit ve y√ºksek performanslƒ± asenkron i≈ülemler yapmanƒ±za imkan tanƒ±r.</p>
<hr />
<h2>üåü Neden Spring Boot&#39;ta Sanal Thread Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Hafif Maliyet: Sanal thread‚Äôler, geleneksel platform thread‚Äôlere kƒ±yasla √ßok daha az kaynak kullanƒ±r.</li>
<li>Bloklamasƒ±z: `@Async` ile i≈üaretlenen metodlar ana thread‚Äôi me≈ügul etmeden √ßalƒ±≈üƒ±r.</li>
<li>Y√ºksek √ñl√ßeklenebilirlik: Binlerce concurrent i≈ü y√ºk√ºn√º d√º≈ü√ºk bellek ayak iziyle y√∂netir.</li>
<li>Basit Konfig√ºrasyon: Tek bir √∂zellik (property) ekleyerek t√ºm executor ve scheduler‚Äôlarƒ± sanal thread‚Äôli yapar.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<ul>
<li>‚òï Java Development Kit (JDK) 21 veya √ºzeri</li>
<li>üì¶ Spring Boot 3.2+</li>
<li>üî§ IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekle</h2>
<p>Asenkron i≈üleme olanak tanƒ±yan `spring-boot-starter-web` paketini projenize ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Sanal Thread‚Äôleri Aktifle≈ütir</h2>
<p>`application.yml` veya `application.properties` dosyanƒ±za ≈üu satƒ±rƒ± ekleyin:</p>
<pre><code class="language-yaml">spring:
  threads:
    virtual:
      enabled: true</code></pre>
<pre><code class="language-properties">spring.threads.virtual.enabled=true</code></pre>
<p>Bu ayar, a≈üaƒüƒ±dakileri otomatik yapƒ±landƒ±rƒ±r:</p>
<ul>
<li>`applicationTaskExecutor` (Async)</li>
<li>Task scheduler (`@Scheduled`)</li>
<li>HTTP sunucu thread havuzlarƒ± (Tomcat/Jetty)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Asenkron Desteƒüi Aktif Etme</h2>
<p>Ana uygulama sƒ±nƒ±fƒ±nƒ±za `@EnableAsync` ekleyin:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.async;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableAsync;

@SpringBootApplication
@EnableAsync
public class AsyncVirtualApplication {
    public static void main(String[] args) {
        SpringApplication.run(AsyncVirtualApplication.class, args);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.async

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.scheduling.annotation.EnableAsync

@SpringBootApplication
@EnableAsync
class AsyncVirtualApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;AsyncVirtualApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Asenkron Servis Tanƒ±mla</h2>
<p>`@Async` anotasyonlu metodlar sanal thread √ºzerinde √ßalƒ±≈üƒ±r:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.async;

import lombok.extern.slf4j.Slf4j;
import org.springframework.scheduling.annotation.Async;
import org.springframework.stereotype.Service;

import java.time.LocalTime;
import java.util.concurrent.CompletableFuture;

@Slf4j
@Service
public class AsyncVirtualService {

    @Async
    public void runTask() {
        log.info(&quot;[{}] Asenkron ba≈ülatƒ±ldƒ±: {}&quot;, LocalTime.now(), Thread.currentThread());
        try { Thread.sleep(1000); } catch (InterruptedException ignored) {}
        log.info(&quot;[{}] Asenkron tamamlandƒ±: {}&quot;, LocalTime.now(), Thread.currentThread());
    }

    @Async
    public CompletableFuture&lt;String&gt; runAndReturn() throws InterruptedException {
        Thread.sleep(500);
        return CompletableFuture.completedFuture(&quot;Tamamlandƒ±&quot;);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.async

import org.slf4j.LoggerFactory
import org.springframework.scheduling.annotation.Async
import org.springframework.stereotype.Service

import java.time.LocalTime
import java.util.concurrent.CompletableFuture

@Service
class AsyncVirtualService {
    private val log = LoggerFactory.getLogger(AsyncVirtualService::class.java)

    @Async
    fun runTask() {
        log.info(&quot;[{}] Asenkron ba≈ülatƒ±ldƒ±: {}&quot;, LocalTime.now(), Thread.currentThread())
        try { Thread.sleep(1000) } catch (_: InterruptedException) {}
        log.info(&quot;[{}] Asenkron tamamlandƒ±: {}&quot;, LocalTime.now(), Thread.currentThread())
    }

    @Async
    fun runAndReturn(): CompletableFuture&lt;String&gt; {
        Thread.sleep(500)
        return CompletableFuture.completedFuture(&quot;Tamamlandƒ±&quot;)
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: REST Controller ile Tetikle</h2>
<p>A≈üaƒüƒ±daki endpoint‚Äôleri kullanarak servis metodlarƒ±nƒ± tetikleyin:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.async;

import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping(&quot;/async&quot;)
@RequiredArgsConstructor
public class AsyncVirtualController {

    private final AsyncVirtualService service;

    @GetMapping(&quot;/run&quot;)
    public String triggerRun() {
        service.runTask();
        return &quot;Asenkron sanal thread g√∂revi tetiklendi&quot;;
    }

    @GetMapping(&quot;/run-return&quot;)
    public String triggerRunAndReturn() throws Exception {
        var future = service.runAndReturn();
        return future.get();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.async

import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

import lombok.RequiredArgsConstructor

@RestController
@RequestMapping(&quot;/async&quot;)
@RequiredArgsConstructor
class AsyncVirtualController(private val service: AsyncVirtualService) {

    @GetMapping(&quot;/run&quot;)
    fun triggerRun(): String {
        service.runTask()
        return &quot;Asenkron sanal thread g√∂revi tetiklendi&quot;
    }

    @GetMapping(&quot;/run-return&quot;)
    @Throws(Exception::class)
    fun triggerRunAndReturn(): String {
        val future = service.runAndReturn()
        return future.get()
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±r</h2>
<pre><code class="language-bash">./mvnw spring-boot:run
# veya
gradle bootRun</code></pre>
<hr />
<h2>üß™ Endpointleri Test Et</h2>
<p>Void g√∂revi tetikle</p>
<pre><code class="language-bash">curl http://localhost:8080/async/run</code></pre>
<p>Sanal thread ba≈ülangƒ±√ß/biti≈ü log‚Äôlarƒ±nƒ± kontrol edin.</p>
<p>Sonu√ß d√∂nd√ºren g√∂revi tetikle</p>
<pre><code class="language-bash">curl http://localhost:8080/async/run-return
# d√∂nen: &quot;Tamamlandƒ±&quot;</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Sanal Thread‚Äôli Asenkron G√∂revler i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Asenkron G√∂revler]]></category>
      <category><![CDATA[Sanal Thread]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-async-virtual-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot AI Entegrasyonu]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-ai</link>
      <description><![CDATA[Mod√ºler, ta≈üƒ±nabilir ve g√∂zlemlenebilir AI i≈ü akƒ±≈ülarƒ± i√ßin Spring AI kullanarak Spring Boot uygulamalarƒ±na AI modellerini nasƒ±l entegre edeceƒüinizi √∂ƒürenin.]]></description>
      <pubDate>Wed, 23 Apr 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-ai</guid>
      <content:encoded><![CDATA[<p>Spring AI, AI m√ºhendisliƒüi i√ßin Spring‚Äôin ta≈üƒ±nabilirlik ve mod√ºler tasarƒ±m ilkelerini AI i≈ü y√ºklerine uygulayan bir √ßer√ßevedir. Tanƒ±dƒ±k Spring kalƒ±plarƒ± ve POJO‚Äôlarƒ± kullanarak AI odaklƒ± uygulamalar geli≈ütirmenizi saƒülar.</p>
<hr />
<h2>üåü Neden Spring AI Kullanƒ±lmalƒ±?</h2>
<ul>
<li>Saƒülayƒ±cƒ±dan baƒüƒ±msƒ±z ta≈üƒ±nabilirlik: Kodunuzu bir kez yazƒ±n, AI saƒülayƒ±cƒ±larƒ± (OpenAI, Anthropic, Azure vb.) arasƒ±nda deƒüi≈ütirmeler yapmadan ge√ßi≈ü yapƒ±n.</li>
<li>POJO tabanlƒ± tasarƒ±m: AI girdi ve √ßƒ±ktƒ±larƒ±nƒ±zƒ± d√ºz Java/Kotlin nesneleri olarak modelleyerek t√ºr g√ºvenliƒüi ve kolay entegrasyon saƒülayƒ±n.</li>
<li>Yapƒ±landƒ±rƒ±lmƒ±≈ü √ßƒ±ktƒ±lar: Model yanƒ±tlarƒ±nƒ± alan nesnelerinize otomatik olarak e≈üleyin.</li>
<li>Vekt√∂r veri deposu entegrasyonu: Chroma, Pinecone, Redis gibi √∂nde gelen vekt√∂r veritabanlarƒ± i√ßin birle≈üik API desteƒüi.</li>
<li>Ara√ß/fonksiyon √ßaƒürƒ±sƒ±: LLM‚Äôlerin ger√ßek zamanlƒ± veri i√ßin √∂zel fonksiyonlarƒ± veya servisleri √ßaƒüƒ±rmasƒ±na izin verin.</li>
<li>G√∂zlemlenebilirlik ve deƒüerlendirme: AI i≈ülemlerini izlemeniz ve hal√ºsinasyonlarƒ± tespit etmeniz i√ßin yerle≈üik metrikler ve deƒüerlendirme ara√ßlarƒ±.</li>
<li>Sohbet soyutlamalarƒ±: WebClient benzeri akƒ±cƒ± bir ChatClient API‚Äôsi ile chat agentlar olu≈üturun.</li>
<li>Retrieval-augmented generation (RAG): Advisorler ve bellek API‚Äôleri ile belgelere dayalƒ± QA ve ge√ßmi≈ü sohbete dayalƒ± sohbeti basitle≈ütirin.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulumu</li>
<li>üê≥ Spring Boot 3+</li>
<li>üîë OpenAI API Anahtarƒ± (√ßevre deƒüi≈ükeni `OPENAI_API_KEY` olarak tanƒ±mlƒ±)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Spring AI OpenAI ba≈ülatƒ±cƒ±sƒ±, Spring Web ve Lombok‚Äôu projenize ekleyin.</p>
<h3>Maven</h3>
<pre><code class="language-xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;
    &lt;artifactId&gt;spring-ai-starter-model-openai&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
    &lt;artifactId&gt;lombok&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
<h3>Gradle</h3>
<pre><code class="language-groovy">plugins {
  id &#39;org.springframework.boot&#39; version &#39;3.2.0&#39;
}

dependencies {
  implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
  implementation &#39;org.springframework.ai:spring-ai-starter-model-openai&#39;
  compileOnly &#39;org.projectlombok:lombok&#39;
  annotationProcessor &#39;org.projectlombok:lombok&#39;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Yapƒ±landƒ±rma</h2>
<p>`application.yml` dosyanƒ±za OpenAI anahtarƒ±nƒ±zƒ± ve ChatClient model ayarlarƒ±nƒ± ekleyin:</p>
<pre><code class="language-yaml">spring:
  ai:
    openai:
      api-key: ${OPENAI_API_KEY}
      chat:
        options:
          model: gpt-4.1-mini</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Servis Katmanƒ±nƒ± Uygulama</h2>
<p>`ChatClient.Builder` ile ChatClient‚Äôi olu≈üturup sarmalayan bir `AIService` sƒ±nƒ±fƒ± yazƒ±n.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.ai.service;

import org.springframework.ai.chat.client.ChatClient;
import org.springframework.stereotype.Service;

@Service
public class AIService {
    private final ChatClient chatClient;

    public AIService(ChatClient.Builder builder) {
        this.chatClient = builder.build();
    }

    public String getJoke(String topic) {
        return chatClient.prompt()
                .user(u -&gt; u.text(&quot;Tell me a joke about {topic}&quot;).param(&quot;topic&quot;, topic))
                .call()
                .content();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.ai.service

import org.springframework.ai.chat.client.ChatClient
import org.springframework.stereotype.Service

@Service
class AIService(builder: ChatClient.Builder) {
    private val chatClient: ChatClient = builder.build()

    fun getJoke(topic: String): String =
        chatClient.prompt()
            .user { it.text(&quot;Tell me a joke about {topic}&quot;).param(&quot;topic&quot;, topic) }
            .call()
            .content()</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: REST Controller Olu≈üturma</h2>
<p>`AIService`‚Äôi HTTP √ºzerinden sunmak i√ßin bir `ChatController` sƒ±nƒ±fƒ± olu≈üturun.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.ai.controller;

import com.example.ai.service.AIService;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class ChatController {

    private final AIService aiService;

    public ChatController(AIService aiService) {
        this.aiService = aiService;
    }

    @GetMapping(&quot;/joke&quot;)
    public String getJoke(@RequestParam(defaultValue = &quot;dogs&quot;) String topic) {
        return aiService.getJoke(topic);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.ai.controller

import com.example.ai.service.AIService
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RequestParam
import org.springframework.web.bind.annotation.RestController

@RestController
class ChatController(private val aiService: AIService) {

    @GetMapping(&quot;/joke&quot;)
    fun getJoke(@RequestParam(defaultValue = &quot;dogs&quot;) topic: String): String =
        aiService.getJoke(topic)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Spring Boot uygulamanƒ±zƒ± ba≈ülatƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run
# veya
gradle bootRun</code></pre>
<hr />
<h2>üß™ Entegrasyonu Test Etme</h2>
<p>HTTP √ºzerinden servisinizi √ßaƒüƒ±rƒ±n:</p>
<pre><code class="language-bash">curl -X GET &quot;http://localhost:8080/joke?topic=dogs&quot;
# AI modelinin d√∂nd√ºrd√ºƒü√º k√∂pek ≈üakasƒ±</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot AI Entegrasyonu i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Spring AI]]></category>
      <category><![CDATA[Yapay Zeka]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-ai-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot JPA Auditing]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-jpa-auditing</link>
      <description><![CDATA[Spring Boot uygulamalarƒ±nda JPA Auditing ile olu≈üturulma/deƒüi≈ütirilme tarihlerini ve kullanƒ±cƒ±larƒ±nƒ± otomatik olarak nasƒ±l yakalayacaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Thu, 10 Apr 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-jpa-auditing</guid>
      <content:encoded><![CDATA[<p>Spring Boot&#39;ta JPA Auditing, bir varlƒ±ƒüƒ±n kim tarafƒ±ndan ve ne zaman olu≈üturulduƒüunu veya deƒüi≈ütirildiƒüini otomatik olarak izlemenizi saƒülar. Bu, denetim kayƒ±tlarƒ±, ge√ßmi≈ü izleme ve hata ayƒ±klama i√ßin olduk√ßa kullanƒ±≈ülƒ±dƒ±r.</p>
<hr />
<h2>üåü Neden JPA Auditing Kullanmalƒ±yƒ±m?</h2>
<ul>
<li>üìÖ `createdDate`, `lastModifiedDate` alanlarƒ±nƒ± otomatik takip edin</li>
<li>üë§ `createdBy`, `modifiedBy` bilgilerini kaydedin</li>
<li>üßº Alanlarƒ± manuel ayarlamadan ka√ßƒ±narak temiz kod yazƒ±n</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Projenize a≈üaƒüƒ±daki baƒüƒ±mlƒ±lƒ±klarƒ± ekleyin:</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">dependencies {
  implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: JPA Auditing √ñzelliƒüini Etkinle≈ütirme</h2>
<p>Ana sƒ±nƒ±fƒ±nƒ±za veya yapƒ±landƒ±rma sƒ±nƒ±fƒ±nƒ±za `@EnableJpaAuditing` ekleyin.</p>
<h3>Java</h3>
<pre><code class="language-java">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;

@SpringBootApplication
@EnableJpaAuditing(auditorAwareRef = &quot;auditorProvider&quot;)
public class DemoApplication {
  public static void main(String[] args) {
    SpringApplication.run(DemoApplication.class, args);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.data.jpa.repository.config.EnableJpaAuditing

@SpringBootApplication
@EnableJpaAuditing(auditorAwareRef = &quot;auditorProvider&quot;)
class DemoApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;DemoApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: AuditorAware Bean&#39;i Olu≈üturun</h2>
<p>Bu bean, Spring&#39;e ge√ßerli kullanƒ±cƒ±yƒ± bildirir. Statik bir kullanƒ±cƒ± √∂rneƒüi a≈üaƒüƒ±da:</p>
<h3>Java</h3>
<pre><code class="language-java">@Configuration
public class AuditingConfig {

  @Bean
  public AuditorAware&lt;String&gt; auditorProvider() {
    return () -&gt; Optional.of(&quot;≈ûuayb&quot;);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">@Configuration
class AuditingConfig {

  @Bean
  fun auditorProvider(): AuditorAware&lt;String&gt; = AuditorAware { Optional.of(&quot;≈ûuayb&quot;) }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Entity Sƒ±nƒ±fƒ±na Anotasyonlarƒ± Ekle</h2>
<p>A≈üaƒüƒ±daki gibi denetim anotasyonlarƒ±nƒ± kullanƒ±n: `@CreatedDate`, `@LastModifiedDate`, vb.</p>
<h3>Java</h3>
<pre><code class="language-java">@Entity
@EntityListeners(AuditingEntityListener.class)
public class Article {

  @Id
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  private Long id;

  private String title;

  @CreatedDate
  private LocalDateTime createdDate;

  @LastModifiedDate
  private LocalDateTime lastModifiedDate;

  @CreatedBy
  private String createdBy;

  @LastModifiedBy
  private String lastModifiedBy;

  // getter &amp; setter
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">@Entity
@EntityListeners(AuditingEntityListener::class)
data class Article(
  @Id
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  val id: Long? = null,

  var title: String? = null,

  @CreatedDate
  var createdDate: LocalDateTime? = null,

  @LastModifiedDate
  var lastModifiedDate: LocalDateTime? = null,

  @CreatedBy
  var createdBy: String? = null,

  @LastModifiedBy
  var lastModifiedBy: String? = null
)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Artƒ±k bir entityi `JpaRepository` ile kaydettiƒüinizde, denetim alanlarƒ± otomatik olarak doldurulacaktƒ±r.</p>
<hr />
<h2>üß™ Test Etme</h2>
<p>Bir entity kaydederek denetim alanlarƒ±nƒ±n otomatik olarak doldurulup doldurulmadƒ±ƒüƒ±nƒ± test edebilirsiniz.</p>
<h3>Java</h3>
<pre><code class="language-java">@SpringBootTest
@AutoConfigureTestDatabase
@Transactional
class ArticleRepositoryTest {

  @Autowired
  private ArticleRepository articleRepository;

  @Test
  void testAuditFieldsAreSet() {
    Article article = new Article();
    article.setTitle(&quot;Test Ba≈ülƒ±ƒüƒ±&quot;);

    Article saved = articleRepository.save(article);

    assertNotNull(saved.getCreatedDate());
    assertNotNull(saved.getLastModifiedDate());
    assertEquals(&quot;≈ûuayb&quot;, saved.getCreatedBy());
    assertEquals(&quot;≈ûuayb&quot;, saved.getLastModifiedBy());
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">@SpringBootTest
@AutoConfigureTestDatabase
@Transactional
class ArticleRepositoryTest {

  @Autowired
  lateinit var articleRepository: ArticleRepository

  @Test
  fun `denetim alanlarƒ± ayarlanmalƒ±`() {
    val article = Article().apply {
      title = &quot;Test Ba≈ülƒ±ƒüƒ±&quot;
    }

    val saved = articleRepository.save(article)

    assertNotNull(saved.createdDate)
    assertNotNull(saved.lastModifiedDate)
    assertEquals(&quot;≈ûuayb&quot;, saved.createdBy)
    assertEquals(&quot;≈ûuayb&quot;, saved.lastModifiedBy)
  }
}</code></pre>
<p>Testlerin doƒüru Spring baƒülamƒ±yla √ßalƒ±≈ütƒ±ƒüƒ±ndan ve denetlemenin testler sƒ±rasƒ±nda etkin olduƒüundan emin olun. Ger√ßek kullanƒ±cƒ±yƒ± kullanƒ±yorsanƒ±z `SecurityContext`&#39;i mock&#39;lamak gerekebilir.</p>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot JPA Auditing i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Spring Data]]></category>
      <category><![CDATA[JPA]]></category>
      <category><![CDATA[Auditing]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-jpa-auditing-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile Test Odaklƒ± Geli≈ütirme]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-tdd</link>
      <description><![CDATA[Spring Boot ile TDD yakla≈üƒ±mƒ±nƒ± uygulamayƒ±; √∂nce test yazarak, i≈ü mantƒ±ƒüƒ±nƒ± geli≈ütirerek ve testlerle kaliteyi garanti altƒ±na alarak √∂ƒürenin.]]></description>
      <pubDate>Wed, 09 Apr 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-tdd</guid>
      <content:encoded><![CDATA[<p>Test Odaklƒ± Geli≈ütirme (TDD), i≈ü mantƒ±ƒüƒ±nƒ± uygulamadan √∂nce testler yazarak saƒülam uygulamalar geli≈ütirmeni saƒülar. Spring Boot ile birim testler yazmak hƒ±zlƒ±, temiz ve etkilidir.</p>
<hr />
<h2>üåü Neden Spring Boot ile TDD?</h2>
<ul>
<li>Hatalarƒ± Erken Yakala: Geli≈ütirme a≈üamasƒ±nda problemleri fark et.</li>
<li>Temiz Tasarƒ±m: Mod√ºler ve test edilebilir kod yapƒ±sƒ± zorunlu olur.</li>
<li>G√ºvenle Refactor Et: Testler deƒüi≈üikliklerde g√ºven saƒülar.</li>
<li>Dok√ºmantasyon: Testler, beklenen davranƒ±≈üƒ± anlatƒ±r.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>≈ûunlara sahip olduƒüundan emin ol:</p>
<ul>
<li>‚òï JDK 17+ kurulu</li>
<li>üì¶ Maven veya Gradle</li>
<li>üî§ Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üß™ Adƒ±m 1: Test Baƒüƒ±mlƒ±lƒ±klarƒ±nƒ± Ekle</h2>
<p>Projene Spring Boot test starter&#39;ƒ±nƒ± ekle.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
  &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">testImplementation &#39;org.springframework.boot:spring-boot-starter-test&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: ƒ∞lk Testini Yaz</h2>
<p>Servisi yazmadan √∂nce basit birim test olu≈ütur.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.tdd;

import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

class GreetingServiceTest {

    @Test
    void shouldReturnGreetingMessage() {
        GreetingService service = new GreetingService();
        String result = service.greet(&quot;World&quot;);
        assertEquals(&quot;Hello, World!&quot;, result);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.tdd

import org.junit.jupiter.api.Assertions.assertEquals
import org.junit.jupiter.api.Test

class GreetingServiceTest {

    @Test
    fun shouldReturnGreetingMessage() {
        val service = GreetingService()
        val result = service.greet(&quot;World&quot;)
        assertEquals(&quot;Hello, World!&quot;, result)
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Servisi Olu≈üturun</h2>
<p>Testi ge√ßecek ≈üekilde `GreetingService` sƒ±nƒ±fƒ±nƒ± olu≈ütur.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.tdd;

public class GreetingService {
    public String greet(String name) {
        return &quot;Hello, &quot; + name + &quot;!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.tdd

class GreetingService {
    fun greet(name: String): String {
        return &quot;Hello, $name!&quot;
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± Test Et</h2>
<p>Testleri √ßalƒ±≈ütƒ±rmak i√ßin a≈üaƒüƒ±daki komutu kullan:</p>
<pre><code class="language-bash">./mvnw test</code></pre>
<p>veya</p>
<pre><code class="language-bash">gradle test</code></pre>
<p>Test ba≈üarƒ±yla ge√ßmeli ‚úÖ</p>
<hr />
<h3>Refactor ve Tekrarla</h3>
<p>Test ge√ßtikten sonra kodu g√ºvenle refactor edebilirsin. TDD d√∂ng√ºs√º ≈ü√∂yledir:</p>
<p>1. Red ‚Äì Ba≈üarƒ±sƒ±z test yaz 2. Green ‚Äì Testi ge√ßir 3. Refactor ‚Äì Kodu temizle</p>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile Test Odaklƒ± Geli≈ütirme i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[TDD]]></category>
      <category><![CDATA[Test]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-tdd-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Circuit Breaker]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-circuit-breaker</link>
      <description><![CDATA[Spring Boot uygulamalarƒ±nda Circuit Breaker kullanƒ±mƒ±nƒ± √∂ƒürenerek mikro hizmetlerin dayanƒ±klƒ±lƒ±ƒüƒ±nƒ± artƒ±rƒ±n.]]></description>
      <pubDate>Thu, 13 Mar 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-circuit-breaker</guid>
      <content:encoded><![CDATA[<p>Spring Boot Circuit Breaker, mikro hizmetler mimarisinde ardƒ±≈üƒ±k hatalarƒ±n √∂nlenmesi i√ßin kullanƒ±lan bir hata toleransƒ± mekanizmasƒ±dƒ±r. Hatalarƒ± algƒ±layarak ve saƒülƒ±ksƒ±z hizmetlere a≈üƒ±rƒ± istekleri durdurarak uygulamalarƒ±n hatalarƒ± zarif bir ≈üekilde y√∂netmesine yardƒ±mcƒ± olur. Bu kƒ±lavuz, Spring Boot&#39;ta Resilience4j kullanarak Circuit Breaker uygulamasƒ±nƒ± adƒ±m adƒ±m a√ßƒ±klamaktadƒ±r.</p>
<hr />
<h2>üåü Neden Circuit Breaker Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Mikro hizmetlerde zincirleme hatalarƒ± √∂nler.</li>
<li>Uygulama dayanƒ±klƒ±lƒ±ƒüƒ±nƒ± artƒ±rƒ±r, a≈üƒ±rƒ± hatalƒ± istekleri durdurur.</li>
<li>Hizmet saƒülƒ±ƒüƒ± geri kazandƒ±ƒüƒ±nda otomatik olarak iyile≈üir.</li>
<li>Gereksiz bekleme s√ºrelerini √∂nleyerek gecikmeyi azaltƒ±r.</li>
<li>Hatalarƒ± y√∂netmek i√ßin yapƒ±landƒ±rƒ±labilir yeniden deneme stratejileri sunar.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üìû Maven veya Gradle kurulu</li>
<li>üåê Spring Boot &amp; Spring Cloud</li>
<li>üßê Circuit Breaker davranƒ±≈üƒ±nƒ± g√∂stermek i√ßin bir REST API</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<h3>Maven Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
  &lt;artifactId&gt;spring-cloud-starter-circuitbreaker-resilience4j&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<h3>Gradle Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-groovy">implementation &#39;org.springframework.cloud:spring-cloud-starter-circuitbreaker-resilience4j&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Circuit Breaker √ñzelliklerini Yapƒ±landƒ±rma</h2>
<p>`application.yml` dosyanƒ±zda Circuit Breaker ayarlarƒ±nƒ± tanƒ±mlayƒ±n.</p>
<pre><code class="language-yaml">resilience4j:
  circuitbreaker:
    instances:
      externalService:
        failure-rate-threshold: 50
        slow-call-rate-threshold: 50
        slow-call-duration-threshold: 2000ms
        permitted-number-of-calls-in-half-open-state: 3
        sliding-window-size: 10
        minimum-number-of-calls: 5
        wait-duration-in-open-state: 5s</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Circuit Breaker Kullanarak Bir REST Servisi Uygulama</h2>
<h3>Java</h3>
<pre><code class="language-java">package com.example.circuitbreaker.service;

import io.github.resilience4j.circuitbreaker.annotation.CircuitBreaker;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

@Service
public class ExternalService {

    private final RestTemplate restTemplate = new RestTemplate();

    @CircuitBreaker(name = &quot;externalService&quot;, fallbackMethod = &quot;fallbackResponse&quot;)
    public String callExternalAPI() {
        return restTemplate.getForObject(&quot;http://unreliable-service/api/data&quot;, String.class);
    }

    public String fallbackResponse(Exception e) {
        return &quot;Fallback response: Service is unavailable!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.circuitbreaker.service

import io.github.resilience4j.circuitbreaker.annotation.CircuitBreaker
import org.springframework.stereotype.Service
import org.springframework.web.client.RestTemplate

@Service
class ExternalService {
    private val restTemplate = RestTemplate()

    @CircuitBreaker(name = &quot;externalService&quot;, fallbackMethod = &quot;fallbackResponse&quot;)
    fun callExternalAPI(): String {
        return restTemplate.getForObject(&quot;http://unreliable-service/api/data&quot;, String::class.java) ?: &quot;&quot;
    }

    fun fallbackResponse(e: Exception): String {
        return &quot;Fallback response: Service is unavailable!&quot;
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Bir REST Controller Olu≈üturun</h2>
<h3>Java</h3>
<pre><code class="language-java">package com.example.circuitbreaker.controller;

import com.example.circuitbreaker.service.ExternalService;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping(&quot;/api&quot;)
public class CircuitBreakerController {

    private final ExternalService externalService;

    public CircuitBreakerController(ExternalService externalService) {
        this.externalService = externalService;
    }

    @GetMapping(&quot;/data&quot;)
    public String fetchData() {
        return externalService.callExternalAPI();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.circuitbreaker.controller

import com.example.circuitbreaker.service.ExternalService
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequestMapping(&quot;/api&quot;)
class CircuitBreakerController(private val externalService: ExternalService) {

    @GetMapping(&quot;/data&quot;)
    fun fetchData(): String {
        return externalService.callExternalAPI()
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± ba≈ülatƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<hr />
<h2>üß™ Circuit Breaker&#39;ƒ± Test Etme</h2>
<p>Circuit Breaker‚Äôƒ± test etmek i√ßin:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/data</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Circuit Breaker i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Spring Cloud]]></category>
      <category><![CDATA[Circuit Breaker]]></category>
      <category><![CDATA[Mikroservis]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-circuit-breaker-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Eureka Server]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-eureka-server</link>
      <description><![CDATA[Mikro hizmet mimarisinde servis ke≈üfi i√ßin Spring Boot Eureka serverƒ±n nasƒ±l kurulacaƒüƒ±nƒ± ve yapƒ±landƒ±rƒ±lacaƒüƒ±nƒ± √∂ƒürenin.]]></description>
      <pubDate>Sun, 23 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-eureka-server</guid>
      <content:encoded><![CDATA[<p>Spring Boot Eureka Server, mikroservis mimarisinde servis kaydƒ± ve ke≈üfi saƒülayan bir servis kayƒ±t merkezi olarak √ßalƒ±≈üƒ±r. Mikroservislerin kendilerini otomatik olarak kaydetmelerine ve diƒüer servisleri dinamik olarak ke≈üfetmelerine olanak tanƒ±r. Bu kƒ±lavuzda, Spring Boot ile Eureka serverƒ±n nasƒ±l kurulacaƒüƒ±nƒ± ve yapƒ±landƒ±rƒ±lacaƒüƒ±nƒ± √∂ƒüreneceksiniz.</p>
<hr />
<h2>üåü Neden Eureka Server Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Servis Ke≈üfi: Mikro servislerin otomatik olarak kaydolmasƒ±nƒ± ve ke≈üfedilmesini saƒülar.</li>
<li>Y√ºk Dengeleme: Ribbon ile istemci taraflƒ± y√ºk dengeleme saƒülar.</li>
<li>Hata Toleransƒ±: Bir servis ba≈üarƒ±sƒ±z olursa alternatif √∂rnekleri bulmaya yardƒ±mcƒ± olur.</li>
<li>√ñl√ßeklenebilirlik: Mikroserivslerin kolayca √∂l√ßeklenmesini saƒülar.</li>
<li>Spring Cloud Entegrasyonu: Spring Boot uygulamalarƒ±yla sorunsuz √ßalƒ±≈üƒ±r.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±dakilerin kurulu olduƒüundan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºkl√º</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<h3>Maven Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<h3>Gradle Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-groovy">implementation &#39;org.springframework.cloud:spring-cloud-starter-netflix-eureka-server&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Eureka Sunucu Uygulamasƒ±nƒ± Olu≈üturun</h2>
<h3>Java</h3>
<pre><code class="language-java">package com.example.eurekaserver;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;

@SpringBootApplication
@EnableEurekaServer
public class EurekaServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(EurekaServerApplication.class, args);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.eurekaserver

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer

@SpringBootApplication
@EnableEurekaServer
class EurekaServerApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;EurekaServerApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Eureka Server&#39;ƒ± Yapƒ±landƒ±rma</h2>
<p>Bir `application.yml` dosyasƒ± olu≈üturun ve a≈üaƒüƒ±daki yapƒ±landƒ±rmayƒ± ekleyin:</p>
<pre><code class="language-yaml">server:
  port: 8761
spring:
  application:
    name: eureka-server
eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
  server:
    wait-time-in-ms-when-sync-empty: 5</code></pre>
<p>&gt; Not: Eureka Sunucusu kendisini kaydetmez.</p>
<hr />
<h2>‚ñ∂Ô∏è Eureka Server&#39;ƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Eureka Server uygulamasƒ±nƒ± ba≈ülatƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<p>Eureka Server kontrol paneline eri≈ümek i√ßin:</p>
<pre><code class="language-bash">http://localhost:8761/</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Bir ƒ∞stemci Uygulamasƒ±nƒ± Kaydetme</h2>
<h3>Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h3>
<h3>Maven:</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<h3>Gradle:</h3>
<pre><code class="language-groovy">implementation &#39;org.springframework.cloud:spring-cloud-starter-netflix-eureka-client&#39;</code></pre>
<h3>ƒ∞stemci Uygulama Yapƒ±landƒ±rmasƒ±</h3>
<p>ƒ∞stemcinin `application.yml` dosyasƒ±na a≈üaƒüƒ±daki yapƒ±landƒ±rmayƒ± ekleyin:</p>
<pre><code class="language-yaml">spring:
  application:
    name: eureka-client
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/</code></pre>
<h3>ƒ∞stemci Uygulama Kodu</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.eurekaclient;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
@RequestMapping(&quot;/client&quot;)
public class EurekaClientApplication {

    @GetMapping
    public String getClientMessage() {
        return &quot;Merhaba, Eureka ƒ∞stemcisi!&quot;;
    }

    public static void main(String[] args) {
        SpringApplication.run(EurekaClientApplication.class, args);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.eurekaclient

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@SpringBootApplication
@RestController
@RequestMapping(&quot;/client&quot;)
class EurekaClientApplication {

    @GetMapping
    fun getClientMessage(): String {
        return &quot;Merhaba, Eureka ƒ∞stemcisi!&quot;
    }
}

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;EurekaClientApplication&gt;(*args)
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è ƒ∞stemci Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Eureka ƒ∞stemci uygulamasƒ±nƒ± ba≈ülatƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<p>Eureka Server&#39;a kayƒ±tlƒ± olup olmadƒ±ƒüƒ±nƒ± kontrol etmek i√ßin ≈üu adresi ziyaret edin:</p>
<pre><code class="language-bash">http://localhost:8761/</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Eureka Server i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Spring Cloud]]></category>
      <category><![CDATA[Eureka Server]]></category>
      <category><![CDATA[Mikroservis]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-eureka-server-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Config Server]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-config-server</link>
      <description><![CDATA[Spring Boot Config Server kullanarak merkezi yapƒ±landƒ±rma y√∂netimini nasƒ±l ger√ßekle≈ütireceƒüinizi √∂ƒürenin.]]></description>
      <pubDate>Sat, 22 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-config-server</guid>
      <content:encoded><![CDATA[<p>Spring Boot Config Server, daƒüƒ±tƒ±lmƒ±≈ü uygulamalar i√ßin merkezi yapƒ±landƒ±rma y√∂netimi saƒülar ve hizmetlerin yeniden ba≈ülatƒ±lmasƒ±na gerek kalmadan dinamik yapƒ±landƒ±rma g√ºncellemelerine olanak tanƒ±r. Bu kƒ±lavuz, Spring Boot Config Server&#39;ƒ± nasƒ±l kuracaƒüƒ±nƒ±zƒ± ve etkin bir ≈üekilde kullanacaƒüƒ±nƒ±zƒ± a√ßƒ±klar.</p>
<hr />
<h2>üåü Neden Config Server Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Merkezi Yapƒ±landƒ±rma: Uygulama ayarlarƒ±nƒ± tek bir yerde y√∂netin.</li>
<li>Dinamik G√ºncellemeler: Yapƒ±landƒ±rmalarƒ± hizmetleri yeniden ba≈ülatmadan g√ºncelleyin.</li>
<li>Environment Profilleri: Geli≈ütirme, test ve √ºretim ortamlarƒ± i√ßin farklƒ± yapƒ±landƒ±rmalarƒ± destekler.</li>
<li>G√ºvenlik ve Eri≈üim Kontrol√º: Hassas yapƒ±landƒ±rmalarƒ± g√ºvenli bir ≈üekilde saklayƒ±n.</li>
<li>Git Entegrasyonu: Yapƒ±landƒ±rma s√ºr√ºmlerini y√∂netmek ve izlemek i√ßin Git kullanƒ±n.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±daki bile≈üenlerin sisteminizde y√ºkl√º olduƒüundan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºkl√º</li>
<li>üìÅ Git Deposu (Yapƒ±landƒ±rmalarƒ± saklamak i√ßin)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Spring Cloud Config Server i√ßin gerekli baƒüƒ±mlƒ±lƒ±klarƒ± ekleyin.</p>
<h3>Maven Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<h3>Gradle Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-groovy">implementation &#39;org.springframework.cloud:spring-cloud-config-server&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Config Server Uygulamasƒ±nƒ± Olu≈üturma</h2>
<h3>Java</h3>
<pre><code class="language-java">package com.example.configserver;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.config.server.EnableConfigServer;

@SpringBootApplication
@EnableConfigServer
public class ConfigServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(ConfigServerApplication.class, args);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.configserver

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.cloud.config.server.EnableConfigServer

@SpringBootApplication
@EnableConfigServer
class ConfigServerApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;ConfigServerApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Config Server&#39;ƒ± Yapƒ±landƒ±rma</h2>
<p>Config ayarlarƒ±nƒ± saklamak i√ßin Git deposunu belirten bir `application.yml` dosyasƒ± olu≈üturun.</p>
<pre><code class="language-yaml">server:
  port: 8888
spring:
  cloud:
    config:
      server:
        git:
          uri: https://github.com/example/config-repo
          default-label: main</code></pre>
<p>&gt; Not: `https://github.com/example/config-repo` adresini kendi Git deponuzla deƒüi≈ütirin.</p>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Konfig√ºrasyon Deposu Olu≈üturma</h2>
<p>Git deposunda (`config-repo`) bir `application.yml` dosyasƒ± olu≈üturun:</p>
<pre><code class="language-yaml">config.key: &#39;Merhaba, Config Server!&#39;</code></pre>
<p>Dosyayƒ± ekleyip g√∂nderin:</p>
<pre><code class="language-bash">git add application.yml
git commit -m &quot;Konfig√ºrasyon dosyasƒ± eklendi&quot;
git push origin main</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Config Server&#39;ƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Config Server uygulamasƒ±nƒ± ba≈ülatƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<p>Config Server&#39;ƒ±n √ßalƒ±≈ütƒ±ƒüƒ±nƒ± doƒürulamak i√ßin ≈üu komutu √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8888/application/default</code></pre>
<p>Beklenen √áƒ±ktƒ±:</p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;application&quot;,
  &quot;profiles&quot;: [&quot;default&quot;],
  &quot;propertySources&quot;: [
    {
      &quot;name&quot;: &quot;https://github.com/example/config-repo/application.yml&quot;,
      &quot;source&quot;: {
        &quot;config.key&quot;: &quot;Merhaba, Config Server!&quot;
      }
    }
  ]
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: ƒ∞stemci Uygulamayƒ± Yapƒ±landƒ±rma</h2>
<h3>Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleme</h3>
<h3>Maven:</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<h3>Gradle:</h3>
<pre><code class="language-groovy">implementation &#39;org.springframework.cloud:spring-cloud-starter-config&#39;</code></pre>
<h3>ƒ∞stemci Uygulama Yapƒ±landƒ±rmasƒ±</h3>
<p>ƒ∞stemci uygulamanƒ±n `bootstrap.yml` dosyasƒ±na a≈üaƒüƒ±daki ayarlarƒ± ekleyin:</p>
<pre><code class="language-yaml">spring:
  application:
    name: config-client
  cloud:
    config:
      uri: http://localhost:8888</code></pre>
<h3>ƒ∞stemci Uygulama Kodu</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.configclient;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.beans.factory.annotation.Value;

@SpringBootApplication
@RestController
@RequestMapping(&quot;/config&quot;)
public class ConfigClientApplication {

  @Value(&quot;${config.key:not found}&quot;)
  private String configValue;

  @GetMapping
  public String getConfigValue() {
    return &quot;Konfig√ºrasyon Deƒüeri: &quot; + configValue;
  }

  public static void main(String[] args) {
    SpringApplication.run(ConfigClientApplication.class, args);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.configclient

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController
import org.springframework.beans.factory.annotation.Value

@SpringBootApplication
@RestController
@RequestMapping(&quot;/config&quot;)
class ConfigClientApplication {

    @Value(&quot;\${config.key:not found}&quot;)
    private lateinit var configValue: String

    @GetMapping
    fun getConfigValue(): String {
        return &quot;Konfig√ºrasyon Deƒüeri: $configValue&quot;
    }
}

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;ConfigClientApplication&gt;(*args)
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è ƒ∞stemci Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>ƒ∞stemci uygulamasƒ±nƒ± ba≈ülatmak i√ßin:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<p>Config Server&#39;dan konfig√ºrasyonu almak i√ßin:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8080/config</code></pre>
<p>Beklenen √áƒ±ktƒ±:</p>
<pre><code class="language-plaintext">Konfig√ºrasyon Deƒüeri: Merhaba, Config Server!</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Config Server i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Spring Cloud]]></category>
      <category><![CDATA[Config Server]]></category>
      <category><![CDATA[Mikroservis]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-config-server-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Docker Entegrasyonu]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-docker</link>
      <description><![CDATA[Spring Boot uygulamalarƒ±nƒ± Docker kullanarak Buildpacks ve Jib ile nasƒ±l olu≈üturup daƒüƒ±tabileceƒüinizi √∂ƒürenin.]]></description>
      <pubDate>Fri, 21 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-docker</guid>
      <content:encoded><![CDATA[<p>Spring Boot, Docker, Buildpacks ve Jib kullanarak uygulamalarƒ± verimli bir ≈üekilde konteynerle≈ütirmek i√ßin birden fazla y√∂ntem sunar. Bu kƒ±lavuz, Spring Boot uygulamalarƒ±nƒ± Docker kullanarak olu≈üturma ve daƒüƒ±tma s√ºre√ßlerini ele almaktadƒ±r.</p>
<hr />
<h2>üåü Neden Spring Boot ƒ∞√ßin Docker Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Ta≈üƒ±nabilir Daƒüƒ±tƒ±m: Uygulamalarƒ± farklƒ± ortamlar arasƒ±nda tutarlƒ± bir ≈üekilde √ßalƒ±≈ütƒ±rƒ±n.</li>
<li>√ñl√ßeklenebilirlik: Konteynerle≈ütirilmi≈ü uygulamalarƒ± kolayca √∂l√ßeklendirin ve y√∂netin.</li>
<li>Hafif ve Verimli: Kaynak kullanƒ±mƒ±nƒ± optimize ederek gereksiz y√ºk√º azaltƒ±n.</li>
<li>DevOps Uyumlu: CI/CD pipeline hatlarƒ±na sorunsuz ≈üekilde entegre edin.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±daki bile≈üenlere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Geli≈ütirme Kiti (JDK) 17+</li>
<li>üì¶ Maven veya Gradle</li>
<li>üê≥ Docker y√ºkl√º ve √ßalƒ±≈üƒ±r durumda</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Docker desteƒüini etkinle≈ütirmek i√ßin Spring Boot Maven Plugin, Jib Plugin ve Spring Boot Web Starter eklentilerini yapƒ±landƒ±rma dosyanƒ±za ekleyin.</p>
<h3>Maven Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;com.google.cloud.tools&lt;/groupId&gt;
            &lt;artifactId&gt;jib-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;3.3.2&lt;/version&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
<h3>Gradle Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-groovy">plugins {
    id &#39;org.springframework.boot&#39; version &#39;3.2.0&#39;
    id &#39;com.google.cloud.tools.jib&#39; version &#39;3.3.2&#39;
}

dependencies {
    implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Basit Bir Spring Boot Uygulamasƒ± Olu≈üturun</h2>
<p>Docker konteyneri i√ßinde daƒüƒ±tƒ±lacak bir REST u√ß noktasƒ± tanƒ±mlayƒ±n.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.docker;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
public class DockerApplication {

    public static void main(String[] args) {
        SpringApplication.run(DockerApplication.class, args);
    }

    @GetMapping(&quot;/hello&quot;)
    public String hello() {
        return &quot;Docker √ºzerinde √ßalƒ±≈üan Spring Boot uygulamasƒ±ndan merhaba!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.docker

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RestController

@SpringBootApplication
@RestController
class DockerApplication {

    @GetMapping(&quot;/hello&quot;)
    fun hello(): String = &quot;Docker √ºzerinde √ßalƒ±≈üan Spring Boot uygulamasƒ±ndan merhaba!&quot;
}

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;DockerApplication&gt;(*args)
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Adƒ±m 3: Docker ƒ∞majƒ± Olu≈üturma ve √áalƒ±≈ütƒ±rma</h2>
<h3>Se√ßenek 1: Buildpacks Kullanarak</h3>
<p>Spring Boot, Buildpacks ile `Dockerfile` kullanmadan Docker imajlarƒ± olu≈üturmayƒ± destekler.</p>
<pre><code class="language-bash">mvn spring-boot:build-image</code></pre>
<pre><code class="language-bash">gradle bootBuildImage</code></pre>
<p>Konteyneri √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">docker run --rm -p 8080:8080 myproject:0.0.1-SNAPSHOT</code></pre>
<hr />
<h3>Se√ßenek 2: Jib Kullanarak</h3>
<p>Jib, Docker daemon olmadan optimize edilmi≈ü konteyner imajlarƒ± olu≈üturmayƒ± saƒülar.</p>
<pre><code class="language-bash">mvn jib:dockerBuild</code></pre>
<pre><code class="language-bash">gradle jibDockerBuild</code></pre>
<p>Jib ile olu≈üturulan konteyneri √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">docker run --rm -p 8080:8080 myproject:0.0.1-SNAPSHOT</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Konteyner √ßalƒ±≈ütƒ±rƒ±ldƒ±ktan sonra, REST API&#39;yi test edin:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8080/hello</code></pre>
<p>Beklenen √áƒ±ktƒ±:</p>
<pre><code class="language-plaintext">Docker √ºzerinde √ßalƒ±≈üan Spring Boot uygulamasƒ±ndan merhaba!</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Docker Entegrasyonu i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Docker]]></category>
      <category><![CDATA[Konteynerizasyon]]></category>
      <category><![CDATA[Jib]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-docker-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Kubernetes Entegrasyonu]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-kubernetes</link>
      <description><![CDATA[Spring Boot uygulamalarƒ±nƒ± Kubernetes √ºzerinde nasƒ±l √∂l√ßeklenebilir ve konteyner tabanlƒ± olarak daƒüƒ±tabileceƒüinizi √∂ƒürenin.]]></description>
      <pubDate>Fri, 21 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-kubernetes</guid>
      <content:encoded><![CDATA[<p>Spring Boot, Kubernetes ile sorunsuz bir ≈üekilde b√ºt√ºnle≈üerek konteynerle≈ütirilmi≈ü, √∂l√ßeklenebilir uygulamalar olu≈üturmanƒ±za olanak tanƒ±r. Bu rehberde, Spring Boot uygulamalarƒ±nƒ±n Kubernetes k√ºmesi i√ßinde nasƒ±l daƒüƒ±tƒ±lacaƒüƒ±nƒ± ve y√∂netileceƒüini √∂ƒüreneceksiniz.</p>
<hr />
<h2>üåü Neden Spring Boot ƒ∞√ßin Kubernetes Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>√ñl√ßeklenebilirlik: Trafiƒüe g√∂re uygulamalarƒ± otomatik olarak √∂l√ßekleyin.</li>
<li>Kendi Kendine ƒ∞yile≈üme: Kubernetes, ba≈üarƒ±sƒ±z olan konteynerleri otomatik olarak yeniden ba≈ülatƒ±r.</li>
<li>Deklaratif Yapƒ±landƒ±rma: YAML dosyalarƒ±yla altyapƒ±nƒ±zƒ± kolayca y√∂netin.</li>
<li>Y√ºk Dengeleme &amp; Servis Ke≈üfi: Gelen trafiƒüi etkin bir ≈üekilde y√∂nlendirin.</li>
<li>Verimli Kaynak Kullanƒ±mƒ±: CPU ve bellek t√ºketimini dinamik olarak optimize edin.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±daki ara√ßlarƒ±n sisteminizde kurulu olduƒüundan emin olun:</p>
<ul>
<li>‚òï Java Geli≈ütirme Kiti (JDK) 17+</li>
<li>üì¶ Maven veya Gradle</li>
<li>üõ† Docker y√ºkl√º ve √ßalƒ±≈üƒ±r durumda</li>
<li>üåê Kubernetes K√ºmesi (Minikube veya AWS EKS, GKE, AKS gibi bulut servis saƒülayƒ±cƒ±larƒ±)</li>
<li>üõ† kubectl komut satƒ±rƒ± aracƒ±</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Spring Boot Web ve Actuator baƒüƒ±mlƒ±lƒ±klarƒ±nƒ± ekleyerek uygulamanƒ±n saƒülƒ±k durumu apilerini aktif edin.</p>
<h3>Maven Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
<h3>Gradle Yapƒ±landƒ±rmasƒ±:</h3>
<pre><code class="language-groovy">dependencies {
    implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;
    implementation &#39;org.springframework.boot:spring-boot-starter-actuator&#39;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Basit Bir Spring Boot Uygulamasƒ± Olu≈üturun</h2>
<p>Kubernetes √ºzerinde √ßalƒ±≈ütƒ±rƒ±lacak bir REST endpoint olu≈üturun.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.kubernetes;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
public class KubernetesApplication {

    public static void main(String[] args) {
        SpringApplication.run(KubernetesApplication.class, args);
    }

    @GetMapping(&quot;/hello&quot;)
    public String hello() {
        return &quot;Merhaba! Spring Boot Kubernetes √ºzerinde √ßalƒ±≈üƒ±yor.&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.kubernetes

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RestController

@SpringBootApplication
@RestController
class KubernetesApplication {

    @GetMapping(&quot;/hello&quot;)
    fun hello(): String = &quot;Merhaba! Spring Boot Kubernetes √ºzerinde √ßalƒ±≈üƒ±yor.&quot;
}

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;KubernetesApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Kubernetes Daƒüƒ±tƒ±mƒ± ve Servisi Tanƒ±mlayƒ±n</h2>
<p>deployment.yaml dosyasƒ±nƒ± olu≈üturun:</p>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-boot-app
spec:
  replicas: 2
  selector:
    matchLabels:
      app: spring-boot-app
  template:
    metadata:
      labels:
        app: spring-boot-app
    spec:
      containers:
        - name: spring-boot-app
          image: myproject:0.0.1-SNAPSHOT
          ports:
            - containerPort: 8080</code></pre>
<p>service.yaml dosyasƒ±nƒ± olu≈üturun:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: spring-boot-service
spec:
  type: LoadBalancer
  selector:
    app: spring-boot-app
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8080</code></pre>
<p>YAML dosyalarƒ±nƒ± Kubernetes k√ºmesine uygulayƒ±n:</p>
<pre><code class="language-bash">kubectl apply -f deployment.yaml
kubectl apply -f service.yaml</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Daƒüƒ±tƒ±m tamamlandƒ±ktan sonra servis IP adresini alƒ±n:</p>
<pre><code class="language-bash">kubectl get services</code></pre>
<p>U√ß noktayƒ± test edin:</p>
<pre><code class="language-bash">curl -X GET http://servis-adresi/hello</code></pre>
<p>Beklenen √áƒ±ktƒ±:</p>
<pre><code class="language-plaintext">Merhaba! Spring Boot Kubernetes √ºzerinde √ßalƒ±≈üƒ±yor.</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Kubernetes Entegrasyonu i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Kubernetes]]></category>
      <category><![CDATA[Mikroservis]]></category>
      <category><![CDATA[Konteynerizasyon]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-kubernetes-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Asenkron G√∂revler]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-async-tasks</link>
      <description><![CDATA[Spring Boot ile @Async kullanarak g√∂revleri ana threadi engellemeden asenkron olarak nasƒ±l √ßalƒ±≈ütƒ±racaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Thu, 20 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-async-tasks</guid>
      <content:encoded><![CDATA[<p>Spring Boot, `@Async` anotasyonu ile arka planda asenkron g√∂revler √ßalƒ±≈ütƒ±rmayƒ± kolayla≈ütƒ±rƒ±r. Bu, ana threadi engellemeden g√∂revleri √ßalƒ±≈ütƒ±rarak uygulamanƒ±n performansƒ±nƒ± artƒ±rmak ve yanƒ±t s√ºresini optimize etmek i√ßin kullanƒ±lƒ±r.</p>
<hr />
<h2>üåü Neden Spring Boot&#39;ta @Async Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Engellenmeyen √áalƒ±≈ütƒ±rma: G√∂revleri ana thread&#39;i bekletmeden √ßalƒ±≈ütƒ±rƒ±r.</li>
<li>Geli≈ütirilmi≈ü Performans: Baƒüƒ±msƒ±z g√∂revleri paralel olarak y√ºr√ºt√ºr.</li>
<li>Daha ƒ∞yi √ñl√ßeklenebilirlik: Diƒüer s√ºre√ßler i√ßin kaynaklarƒ± serbest bƒ±rakƒ±r.</li>
<li>Kolay Entegrasyon: Spring Boot‚Äôun baƒüƒ±mlƒ±lƒ±k enjeksiyonu ve ya≈üam d√∂ng√ºs√º y√∂netimiyle sorunsuz √ßalƒ±≈üƒ±r.</li>
</ul>
<hr />
<h2>üåü √ñnko≈üullar</h2>
<p>≈ûu gereksinimlere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Asenkron i≈ülemleri etkinle≈ütirmek i√ßin spring-boot-starter-web baƒüƒ±mlƒ±lƒ±ƒüƒ±nƒ± `pom.xml` veya `build.gradle` dosyanƒ±za ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Uygulamanƒ±zda Asenkron ƒ∞≈ülemi Etkinle≈ütirin</h2>
<p>Ana uygulama sƒ±nƒ±fƒ±nƒ±za `@EnableAsync` anotasyonunu ekleyerek asenkron √ßalƒ±≈ümayƒ± etkinle≈ütirin.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.async;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableAsync;

@SpringBootApplication
@EnableAsync
public class AsyncApplication {
    public static void main(String[] args) {
        SpringApplication.run(AsyncApplication.class, args);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.async

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.scheduling.annotation.EnableAsync

@SpringBootApplication
@EnableAsync
class AsyncApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;AsyncApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Asenkron Bir G√∂rev Tanƒ±mlayƒ±n</h2>
<p>`@Async` anotasyonunu kullanarak bir asenkron metot tanƒ±mlayƒ±n.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.async;

import org.springframework.scheduling.annotation.Async;
import org.springframework.stereotype.Service;
import java.time.LocalTime;

@Service
public class AsyncTask {

    @Async
    public void runTask() {
        System.out.println(&quot;Asenkron g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: &quot; + LocalTime.now());
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.async

import org.springframework.scheduling.annotation.Async
import org.springframework.stereotype.Service
import java.time.LocalTime

@Service
class AsyncTask {

    @Async
    fun runTask() {
        println(&quot;Asenkron g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: ${LocalTime.now()}&quot;)
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Asenkron G√∂revleri Tetiklemek i√ßin Bir Controller Olu≈üturun</h2>
<p>Bir REST controller olu≈üturarak asenkron i≈ülemi tetikleyin.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.async;

import org.springframework.web.bind.annotation.*;
import lombok.RequiredArgsConstructor;

@RestController
@RequestMapping(&quot;/async&quot;)
@RequiredArgsConstructor
public class AsyncController {

    private final AsyncTask asyncTask;

    @GetMapping(&quot;/run&quot;)
    public String triggerAsyncTask() {
        asyncTask.runTask();
        return &quot;Asenkron g√∂rev tetiklendi!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.async

import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/async&quot;)
class AsyncController(
    private val asyncTask: AsyncTask
) {
    @GetMapping(&quot;/run&quot;)
    fun triggerAsyncTask(): String {
        asyncTask.runTask()
        return &quot;Asenkron g√∂rev tetiklendi!&quot;
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Spring Boot uygulamasƒ±nƒ± √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>Veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<hr />
<h2>üß™ Asenkron G√∂revi Test Etme</h2>
<h3>Asenkron G√∂revi Tetikleme:</h3>
<pre><code class="language-bash">curl -X GET http://localhost:8080/async/run</code></pre>
<h3>Beklenen Konsol √áƒ±ktƒ±sƒ±:</h3>
<pre><code class="language-plaintext">Asenkron g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: 12:00:01</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Asenkron G√∂revler i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Asenkron G√∂revler]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-async-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Planlanmƒ±≈ü G√∂revler]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-scheduled-tasks</link>
      <description><![CDATA[Spring Boot ile @Scheduled anotasyonunu kullanarak belirli aralƒ±klarla veya cron ifadeleriyle arka plan g√∂revlerini nasƒ±l √ßalƒ±≈ütƒ±racaƒüƒ±nƒ±zƒ± √∂ƒürenin.]]></description>
      <pubDate>Thu, 20 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-scheduled-tasks</guid>
      <content:encoded><![CDATA[<p>Spring Boot, `@Scheduled` anotasyonu ile arka planda √ßalƒ±≈üan g√∂revleri kolayca planlamanƒ±zƒ± saƒülar. Bu y√∂ntem, periyodik g√∂revleri, otomasyon s√ºre√ßlerini ve toplu i≈ülemleri manuel m√ºdahaleye gerek kalmadan y√ºr√ºtmek i√ßin idealdir.</p>
<hr />
<h2>üåü Neden Spring Boot @Scheduled Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>G√∂revleri Otomatikle≈ütirin: ƒ∞≈ülemleri belirli aralƒ±klarla √ßalƒ±≈ütƒ±rƒ±n.</li>
<li>Kaynaklarƒ± Verimli Kullanƒ±n: Ana i≈ü par√ßacƒ±klarƒ±nƒ± bloklamadan g√∂revleri planlayƒ±n.</li>
<li>Farklƒ± Zamanlama Se√ßenekleri: Sabit oranlƒ±, sabit gecikmeli veya cron tabanlƒ± zamanlamalar.</li>
<li>Spring Boot Entegrasyonu: Uygulama ya≈üam d√∂ng√ºs√ºyle sorunsuz √ßalƒ±≈üƒ±r.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>≈ûunlara sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Cron desteƒüini etkinle≈ütirmek i√ßin `spring-boot-starter-web` baƒüƒ±mlƒ±lƒ±ƒüƒ±nƒ± `pom.xml` veya `build.gradle` dosyanƒ±za ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;</code></pre>
<p>&gt; Neden `spring-boot-starter-web`? &gt; `@Scheduled` anotasyonu √ßalƒ±≈üƒ±rken Spring Context gerektirir. `spring-boot-starter-web` eklenerek uygulama ya≈üam d√∂ng√ºs√ºn√ºn doƒüru ≈üekilde y√∂netilmesi saƒülanƒ±r.</p>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Cron Etkinle≈ütirme</h2>
<p>Cron desteƒüini etkinle≈ütirmek i√ßin ana uygulama sƒ±nƒ±fƒ±nƒ±za `@EnableScheduling` anotasyonunu ekleyin.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.scheduled;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableScheduling;

@SpringBootApplication
@EnableScheduling
public class ScheduledApplication {
    public static void main(String[] args) {
        SpringApplication.run(ScheduledApplication.class, args);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.scheduled

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.scheduling.annotation.EnableScheduling

@SpringBootApplication
@EnableScheduling
class ScheduledApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;ScheduledApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Planlanmƒ±≈ü Bir G√∂rev Tanƒ±mlayƒ±n</h2>
<p>`@Scheduled` kullanarak zamanlanmƒ±≈ü bir g√∂rev olu≈üturun.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.scheduled;

import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;
import java.time.LocalTime;

@Service
public class ScheduledTask {

    @Scheduled(fixedRate = 5000)
    public void runTask() {
        System.out.println(&quot;Planlanmƒ±≈ü g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: &quot; + LocalTime.now());
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.scheduled

import org.springframework.scheduling.annotation.Scheduled
import org.springframework.stereotype.Service
import java.time.LocalTime

@Service
class ScheduledTask {

    @Scheduled(fixedRate = 5000)
    fun runTask() {
        println(&quot;Planlanmƒ±≈ü g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: ${LocalTime.now()}&quot;)
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Spring Boot uygulamasƒ±nƒ± √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>Veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<p>Planlanmƒ±≈ü g√∂rev her 5 saniyede bir √ßalƒ±≈ütƒ±rƒ±lacaktƒ±r.</p>
<hr />
<h2>üß™ Planlanmƒ±≈ü G√∂revi Test Etme</h2>
<h3>Beklenen Konsol √áƒ±ktƒ±sƒ±:</h3>
<pre><code class="language-plaintext">Planlanmƒ±≈ü g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: 12:00:01
Planlanmƒ±≈ü g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: 12:00:06
Planlanmƒ±≈ü g√∂rev √ßalƒ±≈ütƒ±rƒ±ldƒ±: 12:00:11</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Planlanmƒ±≈ü G√∂revler i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Planlanmƒ±≈ü G√∂revler]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-scheduled-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Reaktif Programlama]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-reactive-programming</link>
      <description><![CDATA[Spring Boot ile Project Reactor ve WebFlux kullanarak y√ºksek performanslƒ±, e≈üzamanlƒ± i≈üleme sahip reaktif uygulamalar olu≈üturmayƒ± √∂ƒürenin.]]></description>
      <pubDate>Wed, 19 Feb 2025 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-reactive-programming</guid>
      <content:encoded><![CDATA[<p>Spring Boot ile Reaktif Programlama, geli≈ütiricilere bloklamayan, olay g√ºd√ºml√º ve y√ºksek √∂l√ßeklenebilir uygulamalar olu≈üturma imkanƒ± sunar. Spring WebFlux ve Project Reactor kullanarak e≈üzamanlƒ± istekleri d√º≈ü√ºk kaynak kullanƒ±mƒ±yla y√∂netebilir, mikro hizmetler ve ger√ßek zamanlƒ± uygulamalar geli≈ütirebilirsiniz.</p>
<hr />
<h2>üåü Neden Reaktif Programlama Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>E≈üzamansƒ±z &amp; Bloklamayan ƒ∞≈üleme: Birden fazla isteƒüi i≈ü par√ßacƒ±klarƒ±nƒ± bloklamadan verimli bir ≈üekilde y√∂netin.</li>
<li>Daha ƒ∞yi √ñl√ßeklenebilirlik: Daha az kaynak kullanarak daha fazla e≈üzamanlƒ± kullanƒ±cƒ±yƒ± destekleyin.</li>
<li>Olay G√ºd√ºml√º Model: Mikro hizmetler, ger√ßek zamanlƒ± uygulamalar ve veri akƒ±≈üƒ± i≈üleme i√ßin idealdir.</li>
<li>Dahili Geri Basƒ±n√ß (Backpressure): Sistemin a≈üƒ±rƒ± y√ºklenmesini √∂nler.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>≈ûunlara sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Spring WebFlux baƒüƒ±mlƒ±lƒ±ƒüƒ±nƒ± `pom.xml` veya `build.gradle` dosyanƒ±za ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-webflux&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Reaktif REST Controller Olu≈üturun</h2>
<p>Mono ve Flux kullanarak bloklamayan bir REST endpoint&#39;i tanƒ±mlayƒ±n.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.reaktif;

import org.springframework.web.bind.annotation.*;
import reactor.core.publisher.Flux;
import reactor.core.publisher.Mono;

import java.time.Duration;
import java.util.List;

@RestController
@RequestMapping(&quot;/reaktif&quot;)
public class ReaktifController {

    @GetMapping(&quot;/mono&quot;)
    public Mono&lt;String&gt; getMono() {
        return Mono.just(&quot;Reaktif Mono&#39;dan Merhaba!&quot;);
    }

    @GetMapping(&quot;/flux&quot;)
    public Flux&lt;String&gt; getFlux() {
        return Flux.fromIterable(List.of(&quot;Merhaba&quot;, &quot;Reaktif&quot;, &quot;D√ºnya&quot;))
                   .delayElements(Duration.ofSeconds(1));
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.reaktif

import org.springframework.web.bind.annotation.*
import reactor.core.publisher.Flux
import reactor.core.publisher.Mono
import java.time.Duration

@RestController
@RequestMapping(&quot;/reaktif&quot;)
class ReaktifController {

    @GetMapping(&quot;/mono&quot;)
    fun getMono(): Mono&lt;String&gt; {
        return Mono.just(&quot;Reaktif Mono&#39;dan Merhaba!&quot;)
    }

    @GetMapping(&quot;/flux&quot;)
    fun getFlux(): Flux&lt;String&gt; {
        return Flux.just(&quot;Merhaba&quot;, &quot;Reaktif&quot;, &quot;D√ºnya&quot;)
            .delayElements(Duration.ofSeconds(1))
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Spring Boot uygulamasƒ±nƒ± √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>Veya Gradle kullanarak:</p>
<pre><code class="language-bash">gradle bootRun</code></pre>
<hr />
<h2>üß™ API&#39;yi Test Etme</h2>
<h3>Mono Endpoint Testi:</h3>
<pre><code class="language-bash">curl -X GET http://localhost:8080/reaktif/mono</code></pre>
<p>Beklenen √ßƒ±ktƒ±:</p>
<pre><code class="language-plaintext">Reaktif Mono&#39;dan Merhaba!</code></pre>
<h3>Flux Endpoint Testi:</h3>
<pre><code class="language-bash">curl -X GET http://localhost:8080/reaktif/flux</code></pre>
<p>Beklenen √ßƒ±ktƒ± (her kelime i√ßin 1 saniyelik gecikme ile):</p>
<pre><code class="language-plaintext">Merhaba
Reaktif
D√ºnya</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Reaktif Programlama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Reaktif Programlama]]></category>
      <category><![CDATA[Spring WebFlux]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-reactive-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile GraalVM Native Uygulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-graalvm</link>
      <description><![CDATA[Spring Boot uygulamalarƒ±nƒ±zƒ± GraalVM native imajƒ± olarak derleyerek daha hƒ±zlƒ± ba≈ülatma s√ºreleri ve azaltƒ±lmƒ±≈ü kaynak kullanƒ±mƒ± elde etmeyi √∂ƒürenin.]]></description>
      <pubDate>Sat, 28 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-graalvm</guid>
      <content:encoded><![CDATA[<p>Spring Boot ile GraalVM Native, geli≈ütiricilere daha hƒ±zlƒ± ba≈ülatma s√ºreleri, azaltƒ±lmƒ±≈ü bellek t√ºketimi ve artƒ±rƒ±lmƒ±≈ü g√ºvenlik sunan uygulamalar olu≈üturma imk√¢nƒ± tanƒ±r. Native imaj desteƒüi sayesinde, Spring Boot uygulamalarƒ±nƒ±z kaynak kƒ±sƒ±tlƒ± ortamlarda etkin bir ≈üekilde √ßalƒ±≈üabilir ve modern bulut tabanlƒ± mimariler i√ßin ideal bir se√ßenek haline gelir.</p>
<hr />
<h2>üåü Neden GraalVM ile Native Uygulama Olu≈üturalƒ±m?</h2>
<ul>
<li>Daha Hƒ±zlƒ± Ba≈ülatma S√ºreleri: Native imajlar, JVM tabanlƒ± uygulamalara kƒ±yasla √ßok daha hƒ±zlƒ± ba≈ülatƒ±lƒ±r.</li>
<li>Azaltƒ±lmƒ±≈ü Kaynak Kullanƒ±mƒ±: Native imajlar daha az bellek kullanƒ±r, bu da bulut ve konteynerize ortamlar i√ßin idealdir.</li>
<li>Artƒ±rƒ±lmƒ±≈ü G√ºvenlik: Daha k√º√ß√ºk bir runtime ve sƒ±nƒ±rlƒ± bir y√ºzey alanƒ± sunar.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üõ† GraalVM native-image desteƒüi ile y√ºklenmi≈ü</li>
<li>üïù Maven veya Gradle</li>
<li>üê≥ Docker (opsiyonel, konteyner imajlarƒ± olu≈üturmak i√ßin)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>`pom.xml` veya `build.gradle` dosyanƒ±za GraalVM Native Build Tools eklentisini ekleyin.</p>
<p>Maven:</p>
<pre><code class="language-xml">&lt;plugin&gt;
    &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;
    &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;0.9.20&lt;/version&gt;
&lt;/plugin&gt;</code></pre>
<p>Gradle:</p>
<pre><code class="language-groovy">plugins {
    id &#39;org.graalvm.buildtools.native&#39; version &#39;0.9.20&#39;
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Bir REST Controller Yazƒ±n</h2>
<p>Native imaj fonksiyonelliƒüini test etmek i√ßin basit bir REST endpoint olu≈üturun.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.graalvmnative;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
public class MyApplication {

    public static void main(String[] args) {
        SpringApplication.run(MyApplication.class, args);
    }

    @GetMapping(&quot;/greeting&quot;)
    public String greeting() {
        return &quot;Hello from GraalVM Native!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.graalvmnative

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RestController

@SpringBootApplication
@RestController
class MyApplication {

    @GetMapping(&quot;/greeting&quot;)
    fun greeting(): String = &quot;Hello from GraalVM Native!&quot;
}

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;MyApplication&gt;(*args)
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Native ƒ∞maj Olu≈üturun</h2>
<h3>Maven Kullanarak</h3>
<p>Native imaj olu≈üturmak i√ßin a≈üaƒüƒ±daki komutu √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">mvn -Pnative package</code></pre>
<h3>Gradle Kullanarak</h3>
<p>A≈üaƒüƒ±daki komutu √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">gradle nativeCompile</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Docker ƒ∞majƒ± Olu≈üturun</h2>
<p>Spring Boot, native y√ºr√ºt√ºlebilir dosyalarla Docker imajlarƒ± olu≈üturmayƒ± destekler.</p>
<h3>Maven Komutu:</h3>
<pre><code class="language-bash">mvn -Pnative spring-boot:build-image</code></pre>
<h3>Gradle Komutu:</h3>
<pre><code class="language-bash">gradle bootBuildImage</code></pre>
<p>Docker imajƒ± local olarak hazƒ±r olacak ve a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±labilir:</p>
<pre><code class="language-bash">docker run --rm -p 8080:8080 myproject:0.0.1-SNAPSHOT</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<h3>Yerel Olarak √áalƒ±≈ütƒ±rma</h3>
<p>Native imajƒ± doƒürudan √ßalƒ±≈ütƒ±rabilirsiniz:</p>
<pre><code class="language-bash">./target/myproject</code></pre>
<h3>Docker&#39;da √áalƒ±≈ütƒ±rma</h3>
<p>Eƒüer Docker imajƒ± olu≈üturduysanƒ±z, a≈üaƒüƒ±daki komutu kullanarak √ßalƒ±≈ütƒ±rabilirsiniz:</p>
<pre><code class="language-bash">docker run --rm -p 8080:8080 myproject:0.0.1-SNAPSHOT</code></pre>
<hr />
<h2>üß™ API&#39;yƒ± Test Etme</h2>
<p>REST endpoint&#39;i cURL veya Postman kullanarak test edin:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8080/greeting</code></pre>
<p>Beklenen √ßƒ±ktƒ±:</p>
<pre><code class="language-plaintext">Hello from GraalVM Native!</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile GraalVM Native Uygulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[GraalVM]]></category>
      <category><![CDATA[Native ƒ∞maj]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-graalvm-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile Kafka Entegrasyonu]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-kafka</link>
      <description><![CDATA[Spring Boot uygulamanƒ±zƒ±n Kafka topicleri aracƒ±lƒ±ƒüƒ±yla JSON mesajlarƒ± g√∂ndermesini ve t√ºketmesini nasƒ±l entegre edeceƒüinizi √∂ƒürenin.]]></description>
      <pubDate>Wed, 25 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-kafka</guid>
      <content:encoded><![CDATA[<p>Apache Kafka, ger√ßek zamanlƒ± veri i≈üleme olanaƒüƒ± saƒülayan daƒüƒ±tƒ±k bir olay akƒ±≈üƒ± platformudur. Bu kƒ±lavuz, Spring Boot uygulamasƒ±nda Kafka kullanarak JSON mesajlarƒ±nƒ±n nasƒ±l g√∂nderilip t√ºketileceƒüini g√∂stermektedir.</p>
<hr />
<h2>üåü Neden Kafka Kullanƒ±lmalƒ±?</h2>
<ul>
<li>√ñl√ßeklenebilir Mesajla≈üma: B√ºy√ºk veri hacimlerini sorunsuz bir ≈üekilde i≈üleyin.</li>
<li>Hata Toleransƒ±: Veri dayanƒ±klƒ±lƒ±ƒüƒ± ve y√ºksek eri≈üilebilirlik saƒülar.</li>
<li>Ger√ßek Zamanlƒ± Veri ƒ∞≈üleme: Verileri anƒ±nda i≈üleyin ve analiz edin.</li>
<li>Kolay Entegrasyon: Kafka, Spring Boot ile etkin bir geli≈ütirme i√ßin kolayca entegre edilebilir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºklenmi≈ü</li>
<li>üî† Bir Java IDE (IntelliJ IDEA, Eclipse gibi)</li>
<li>üî† Apache Kafka, y√ºklenmi≈ü ve √ßalƒ±≈üƒ±r durumda</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Kafka&#39;yƒ± Spring Boot projenize entegre etmek i√ßin a≈üaƒüƒ±daki baƒüƒ±mlƒ±klarƒ± ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
  &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.kafka:spring-kafka&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Kafka&#39;yƒ± Yapƒ±landƒ±rƒ±n</h2>
<p>Kafka baƒülantƒ±sƒ±nƒ± `application.properties` veya `application.yml` dosyasƒ±nda yapƒ±landƒ±rƒ±n:</p>
<pre><code class="language-properties">spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.consumer.group-id=my-group
spring.kafka.consumer.auto-offset-reset=earliest
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
spring.kafka.consumer.properties.spring.json.trusted.packages=*</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: JSON Mesajlar i√ßin Bir Model Olu≈üturun</h2>
<h3>Model Sƒ±nƒ±fƒ±</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.kafka.model;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class Message {
    private String id;
    private String content;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.kafka.model

data class Message(
    val id: String,
    val content: String
)</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Kafka Producer ve Consumer Uygulamalarƒ±</h2>
<h3>Producer √ñrneƒüi</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.kafka.producer;

import com.example.kafka.model.Message;
import lombok.RequiredArgsConstructor;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public class KafkaProducer {

    private final KafkaTemplate&lt;String, Message&gt; kafkaTemplate;

    public void sendMessage(String topic, Message message) {
        kafkaTemplate.send(topic, message);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.kafka.producer

import com.example.kafka.model.Message
import org.springframework.kafka.core.KafkaTemplate
import org.springframework.stereotype.Service

@Service
class KafkaProducer(private val kafkaTemplate: KafkaTemplate&lt;String, Message&gt;) {

    fun sendMessage(topic: String, message: Message) {
        kafkaTemplate.send(topic, message)
    }
}</code></pre>
<h3>Consumer √ñrneƒüi</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.kafka.consumer;

import com.example.kafka.model.Message;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Service;

@Service
public class KafkaConsumer {

    @KafkaListener(topics = &quot;my-topic&quot;, groupId = &quot;my-group&quot;)
    public void consumeMessage(Message message) {
        System.out.println(&quot;Received message: &quot; + message);
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.kafka.consumer

import com.example.kafka.model.Message
import org.springframework.kafka.annotation.KafkaListener
import org.springframework.stereotype.Service

@Service
class KafkaConsumer {

    @KafkaListener(topics = [&quot;my-topic&quot;], groupId = &quot;my-group&quot;)
    fun consumeMessage(message: Message) {
        println(&quot;Received message: $message&quot;)
    }
}</code></pre>
<hr />
<h3>Controller √ñrneƒüi</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.kafka.controller;

import com.example.kafka.model.Message;
import com.example.kafka.producer.KafkaProducer;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping(&quot;/kafka&quot;)
@RequiredArgsConstructor
public class KafkaController {

    private final KafkaProducer kafkaProducer;

    @PostMapping(&quot;/publish&quot;)
    public String publishMessage(@RequestParam String topic, @RequestBody Message message) {
        kafkaProducer.sendMessage(topic, message);
        return &quot;Message sent to topic: &quot; + topic;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.kafka.controller

import com.example.kafka.model.Message
import com.example.kafka.producer.KafkaProducer
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/kafka&quot;)
class KafkaController(private val kafkaProducer: KafkaProducer) {

    @PostMapping(&quot;/publish&quot;)
    fun publishMessage(@RequestParam topic: String, @RequestBody message: Message): String {
        kafkaProducer.sendMessage(topic, message)
        return &quot;Message sent to topic: $topic&quot;
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<hr />
<h2>üß™ API&#39;yi Test Etme</h2>
<p>Kafka Producer apisini cURL veya Postman kullanarak test edebilirsiniz:</p>
<pre><code class="language-bash">curl -X POST &quot;http://localhost:8080/kafka/publish&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;id&quot;: &quot;123&quot;, &quot;content&quot;: &quot;Hello Kafka!&quot;}&#39;</code></pre>
<p>Kafka Consumer loglarƒ±nƒ± kontrol ederek mesajƒ±n alƒ±ndƒ±ƒüƒ±nƒ± ve i≈ülendiƒüini doƒürulayƒ±n.</p>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile Kafka Entegrasyonu i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Kafka]]></category>
      <category><![CDATA[Mesajla≈üma]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-kafka-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile Redis √ñnbellekleme]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-redis-caching</link>
      <description><![CDATA[Spring Boot uygulamanƒ±za Redis √∂nbellekleme uygulayarak performansƒ±nƒ± ve verimliliƒüini artƒ±rmayƒ± √∂ƒürenin.]]></description>
      <pubDate>Sun, 22 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-redis-caching</guid>
      <content:encoded><![CDATA[<p>Redis, genellikle √∂nbellekleme, mesajla≈üma ve ger√ßek zamanlƒ± veri y√∂netimi i√ßin kullanƒ±lan g√º√ßl√º bir bellek i√ßi veri deposudur. Bu kƒ±lavuz, Redis&#39;i hem Java hem de Kotlin kullanarak bir Spring Boot uygulamasƒ±na nasƒ±l entegre edeceƒüinizi a√ßƒ±klar.</p>
<hr />
<h2>üåü Neden Redis Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Y√ºksek Performans: Redis, okuma ve yazma i≈ülemleri i√ßin son derece d√º≈ü√ºk gecikme s√ºreleri saƒülar.</li>
<li>Esnek Veri Yapƒ±larƒ±: String, hash, liste, set ve daha fazlasƒ±nƒ± destekler.</li>
<li>√ñl√ß√ºklenebilirlik: Daƒüƒ±tƒ±k √∂nbellekleme ve ger√ßek zamanlƒ± analitik i√ßin idealdir.</li>
<li>Kolay Entegrasyon: Spring Boot ile kolayca entegre edilebilir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üëà A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºklenmi≈ü</li>
<li>üÑ§ Bir Java IDE (IntelliJ IDEA, Eclipse gibi)</li>
<li>üî† Redis Sunucusu, lokal olarak y√ºklenmi≈ü veya aƒüa eri≈üilebilir</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Redis&#39;i Spring Boot projenize entegre etmek i√ßin a≈üaƒüƒ±daki baƒüƒ±mlƒ±klarƒ± ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-data-redis&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Redis&#39;i Yapƒ±landƒ±rƒ±n</h2>
<p>Redis baƒülantƒ±sƒ±nƒ± `application.properties` veya `application.yml` dosyanƒ±zda yapƒ±landƒ±rƒ±n.</p>
<h3>√ñrnek Yapƒ±landƒ±rma:</h3>
<pre><code class="language-properties">spring.redis.host=localhost
spring.redis.port=6379</code></pre>
<p>Parola doƒürulama veya SSL gibi ileri d√ºzey kurulumlar i√ßin ≈üunlarƒ± ekleyin:</p>
<pre><code class="language-properties">spring.redis.password=sifre
spring.redis.ssl=true</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: √ñnbelleƒüi Etkinle≈ütirin</h2>
<p>Ana uygulama sƒ±nƒ±fƒ±nƒ±za `@EnableCaching` ekleyin:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.redis;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cache.annotation.EnableCaching;

@SpringBootApplication
@EnableCaching
public class RedisApplication {
  public static void main(String[] args) {
    SpringApplication.run(RedisApplication.class, args);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.redis

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.cache.annotation.EnableCaching

@SpringBootApplication
@EnableCaching
class RedisApplication

fun main(args: Array&lt;String&gt;) {
  runApplication&lt;RedisApplication&gt;(*args)
}</code></pre>
<hr />
<h3>Servis Katmanƒ±nda √ñnbellekleme √ñrneƒüi</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.redis.service;

import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Service;

@Service
public class UserService {

  @Cacheable(&quot;users&quot;)
  public String getUserById(String id) {
    simulateSlowService();
    return &quot;User with ID: &quot; + id;
  }

  private void simulateSlowService() {
    try {
      Thread.sleep(3000L);
    } catch (InterruptedException e) {
      throw new IllegalStateException(e);
    }
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.redis.service

import org.springframework.cache.annotation.Cacheable
import org.springframework.stereotype.Service

@Service
class UserService {

  @Cacheable(&quot;users&quot;)
  fun getUserById(id: String): String {
    simulateSlowService()
    return &quot;User with ID: $id&quot;
  }

  private fun simulateSlowService() {
    Thread.sleep(3000L)
  }
}</code></pre>
<hr />
<h3>√ñnbellek Zaman A≈üƒ±mƒ± (TTL) Yapƒ±landƒ±rmasƒ±</h3>
<p>`application.properties` dosyasƒ±nda √∂nbellek sona erme s√ºrelerini ayarlayƒ±n:</p>
<pre><code class="language-properties">spring.cache.redis.time-to-live=600000</code></pre>
<p>Bu, zaman a≈üƒ±mƒ±nƒ± 10 dakika (600.000 milisaniye) olarak ayarlar.</p>
<hr />
<h3>Controller √ñrneƒüi</h3>
<p>√ñnbellekleme i≈ülevini expose etmek i√ßin bir REST Controller olu≈üturun.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.redis.controller;

import com.example.redis.service.UserService;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping(&quot;/users&quot;)
@RequiredArgsConstructor
public class UserController {

  private final UserService userService;

  @GetMapping(&quot;/{id}&quot;)
  public String getUser(@PathVariable String id) {
    return userService.getUserById(id);
  }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.redis.controller

import com.example.redis.service.UserService
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/users&quot;)
class UserController(
  private val userService: UserService
) {
  @GetMapping(&quot;/{id}&quot;)
  fun getUser(@PathVariable id: String): String = userService.getUserById(id)
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<hr />
<h2>üß™ API‚Äôyƒ± Test Etme</h2>
<p>API‚Äôyƒ± cURL veya Postman kullanarak test edebilirsiniz:</p>
<ul>
<li>Bir Kullanƒ±cƒ±yƒ± Getir (√∂nbellekli):</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/users/1</code></pre>
<p>Aynƒ± isteƒüi tekrar ettiƒüinizde, yanƒ±tlarƒ±n daha hƒ±zlƒ± geldiƒüini g√∂zlemleyebilirsiniz.</p>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile Redis √ñnbellekleme i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Redis]]></category>
      <category><![CDATA[√ñnbellekleme]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-redis-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile OpenAPI]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-openapi</link>
      <description><![CDATA[SpringDoc kullanarak Spring Boot uygulamanƒ±zda OpenAPI entegrasyonu ile API dok√ºmantasyonu ve test y√∂ntemlerini √∂ƒürenin.]]></description>
      <pubDate>Fri, 20 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-openapi</guid>
      <content:encoded><![CDATA[<p>OpenAPI, API dok√ºmantasyonu ve test i≈ülemlerini kolayla≈ütƒ±ran etkile≈üimli bir aray√ºz ve makine tarafƒ±ndan okunabilir belgeler saƒülar. Bu kƒ±lavuz, SpringDoc kullanarak OpenAPI&#39;yi Spring Boot uygulamanƒ±za entegre etmenin yollarƒ±nƒ± g√∂sterecektir.</p>
<hr />
<h2>üåü Neden OpenAPI Kullanmalƒ±yƒ±z?</h2>
<ul>
<li>Etkile≈üimli Dok√ºmantasyon: API&#39;leri ke≈üfetmek i√ßin kullanƒ±cƒ± dostu bir aray√ºz saƒülar.</li>
<li>Standartla≈ütƒ±rƒ±lmƒ±≈ü Format: Makine tarafƒ±ndan okunabilir API tanƒ±mlarƒ± olu≈üturur.</li>
<li>Kolay Test: Endpoint&#39;leri test etmek i√ßin yerle≈üik ara√ßlar sunar.</li>
<li>ƒ∞stemci Kod √úretimi: √áe≈üitli programlama dilleri i√ßin otomatik istemci kodu √ºretimi saƒülar.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã ≈ûunlara sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºkl√º</li>
<li>üî§ Bir Java IDE (√ñrneƒüin IntelliJ IDEA, Eclipse)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>SpringDoc kullanarak OpenAPI&#39;yi entegre etmek i√ßin a≈üaƒüƒ±daki baƒüƒ±mlƒ±lƒ±ƒüƒ± projenize ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springdoc&lt;/groupId&gt;
  &lt;artifactId&gt;springdoc-openapi-starter-webmvc-ui&lt;/artifactId&gt;
  &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springdoc:springdoc-openapi-starter-webmvc-ui:2.1.0&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: OpenAPI&#39;yi Yapƒ±landƒ±rƒ±n</h2>
<p>SpringDoc minimal konfig√ºrasyon gerektirir. `application.properties` veya `application.yml` dosyasƒ± √ºzerinden dok√ºmantasyonu √∂zelle≈ütirebilirsiniz.</p>
<h3>√ñrnek Konfig√ºrasyon:</h3>
<pre><code class="language-properties">springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: REST Kontrollerinizi Anotasyonlarla Belgeleyin</h2>
<p>REST kontrollerinize ve modellerinize anotasyonlar ekleyerek OpenAPI dok√ºmantasyonunu otomatik olarak olu≈üturabilirsiniz.</p>
<h3>Java</h3>
<h3>Controller √ñrneƒüi</h3>
<pre><code class="language-java">package com.example.openapi.controller;

import com.example.openapi.model.User;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.media.Content;
import io.swagger.v3.oas.annotations.responses.ApiResponse;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping(&quot;/users&quot;)
public class UserController {

  @Operation(summary = &quot;T√ºm kullanƒ±cƒ±larƒ± getir&quot;, description = &quot;Kullanƒ±cƒ± listesini alƒ±r&quot;)
  @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Ba≈üarƒ±lƒ± i≈ülem&quot;,
    content = @Content(mediaType = &quot;application/json&quot;))
  @GetMapping
  public List&lt;User&gt; getAllUsers() {
    return List.of(new User(1L, &quot;John Doe&quot;, &quot;john@example.com&quot;));
  }

  @Operation(summary = &quot;Yeni bir kullanƒ±cƒ± olu≈ütur&quot;, description = &quot;Sisteme yeni bir kullanƒ±cƒ± ekler&quot;)
  @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Kullanƒ±cƒ± ba≈üarƒ±yla olu≈üturuldu&quot;,
    content = @Content(mediaType = &quot;application/json&quot;))
  @PostMapping
  public User createUser(@RequestBody User user) {
    return user;
  }
}</code></pre>
<h3>User Model</h3>
<pre><code class="language-java">package com.example.openapi.model;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class User {

    private Long id;
    private String name;
    private String email;
}</code></pre>
<h3>Kotlin</h3>
<h3>Controller √ñrneƒüi</h3>
<pre><code class="language-kotlin">package com.example.openapi.controller

import com.example.openapi.model.User
import io.swagger.v3.oas.annotations.*
import io.swagger.v3.oas.annotations.responses.*
import io.swagger.v3.oas.annotations.media.*
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/users&quot;)
class UserController {

    @Operation(summary = &quot;T√ºm kullanƒ±cƒ±larƒ± getir&quot;, description = &quot;Kullanƒ±cƒ± listesini alƒ±r&quot;)
    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Ba≈üarƒ±lƒ± i≈ülem&quot;,
                 content = [Content(mediaType = &quot;application/json&quot;)])
    @GetMapping
    fun getAllUsers(): List&lt;User&gt; = listOf(User(1L, &quot;John Doe&quot;, &quot;john@example.com&quot;))

    @Operation(summary = &quot;Yeni bir kullanƒ±cƒ± olu≈ütur&quot;, description = &quot;Sisteme yeni bir kullanƒ±cƒ± ekler&quot;)
    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Kullanƒ±cƒ± ba≈üarƒ±yla olu≈üturuldu&quot;,
                 content = [Content(mediaType = &quot;application/json&quot;)])
    @PostMapping
    fun createUser(@RequestBody user: User): User = user
}</code></pre>
<h3>User Model</h3>
<pre><code class="language-kotlin">package com.example.openapi.model

data class User(
  val id: Long,
  val name: String,
  val email: String
)</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>OpenAPI dok√ºmantasyonuna eri≈ümek i√ßin:</p>
<ul>
<li>API Docs: `http://localhost:8080/api-docs`</li>
<li>Swagger UI: `http://localhost:8080/swagger-ui.html`</li>
</ul>
<hr />
<h2>üß™ API&#39;yi Test Etme</h2>
<p>Swagger UI aray√ºz√ºne eri≈üerek olu≈üturulan API dok√ºmantasyonunu test edebilirsiniz:</p>
<p>1. Tarayƒ±cƒ±nƒ±zda `http://localhost:8080/swagger-ui.html` adresine gidin. 2. Endpoint&#39;leri etkile≈üimli olarak test etmek i√ßin giri≈üler yapƒ±n ve yanƒ±tlarƒ± g√∂zlemleyin.</p>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile OpenAPI i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[OpenAPI]]></category>
      <category><![CDATA[Dok√ºmantasyon]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-openapi-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Temiz Kodlama Pratikleri]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-clean-coding</link>
      <description><![CDATA[Spring Boot projelerinde temiz kodlama ilkelerini uygulamayƒ± √∂ƒürenin. En iyi uygulamalar, √∂rnekler ve Java'da Lombok ile Kotlin temiz kodlama tekniklerinin faydalarƒ±.]]></description>
      <pubDate>Thu, 19 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-clean-coding</guid>
      <content:encoded><![CDATA[<p>Temiz kodlama pratikleri, Spring Boot uygulamalarƒ±nƒ±zƒ±n bakƒ±mƒ±nƒ± kolayla≈ütƒ±rƒ±r, okunabilirliƒüini artƒ±rƒ±r ve geli≈ütirilebilirliƒüini saƒülar. Bu rehber, hem Java hem de Kotlin&#39;de daha temiz ve verimli kod yazmanƒ±za yardƒ±mcƒ± olacak temel ipu√ßlarƒ± ve kod √∂rneklerini sunar.</p>
<hr />
<h2>üåü Neden Temiz Kodlama?</h2>
<p>Temiz kodlama ilkelerini benimsemek ≈üu faydalarƒ± saƒülar:</p>
<ul>
<li>Kodun okunabilirliƒüini ve bakƒ±mƒ±nƒ± iyile≈ütirir.</li>
<li>Teknik borcu azaltƒ±r.</li>
<li>Yeni geli≈ütiricilerin projeye alƒ±≈ümasƒ±nƒ± kolayla≈ütƒ±rƒ±r.</li>
<li>Geni≈ületilebilirlik ve hata ayƒ±klama s√ºre√ßlerini geli≈ütirir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üóå A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
<li>üõ†Ô∏è Spring Boot temel bilgilerine hakimiyet</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Projenizi Yapƒ±landƒ±rƒ±n</h2>
<p>Spring Boot projenizi daha net bir hale getirmek i√ßin a≈üaƒüƒ±daki gibi organize edin:</p>
<ul>
<li>Controller Katmanƒ±: Gelen HTTP isteklerini y√∂netir.</li>
<li>Service Katmanƒ±: ƒ∞≈ü mantƒ±ƒüƒ±nƒ± i√ßerir.</li>
<li>Repository Katmanƒ±: Veritabanƒ± ile etkile≈üir.</li>
</ul>
<h3>√ñrnek Klas√∂r Yapƒ±sƒ±:</h3>
<pre><code>src/main/java/com/example/cleanproject
‚îú‚îÄ‚îÄ controller
‚îú‚îÄ‚îÄ service
‚îú‚îÄ‚îÄ repository
‚îú‚îÄ‚îÄ entity
‚îî‚îÄ‚îÄ dto</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Java Kodlarƒ±nda Lombok Kullanƒ±mƒ±</h2>
<p>Lombok, Java&#39;daki gereksiz kodu azaltarak sƒ±nƒ±flarƒ±nƒ±zƒ± daha kƒ±sa ve okunabilir hale getirir. ƒ∞≈üte Lombok&#39;u etkili bir ≈üekilde kullanmanƒ±n y√∂ntemi:</p>
<h3>Lombok Baƒülƒ±lƒ±ƒüƒ±nƒ± Ekleyin</h3>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
  &lt;artifactId&gt;lombok&lt;/artifactId&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">provided &#39;org.projectlombok:lombok&#39;
annotationProcessor &#39;org.projectlombok:lombok&#39;</code></pre>
<h3>√ñrnek: Lombok ile Entity</h3>
<pre><code class="language-java">package com.example.cleanproject.entity;

import jakarta.persistence.*;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.AllArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Entity
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    private String email;
}</code></pre>
<p>Faydalar:</p>
<ul>
<li>`@Data`, getter, setter, equals, hashCode ve toString metotlarƒ±nƒ± otomatik olarak olu≈üturur.</li>
<li>`@NoArgsConstructor` ve `@AllArgsConstructor` yapƒ±cƒ± metotlarƒ± olu≈üturur.</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Kotlin&#39;de Kƒ±sa ve Okunabilir Kod Yazƒ±n</h2>
<p>Kotlin, modern √∂zellikleri ile doƒüal olarak daha temiz kod yazƒ±lmasƒ±nƒ± saƒülar:</p>
<h3>√ñrnek: Kotlin ile Entity</h3>
<pre><code class="language-kotlin">package com.example.cleanproject.entity

import jakarta.persistence.*

@Entity
data class User(
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    val id: Long = 0,
    var name: String,
    var email: String
)</code></pre>
<p>Kotlin&#39;in Avantajlarƒ±:</p>
<ul>
<li>`data class`, `toString`, `equals` ve `hashCode` metotlarƒ±nƒ± otomatik olarak olu≈üturur.</li>
<li>Deƒüi≈ümez √∂zellikler (`val`) daha iyi stabilite saƒülar.</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Dependency Injection Prensiplerini Takip Edin</h2>
<p>Bile≈üenleri ayƒ±rmak ve test edilebilirliƒüi arttƒ±rmak i√ßin dependency injectionu kullanƒ±n.</p>
<h3>√ñrnek: Service Katmanƒ± ile DI</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.cleanproject.service;

import com.example.cleanproject.entity.User;
import com.example.cleanproject.repository.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
@RequiredArgsConstructor
public class UserService {

    private final UserRepository userRepository;

    public List&lt;User&gt; getAllUsers() {
        return userRepository.findAll();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.cleanproject.service

import com.example.cleanproject.entity.User
import com.example.cleanproject.repository.UserRepository
import org.springframework.stereotype.Service

@Service
class UserService(
    private val userRepository: UserRepository
) {
    fun getAllUsers(): List&lt;User&gt; = userRepository.findAll()
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: Veri Transferi ƒ∞√ßin DTO&#39;larƒ± Kullananƒ±n</h2>
<p>Data Transfer Object (DTO), domain ve API katmanlarƒ±nƒ± ayƒ±rarak daha iyi kaps√ºlleme saƒülar.</p>
<h3>√ñrnek: User ƒ∞√ßin DTO</h3>
<h3>Java</h3>
<pre><code class="language-java">package com.example.cleanproject.dto;

import lombok.Data;

@Data
public class UserDTO {
    private String name;
    private String email;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.cleanproject.dto

data class UserDTO(
    val name: String,
    val email: String
)</code></pre>
<hr />
<h3>Controller Katmanƒ±</h3>
<p>HTTP isteklerini y√∂netmek ve service katmanƒ±yla etkile≈üim saƒülamak i√ßin bir controller uygulayƒ±n.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.cleanproject.controller;

import com.example.cleanproject.dto.UserDTO;
import com.example.cleanproject.service.UserService;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping(&quot;/api/users&quot;)
@RequiredArgsConstructor
public class UserController {

    private final UserService userService;

    @GetMapping
    public List&lt;UserDTO&gt; getAllUsers() {
        return userService.getAllUsers();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.cleanproject.controller

import com.example.cleanproject.dto.UserDTO
import com.example.cleanproject.service.UserService
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/api/users&quot;)
class UserController(
    private val userService: UserService
) {

    @GetMapping
    fun getAllUsers(): List&lt;UserDTO&gt; = userService.getAllUsers()
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>Postman veya cURL gibi bir aracƒ± kullanarak endpoint&#39;leri test edin.</p>
<hr />
<h2>üß™ API&#39;yi Test Edin</h2>
<p>API&#39;yi a≈üaƒüƒ±daki cURL komutu ile test edebilirsiniz:</p>
<ul>
<li>T√ºm kullanƒ±cƒ±larƒ± getir:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/users</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Temiz Kodlama Pratikleri i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Temiz Kodlama]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-clean-coding-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot DevTools]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-devtools</link>
      <description><![CDATA[Spring Boot DevTools ile hƒ±zlƒ± geli≈ütirme s√ºrecinizi nasƒ±l hƒ±zlandƒ±rabileceƒüinizi ke≈üfedin. Canlƒ± yeniden y√ºkleme, √∂nbellekleme ve hata ayƒ±klama ipu√ßlarƒ± i√ßerir.]]></description>
      <pubDate>Thu, 19 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-devtools</guid>
      <content:encoded><![CDATA[<p>Spring Boot DevTools, geli≈ütirme s√ºrecinizi hƒ±zlandƒ±rmak isteyen geli≈ütiriciler i√ßin olmazsa olmaz bir aracƒ±dƒ±r. Bu kƒ±lavuz, canlƒ± yeniden y√ºkleme, √∂nbellekleme ve hata ayƒ±klama iyile≈ütirmeleri dahil olmak √ºzere DevTools&#39;ƒ±n √∂zelliklerini ve kurulumunu anlatmaktadƒ±r.</p>
<hr />
<h2>üåü Neden Spring Boot DevTools Kullanƒ±lmalƒ±?</h2>
<p>Spring Boot DevTools geli≈ütiricilere ≈üunlarƒ± sunar:</p>
<ul>
<li>Canlƒ± Yeniden Y√ºkleme: Kod deƒüi≈üikliklerinde uygulamayƒ± otomatik olarak yeniden y√ºkler.</li>
<li>√ñnbellekleme ƒ∞yile≈ütirmeleri: Daha hƒ±zlƒ± yineleme i√ßin ≈üablon √∂nbelleklemesini devre dƒ±≈üƒ± bƒ±rakƒ±r.</li>
<li>Hata Ayƒ±klama Ara√ßlarƒ±: Geli≈ütirme s√ºrecinde hata ayƒ±klama deneyimini iyile≈ütirir.</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã ≈ûunlara sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Geli≈ütirme Kiti (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºklenmi≈ü</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse gibi)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>DevTools&#39;u etkinle≈ütirmek i√ßin projenize a≈üaƒüƒ±daki baƒüƒ±mlƒ±lƒ±klarƒ± ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
  &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">runtimeOnly &#39;org.springframework.boot:spring-boot-devtools&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: DevTools&#39;u Yapƒ±landƒ±rƒ±n</h2>
<p>Spring Boot DevTools, minimal yapƒ±landƒ±rma gerektirir ancak bazƒ± √∂zelle≈ütirme se√ßenekleri sunar. ƒ∞≈üte bazƒ± yaygƒ±n yapƒ±landƒ±rma √∂rnekleri:</p>
<h3>Canlƒ± Yeniden Y√ºkleme</h3>
<p>Canlƒ± yeniden y√ºkleme, IntelliJ IDEA veya Eclipse gibi desteklenen IDE&#39;lerle DevTools kullanƒ±lƒ±rken varsayƒ±lan olarak etkindir.</p>
<h3>√ñnbellekleme</h3>
<p>≈ûablonlar i√ßin √∂nbellekleme devre dƒ±≈üƒ± bƒ±rakƒ±lƒ±r:</p>
<pre><code class="language-properties">spring.thymeleaf.cache=false
spring.freemarker.cache=false</code></pre>
<h3>Yeniden Ba≈ülatma Hari√ß Tutmalarƒ±</h3>
<p>Belirli dosyalarƒ± veya dizinleri yeniden ba≈ülatmadan hari√ß tutun:</p>
<pre><code class="language-properties">spring.devtools.restart.exclude=static/**,public/**</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Hata Ayƒ±klama ƒ∞yile≈ütirmeleri</h2>
<p>Spring Boot DevTools, hata ayƒ±klamayƒ± ≈üu ≈üekilde iyile≈ütirir:</p>
<ul>
<li>Otomatik Yeniden Ba≈ülatma: Kod deƒüi≈üiklikleri algƒ±landƒ±ƒüƒ±nda uygulama baƒülamƒ±nƒ± yeniden ba≈ülatƒ±r.</li>
<li>Uzaktan Hata Ayƒ±klama: Uzak sunucularda √ßalƒ±≈üan uygulamalarƒ± hata ayƒ±klama yeteneƒüi sunar.</li>
</ul>
<p>Uzaktan hata ayƒ±klamayƒ± etkinle≈ütirmek i√ßin:</p>
<pre><code class="language-properties">spring.devtools.remote.secret=benimsifre</code></pre>
<p>Baƒülanmak i√ßin ≈üu komutu kullanƒ±n:</p>
<pre><code class="language-bash">java -jar myapp.jar -Dspring.devtools.remote.secret=benimsifre</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>Kodunuzda deƒüi≈üiklik yapƒ±n ve canlƒ± yeniden y√ºkleme ile uygulama baƒülamƒ±nƒ±n yeniden ba≈ülatƒ±ldƒ±ƒüƒ±nƒ± g√∂zlemleyin.</p>
<hr />
<h2>üß™ DevTools&#39;u Test Etme</h2>
<p>Spring Boot DevTools √∂zelliklerini a≈üaƒüƒ±daki ≈üekilde test edebilirsiniz:</p>
<ul>
<li>Canlƒ± Yeniden Y√ºkleme: Kontrolc√ºn√ºzde veya ≈üablonunuzda bir deƒüi≈üiklik yapƒ±n ve dosyayƒ± kaydedin. Uygulama otomatik olarak yeniden y√ºklenmelidir.</li>
<li>≈ûablon G√ºncellemeleri: Bir `.html` dosyasƒ±nƒ± g√ºncelleyerek sunucuyu yeniden ba≈ülatmadan deƒüi≈üiklikleri kontrol edin.</li>
<li>Hata Ayƒ±klama: IDE&#39;≈Ñizde kesme noktalarƒ± ekleyin ve `DevTools` etkin olduƒüundan emin olarak uzaktan hata ayƒ±klamayƒ± test edin.</li>
</ul>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot DevTools i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Geli≈ütirme Ara√ßlarƒ±]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-devtools-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot Actuator]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-actuator</link>
      <description><![CDATA[Spring Boot Actuator kullanarak uygulamalarƒ±nƒ±zƒ± izleme ve y√∂netme. Endpointler, √∂zelle≈ütirme ve g√ºvenlik √∂rneklerini i√ßerir.]]></description>
      <pubDate>Wed, 18 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-actuator</guid>
      <content:encoded><![CDATA[<p>Spring Boot Actuator, uygulamalarƒ±nƒ±zƒ± izlemek ve y√∂netmek i√ßin prod√ºksiyon seviyesinde hazƒ±r √∂zellikler sunar. Bu rehber, Actuator&#39;ƒ±n yeteneklerini, nasƒ±l etkinle≈ütirileceƒüini ve endpointlerin nasƒ±l g√ºvenlik altƒ±na alƒ±nacaƒüƒ±nƒ± incelemektedir.</p>
<hr />
<h2>üåü Neden Spring Boot Actuator Kullanƒ±lƒ±r?</h2>
<p>Spring Boot Actuator geli≈ütiricilere ≈üunlarƒ± saƒülar:</p>
<ul>
<li>Uygulama saƒülƒ±ƒüƒ±nƒ± izleme</li>
<li>Metrik ve bilgi toplama</li>
<li>Operasyonel g√∂revler i√ßin y√∂netim endpointlerini yayƒ±nlamƒ±≈ü olma</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã A≈üaƒüƒ±daki ≈üartlarƒ±n kar≈üƒ±landƒ±ƒüƒ±ndan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºklenmi≈ü olmalƒ±</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Actuator&#39;ƒ± etkinle≈ütirmek i√ßin, projenize a≈üaƒüƒ±daki baƒüƒ±mlƒ±lƒ±klarƒ± ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-actuator&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Actuator Endpointlerini Etkinle≈ütirin</h2>
<p>Varsayƒ±lan olarak, Actuator uygulama bilgilerinin saƒülanmasƒ± i√ßin √ße≈üitli endpointler yayƒ±nlar. Bu endpointleri `application.properties` veya `application.yml` dosyasƒ±nda etkinle≈ütirebilirsiniz.</p>
<h3>√ñrnek Konfig√ºrasyon:</h3>
<pre><code class="language-properties">management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Actuator Endpointlerini Kullanmaya Ba≈ülayƒ±n</h2>
<p>ƒ∞≈üte sƒ±k kullanƒ±lan Actuator endpointleri:</p>
<ul>
<li>`/actuator/health`: Uygulama saƒülƒ±k durumu saƒülar.</li>
<li>`/actuator/info`: Uygulama metadatasƒ±nƒ± g√∂sterir.</li>
<li>`/actuator/metrics`: Uygulama performans metriklerini sunar.</li>
</ul>
<p>Bu endpointlere bir tarayƒ±cƒ± veya cURL gibi API ara√ßlarƒ± kullanarak eri≈üebilirsiniz.</p>
<p>√ñrnek:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8080/actuator/health</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Actuator Endpointlerini √ñzelle≈ütirin</h2>
<p>Actuator endpointlerini ihtiya√ßlarƒ±nƒ±za g√∂re √∂zelle≈ütirin. √ñrneƒüin, `/actuator/info` endpointi i√ßin ek metadata tanƒ±mlayabilirsiniz:</p>
<pre><code class="language-properties">info.app.name=Benim Uygulamam
info.app.version=1.0.0
info.app.description=Spring Boot Actuator √ñrneƒüi</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 5: Actuator Endpointlerini G√ºvenli Hale Getirin</h2>
<p>Prod√ºksiyon ortamlarƒ±nda, Actuator endpointlerinin g√ºvenli hale getirilmesi √∂nemlidir. Spring Security kullanarak eri≈üimi sƒ±nƒ±rlayabilirsiniz.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
public class SecurityConfig {

    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests()
                .requestMatchers(&quot;/actuator/**&quot;).hasRole(&quot;ADMIN&quot;)
                .anyRequest().authenticated()
            .and()
            .httpBasic();
        return http.build();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.config

import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.web.SecurityFilterChain

@Configuration
class SecurityConfig {

    @Bean
    fun securityFilterChain(http: HttpSecurity): SecurityFilterChain {
        http
            .authorizeHttpRequests()
                .requestMatchers(&quot;/actuator/**&quot;).hasRole(&quot;ADMIN&quot;)
                .anyRequest().authenticated()
            .and()
            .httpBasic()
        return http.build()
    }
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutla √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>Actuator endpointlerine eri≈üim saƒülamak i√ßin:</p>
<pre><code>http://localhost:8080/actuator/health</code></pre>
<hr />
<h2>üß™ API&#39;ƒ± Test Edin</h2>
<p>Actuator endpointlerini cURL veya tarayƒ±cƒ± kullanarak test edebilirsiniz:</p>
<ul>
<li>Health Endpoint:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/actuator/health</code></pre>
<ul>
<li>Info Endpoint:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/actuator/info</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot Actuator i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Actuator]]></category>
      <category><![CDATA[ƒ∞zleme]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-actuator-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile Aspect-Oriented Programming]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-aop</link>
      <description><![CDATA[Spring Boot ile AOP uygulamasƒ±nƒ± nasƒ±l yapacaƒüƒ±nƒ±zƒ± √∂ƒürenin. Java ve Kotlin √∂rnekleri ile temel kavramlar ve uygulamalar.]]></description>
      <pubDate>Wed, 18 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-aop</guid>
      <content:encoded><![CDATA[<p>Aspect-Oriented Programming (AOP), logging, transaction management ve g√ºvenlik gibi bir√ßok alana yayƒ±lan kesme noktalarƒ±nƒ± mod√ºler hale getiren bir yakla≈üƒ±mdƒ±r. Bu kƒ±lavuzda, Spring Boot kullanarak AOP uygulamasƒ± yapmayƒ± Java ve Kotlin ile g√∂stereceƒüiz.</p>
<hr />
<h2>üåü Neden AOP Kullanmalƒ±sƒ±nƒ±z?</h2>
<p>AOP, bir uygulamanƒ±n birden fazla b√∂l√ºm√ºn√º etkileyen logging veya g√ºvenlik gibi konularƒ± tekrar kullanƒ±labilir aspect&#39;ler haline getirmek i√ßin kullanƒ±lƒ±r. Bu y√∂ntem daha temiz kod, geli≈ütirilmi≈ü bakƒ±m kolaylƒ±ƒüƒ± ve azaltƒ±lmƒ±≈ü kod tekrarƒ± saƒülar.</p>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Java IDE (IntelliJ IDEA, Eclipse veya VS Code)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒülƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Projenize a≈üaƒüƒ±daki baƒülƒ±lƒ±klarƒ± dahil edin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-aop&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Bir Servis Tanƒ±mlayƒ±n</h2>
<p>AOP&#39;yi g√∂stermek i√ßin basit bir servis olu≈üturun.</p>
<h3>Java</h3>
<h3>Servis</h3>
<pre><code class="language-java">package com.example.demo.service;

import org.springframework.stereotype.Service;

@Service
public class UserService {

    public String getUserById(String id) {
        return &quot;ID&#39;ye sahip kullanƒ±cƒ±: &quot; + id;
    }

    public String getAllUsers() {
        return &quot;T√ºm kullanƒ±cƒ±lar alƒ±nƒ±yor.&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<h3>Servis</h3>
<pre><code class="language-kotlin">package com.example.demo.service

import org.springframework.stereotype.Service

@Service
class UserService {

    fun getUserById(id: String): String {
        return &quot;ID&#39;ye sahip kullanƒ±cƒ±: $id&quot;
    }

    fun getAllUsers(): String {
        return &quot;T√ºm kullanƒ±cƒ±lar alƒ±nƒ±yor.&quot;
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Bir Aspect Olu≈üturun</h2>
<p>Method √ßalƒ±≈üma detaylarƒ±nƒ± loglamak i√ßin bir aspect tanƒ±mlayƒ±n.</p>
<h3>Java</h3>
<h3>Aspect</h3>
<pre><code class="language-java">package com.example.demo.aspect;

import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;

@Aspect
@Component
public class LoggingAspect {

    private static final Logger logger = LoggerFactory.getLogger(LoggingAspect.class);

    @Before(&quot;execution(* com.example.demo.service.UserService.*(..))&quot;)
    public void logBefore() {
        logger.info(&quot;Method √ßalƒ±≈ütƒ±rƒ±lmaya ba≈ülandƒ±.&quot;);
    }
}</code></pre>
<h3>Kotlin</h3>
<h3>Aspect</h3>
<pre><code class="language-kotlin">package com.example.demo.aspect

import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.Before
import org.slf4j.LoggerFactory
import org.springframework.stereotype.Component

@Aspect
@Component
class LoggingAspect {

    private val logger = LoggerFactory.getLogger(LoggingAspect::class.java)

    @Before(&quot;execution(* com.example.demo.service.UserService.*(..))&quot;)
    fun logBefore() {
        logger.info(&quot;Y√∂ntem √ßalƒ±≈ütƒ±rƒ±lmaya ba≈ülandƒ±.&quot;)
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Bir Controller Olu≈üturun</h2>
<p>Servis methodlarƒ±nƒ± bir REST controller √ºzerinden sunun.</p>
<h3>Java</h3>
<h3>Controller</h3>
<pre><code class="language-java">package com.example.demo.controller;

import com.example.demo.service.UserService;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping(&quot;/api/users&quot;)
@RequiredArgsConstructor
public class UserController {

    private final UserService userService;

    @GetMapping(&quot;/{id}&quot;)
    public String getUserById(@PathVariable String id) {
        return userService.getUserById(id);
    }

    @GetMapping
    public String getAllUsers() {
        return userService.getAllUsers();
    }
}</code></pre>
<h3>Kotlin</h3>
<h3>Controller</h3>
<pre><code class="language-kotlin">package com.example.demo.controller

import com.example.demo.service.UserService
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.PathVariable
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequestMapping(&quot;/api/users&quot;)
class UserController(
    private val userService: UserService
) {

    @GetMapping(&quot;/{id}&quot;)
    fun getUserById(@PathVariable id: String): String = userService.getUserById(id)

    @GetMapping
    fun getAllUsers(): String = userService.getAllUsers()
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>A≈üaƒüƒ±daki komutlarla uygulamayƒ± √ßalƒ±≈ütƒ±rƒ±n:</p>
<ul>
<li>Spring Boot (Java/Kotlin):</li>
</ul>
<p>```bash ./mvnw spring-boot:run ```</p>
<p>API&#39;ye ≈üu adresten eri≈üebilirsiniz: `http://localhost:8080/api/users`.</p>
<hr />
<h2>üß™ API&#39;yi Test Edin</h2>
<p>API&#39;yi a≈üaƒüƒ±daki cURL komutlarƒ± ile test edebilirsiniz:</p>
<ul>
<li>T√ºm kullanƒ±cƒ±larƒ± getir:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/users</code></pre>
<ul>
<li>Bir ID&#39;ye g√∂re kullanƒ±cƒ± getir:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/users/1</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile Aspect-Oriented Programming i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[AOP]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-aop-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile Dependency Injection]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-di</link>
      <description><![CDATA[Spring Boot ile Baƒüƒ±mlƒ±lƒ±k Enjeksiyonu (Dependency Injection - DI) nasƒ±l √ßalƒ±≈üƒ±r? Java ve Kotlin √∂rnekleriyle temel kavramlar, anotasyonlar ve pratik kullanƒ±m senaryolarƒ±nƒ± √∂ƒürenin.]]></description>
      <pubDate>Wed, 18 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-di</guid>
      <content:encoded><![CDATA[<p>Baƒüƒ±mlƒ±lƒ±k Enjeksiyonu (Dependency Injection - DI), Spring Boot&#39;un temel konseptlerinden biridir ve daha gev≈üek baƒülƒ±lƒ±k ve artan test edilebilirlik saƒülar. Bu kƒ±lavuz, Java ve Kotlin ile Spring Boot&#39;ta DI kullanƒ±mƒ±nƒ± pratik √∂rneklerle a√ßƒ±klar.</p>
<hr />
<h2>üåü Neden Baƒüƒ±mlƒ±lƒ±k Enjeksiyonu Kullanmalƒ±yƒ±z?</h2>
<p>Baƒüƒ±mlƒ±lƒ±k Enjeksiyonu, sƒ±nƒ±flara baƒüƒ±mlƒ±lƒ±klarƒ± manuel olarak olu≈üturmadan enjekte etmeyi saƒülar. Bu, ≈üu avantajlarƒ± sunar:</p>
<ul>
<li>Daha mod√ºler kod</li>
<li>Testlerin kolayla≈ütƒ±rƒ±lmasƒ±</li>
<li>Daha kolay bakƒ±m</li>
</ul>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã A≈üaƒüƒ±dakilere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle y√ºkl√º</li>
<li>üî§ Bir Java IDE (√∂rneƒüin, IntelliJ IDEA, Eclipse)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleyin</h2>
<p>Gerekli Spring Boot baƒüƒ±mlƒ±lƒ±klarƒ±nƒ± ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Bir Servis Olu≈üturun</h2>
<p>Baƒüƒ±mlƒ±lƒ±k Enjeksiyonu&#39;nu g√∂stermek i√ßin basit bir servis tanƒ±mlayƒ±n.</p>
<h3>Java</h3>
<h3>Servis</h3>
<pre><code class="language-java">package com.example.demo.service;

import org.springframework.stereotype.Service;

@Service
public class UserService {

    public String getUserById(String id) {
        return &quot;ID ile kullanƒ±cƒ±: &quot; + id;
    }

    public String getAllUsers() {
        return &quot;T√ºm kullanƒ±cƒ±lar alƒ±nƒ±yor.&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<h3>Servis</h3>
<pre><code class="language-kotlin">package com.example.demo.service

import org.springframework.stereotype.Service

@Service
class UserService {

    fun getUserById(id: String): String {
        return &quot;ID ile kullanƒ±cƒ±: $id&quot;
    }

    fun getAllUsers(): String {
        return &quot;T√ºm kullanƒ±cƒ±lar alƒ±nƒ±yor.&quot;
    }
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Baƒüƒ±mlƒ±lƒ±klarƒ± Enjekte Edin</h2>
<p>Servisi diƒüer bile≈üenlere enjekte etmek i√ßin anotasyonlarƒ± kullanƒ±n.</p>
<h3>Java</h3>
<h3>Controller</h3>
<pre><code class="language-java">package com.example.demo.controller;

import com.example.demo.service.UserService;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping(&quot;/api/users&quot;)
@RequiredArgsConstructor
public class UserController {

    private final UserService userService;

    @GetMapping(&quot;/{id}&quot;)
    public String getUserById(@PathVariable String id) {
        return userService.getUserById(id);
    }

    @GetMapping
    public String getAllUsers() {
        return userService.getAllUsers();
    }
}</code></pre>
<h3>Kotlin</h3>
<h3>Controller</h3>
<pre><code class="language-kotlin">package com.example.demo.controller

import com.example.demo.service.UserService
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.PathVariable
import org.springframework.web.bind.annotation.RequestMapping
import org.springframework.web.bind.annotation.RestController

@RestController
@RequestMapping(&quot;/api/users&quot;)
class UserController(
    private val userService: UserService
) {

    @GetMapping(&quot;/{id}&quot;)
    fun getUserById(@PathVariable id: String): String = userService.getUserById(id)

    @GetMapping
    fun getAllUsers(): String = userService.getAllUsers()
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rƒ±n</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutlarla √ßalƒ±≈ütƒ±rƒ±n:</p>
<ul>
<li>Spring Boot (Java/Kotlin):</li>
</ul>
<p>```bash ./mvnw spring-boot:run ```</p>
<p>API&#39;ye ≈üu adresten eri≈üin: `http://localhost:8080/api/users`.</p>
<hr />
<h2>üß™ API&#39;yi Test Edin</h2>
<p>API&#39;yi a≈üaƒüƒ±daki cURL komutlarƒ±yla test edebilirsiniz:</p>
<ul>
<li>T√ºm kullanƒ±cƒ±larƒ± alƒ±n:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/users</code></pre>
<ul>
<li>Belirli bir kullanƒ±cƒ±yƒ± alƒ±n:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/users/1</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile Dependency Injection i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Baƒüƒ±mlƒ±lƒ±k Enjeksiyonu]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-di-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Object-Relational Mapping]]></title>
      <link>https://suaybsimsek.com/tr/posts/object-relational-mapping</link>
      <description><![CDATA[Spring Boot kullanarak Java, Kotlin ve Go (Gin) ile PostgreSQL entegrasyonu ve temel CRUD i≈ülemlerini i√ßeren bir ORM tabanlƒ± uygulamanƒ±n nasƒ±l kurulacaƒüƒ±nƒ± √∂ƒürenin.]]></description>
      <pubDate>Mon, 16 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/object-relational-mapping</guid>
      <content:encoded><![CDATA[<p>Object-Relational Mapping (ORM), modern uygulamalarda veritabanƒ± i≈ülemlerini basitle≈ütirir. Bu kƒ±lavuzda, Spring Boot ve Gin √ßer√ßevesini kullanarak PostgreSQL ile ORM nasƒ±l kurulacaƒüƒ±nƒ± √∂ƒüreneceksiniz.</p>
<hr />
<h2>üåü Neden ORM Kullanmalƒ±yƒ±z?</h2>
<p>ORM, nesne y√∂nelimli programlama ile ili≈ükisel veritabanlarƒ± arasƒ±ndaki bo≈üluƒüu kapatarak nesneleri doƒürudan veritabanƒ± tablolarƒ±na e≈üler. Bu, manuel SQL sorgularƒ±na olan ihtiyacƒ± ortadan kaldƒ±rƒ±r, hatalarƒ± azaltƒ±r ve geli≈ütiricilerin verimliliƒüini artƒ±rƒ±r.</p>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìú ≈ûunlara sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>‚òï Java Geli≈ütirme Kiti (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Bir Java IDE</li>
<li>üêò PostgreSQL kurulu ve √ßalƒ±≈üƒ±r durumda</li>
</ul>
<p>Go i√ßin:</p>
<ul>
<li>üîß Golang 1.17+ kurulu</li>
<li>üîÑ Projenizde go.mod ba≈ülatƒ±lmƒ±≈ü</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleme</h2>
<p>Spring Boot projesi kurmak ve ORM entegrasyonu saƒülamak i√ßin ≈üu adƒ±mlarƒ± izleyin:</p>
<h3>Baƒüƒ±mlƒ±lƒ±klarƒ± Ekleme</h3>
<p>Spring Boot projeleri i√ßin a≈üaƒüƒ±daki baƒüƒ±mlƒ±lƒ±klarƒ± projenize ekleyin:</p>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.postgresql&lt;/groupId&gt;
  &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;
implementation &#39;org.postgresql:postgresql&#39;</code></pre>
<h3>Veritabanƒ±nƒ± Yapƒ±landƒ±rma</h3>
<p>PostgreSQL baƒülantƒ±nƒ±zƒ± `application.properties` veya `application.yml` dosyasƒ±na ≈üu ≈üekilde ayarlayƒ±n:</p>
<pre><code class="language-properties">spring.datasource.url=jdbc:postgresql://localhost:5432/demo
spring.datasource.username=kullanici_adiniz
spring.datasource.password=sifreniz
spring.jpa.hibernate.ddl-auto=update</code></pre>
<h3>Projeyi Ba≈ülatma</h3>
<p>Hen√ºz yapmadƒ±ysanƒ±z, [Spring Initializr](https://start.spring.io/) kullanarak projenizi olu≈üturun:</p>
<p>1. Spring Web, Spring Data JPA ve PostgreSQL Driver baƒüƒ±mlƒ±lƒ±klarƒ±nƒ± se√ßin. 2. Projeyi indirin ve tercih ettiƒüiniz IDE&#39;ye aktarƒ±n.</p>
<p>Go projeleri i√ßin:</p>
<ul>
<li>Gin √áer√ßevesini ve GORM&#39;u Kurun:</li>
</ul>
<pre><code class="language-bash"># Gin √ßer√ßevesini kurun
go get -u github.com/gin-gonic/gin

# GORM PostgreSQL s√ºr√ºc√ºs√ºn√º kurun
go get -u gorm.io/driver/postgres

# GORM ORM k√ºt√ºphanesini kurun
go get -u gorm.io/gorm</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Modeli Tanƒ±mlayƒ±n ve REST Controller Uygulayƒ±n</h2>
<p>Bu adƒ±m, entity/model, repository ve REST controller olu≈üturulmasƒ±nƒ± birle≈ütirir.</p>
<h3>Java</h3>
<h3>Entity</h3>
<pre><code class="language-java">package com.example.demo.entity;

import jakarta.persistence.*;
import lombok.Data;

@Data
@Entity
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    private String email;
}</code></pre>
<h3>Repository</h3>
<pre><code class="language-java">package com.example.demo.repository;

import com.example.demo.entity.User;
import org.springframework.data.jpa.repository.JpaRepository;

public interface UserRepository extends JpaRepository&lt;User, Long&gt; {
}</code></pre>
<h3>REST Controller</h3>
<pre><code class="language-java">package com.example.demo.controller;

import com.example.demo.entity.User;
import com.example.demo.repository.UserRepository;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping(&quot;/api/users&quot;)
import lombok.RequiredArgsConstructor;

@RequiredArgsConstructor
public class UserController {

  private final UserRepository userRepository;

  @GetMapping
  public List&lt;User&gt; getAllUsers() {
    return userRepository.findAll();
  }

  @PostMapping
  public User createUser(@RequestBody User user) {
    return userRepository.save(user);
  }
}</code></pre>
<h3>Kotlin</h3>
<h3>Entity</h3>
<pre><code class="language-kotlin">package com.example.demo.entity

import jakarta.persistence.*

@Entity
class User(
  @Id
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  val id: Long = 0,

  var name: String,

  var email: String
)</code></pre>
<h3>Repository</h3>
<pre><code class="language-kotlin">package com.example.demo.repository

import com.example.demo.entity.User
import org.springframework.data.jpa.repository.JpaRepository

interface UserRepository : JpaRepository&lt;User, Long&gt;</code></pre>
<h3>REST Controller</h3>
<pre><code class="language-kotlin">package com.example.demo.controller

import com.example.demo.entity.User
import com.example.demo.repository.UserRepository
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/api/users&quot;)
class UserController(
  private val userRepository: UserRepository
) {

  @GetMapping
  fun getAllUsers(): List&lt;User&gt; = userRepository.findAll()

  @PostMapping
  fun createUser(@RequestBody user: User): User = userRepository.save(user)
}</code></pre>
<h3>Go</h3>
<h3>Model ve Veritabanƒ± Baƒülantƒ±sƒ±</h3>
<pre><code class="language-go">package main

import (
	&quot;gorm.io/driver/postgres&quot;
	&quot;gorm.io/gorm&quot;
)

var DB *gorm.DB

func connectDatabase() {
	dsn := &quot;host=localhost user=kullanici_adiniz password=sifreniz dbname=demo port=5432 sslmode=disable&quot;
	db, err := gorm.Open(postgres.Open(dsn), &amp;gorm.Config{})
	if err != nil {
		panic(&quot;Veritabanƒ±na baƒülanƒ±lamadƒ±!&quot;)
	}

	DB = db
	DB.AutoMigrate(&amp;User{})
}

type User struct {
	ID    uint   `json:&quot;id&quot; gorm:&quot;primaryKey&quot;`
	Name  string `json:&quot;name&quot;`
	Email string `json:&quot;email&quot;`
}</code></pre>
<h3>Handlerlar</h3>
<pre><code class="language-go">package main

import (
	&quot;github.com/gin-gonic/gin&quot;
)

func getUsers(c *gin.Context) {
	var users []User
	DB.Find(&amp;users)
	c.JSON(200, users)
}

func createUser(c *gin.Context) {
	var user User
	if err := c.ShouldBindJSON(&amp;user); err != nil {
		c.JSON(400, gin.H{&quot;error&quot;: err.Error()})
		return
	}
	DB.Create(&amp;user)
	c.JSON(201, user)
}

func main() {
	r := gin.Default()
	connectDatabase()

	r.GET(&quot;/api/users&quot;, getUsers)
	r.POST(&quot;/api/users&quot;, createUser)

	r.Run() // 0.0.0.0:8080 √ºzerinde dinle ve hizmet et
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamalarƒ± √áalƒ±≈ütƒ±rma</h2>
<ul>
<li>Spring Boot:</li>
</ul>
<p>```bash ./mvnw spring-boot:run ```</p>
<ul>
<li>Gin:</li>
</ul>
<p>```bash go run main.go ```</p>
<hr />
<h2>üß™ cURL ile Test Etme</h2>
<p>API&#39;yi a≈üaƒüƒ±daki cURL komutlarƒ± ile test edebilirsiniz:</p>
<p>T√ºm Kullanƒ±cƒ±larƒ± Getir:</p>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/users</code></pre>
<p>Yeni Bir Kullanƒ±cƒ± Olu≈ütur:</p>
<pre><code class="language-bash">curl -X POST http://localhost:8080/api/users \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;name&quot;: &quot;John Doe&quot;, &quot;email&quot;: &quot;johndoe@example.com&quot;}&#39;</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Object-Relational Mapping i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Go]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Gin]]></category>
      <category><![CDATA[ORM]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/orm-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[REST API‚Äôlerde Girdi Doƒürulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/rest-api-input-validation</link>
      <description><![CDATA[Spring Boot ve Gin ile Java, Kotlin ve Go‚Äôda REST API girdi doƒürulamasƒ±nƒ± uygulamayƒ± √∂ƒürenin. Anotasyon, √∂zel doƒürulama ve hata y√∂netimi √∂rnekleri i√ßerir.]]></description>
      <pubDate>Sun, 15 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/rest-api-input-validation</guid>
      <content:encoded><![CDATA[<p>REST API‚Äôlerde girdi doƒürulama, g√ºvenli ve saƒülam web servisleri olu≈üturmak i√ßin √ßok √∂nemlidir. Bu makalede, Spring Boot kullanarak Java ve Kotlin‚Äôde, Gin framework‚Äô√º ile Go‚Äôda doƒürulamanƒ±n nasƒ±l yapƒ±lacaƒüƒ±nƒ± adƒ±m adƒ±m inceleyeceƒüiz.</p>
<hr />
<h2>üåü Girdi Doƒürulama Neden √ñnemlidir?</h2>
<p>Doƒürulama, API‚Äônƒ±za g√∂nderilen verilerin beklenen formatlara uygun olmasƒ±nƒ± saƒülayarak SQL Enjeksiyonu, XSS ve hatalƒ± veri giri≈üi gibi potansiyel g√ºvenlik a√ßƒ±klarƒ±nƒ± engeller.</p>
<hr />
<h2>üß™ Adƒ±m 1: Doƒürulama Baƒüƒ±mlƒ±lƒ±klarƒ±nƒ± Ekleyin</h2>
<h3>Spring Boot Projeleri i√ßin:</h3>
<ul>
<li>Maven:</li>
</ul>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<ul>
<li>Gradle:</li>
</ul>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-validation&#39;</code></pre>
<h3>Gin Framework (Go) i√ßin:</h3>
<pre><code class="language-bash"># Gin framework√ºn√º y√ºkleyin
go get -u github.com/gin-gonic/gin

# Doƒürulama paketi ekleyin
go get -u github.com/go-playground/validator/v10</code></pre>
<hr />
<h2>üß™ Adƒ±m 2: Doƒürulama Kurallarƒ± ile Bir DTO Tanƒ±mlayƒ±n</h2>
<p>Alanlara doƒürulama kurallarƒ±nƒ± tanƒ±mlamak i√ßin anotasyonlar kullanƒ±n. √ñrnekler: `@NotNull`, `@Size`, `@Pattern`.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.dto;

import jakarta.validation.constraints.NotNull;
import jakarta.validation.constraints.Size;
import lombok.Data;

@Data
public class TodoRequest {

    @NotNull(message = &quot;Ba≈ülƒ±k zorunludur&quot;)
    @Size(min = 3, max = 50, message = &quot;Ba≈ülƒ±k 3 ile 50 karakter arasƒ±nda olmalƒ±dƒ±r&quot;)
    private String title;

    private boolean completed;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.dto

import jakarta.validation.constraints.NotNull
import jakarta.validation.constraints.Size

data class TodoRequest(
    @field:NotNull(message = &quot;Ba≈ülƒ±k zorunludur&quot;)
    @field:Size(min = 3, max = 50, message = &quot;Ba≈ülƒ±k 3 ile 50 karakter arasƒ±nda olmalƒ±dƒ±r&quot;)
    val title: String?,

    val completed: Boolean = false
)</code></pre>
<h3>Go</h3>
<pre><code class="language-go">package dto

import (
    &quot;github.com/go-playground/validator/v10&quot;
)

type TodoRequest struct {
    Title     string `validate:&quot;required,min=3,max=50&quot;`
    Completed bool   `validate:&quot;&quot;`
}

var validate = validator.New()

func ValidateTodoRequest(todo TodoRequest) error {
    return validate.Struct(todo)
}</code></pre>
<hr />
<h2>üß™ Adƒ±m 3: Doƒürulama ile Bir Controller Olu≈üturun</h2>
<p>Doƒürulamayƒ± REST endpoint‚Äôlerinize entegre edin.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.controller;

import com.example.demo.dto.TodoRequest;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping(&quot;/api/todos&quot;)
public class TodoController {

    @PostMapping
    public String createTodo(@Validated @RequestBody TodoRequest request) {
        return &quot;Olu≈üturulan g√∂rev: &quot; + request.getTitle();
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.controller

import com.example.demo.dto.TodoRequest
import org.springframework.validation.annotation.Validated
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/api/todos&quot;)
class TodoController {

    @PostMapping
    fun createTodo(@Validated @RequestBody request: TodoRequest): String {
        return &quot;Olu≈üturulan g√∂rev: ${request.title}&quot;
    }
}</code></pre>
<h3>Go</h3>
<pre><code class="language-go">package controller

import (
    &quot;dto&quot;
    &quot;github.com/gin-gonic/gin&quot;
    &quot;net/http&quot;
)

func CreateTodoHandler(c *gin.Context) {
    var todo dto.TodoRequest

    if err := c.ShouldBindJSON(&amp;todo); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{&quot;error&quot;: err.Error()})
        return
    }

    if err := dto.ValidateTodoRequest(todo); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{&quot;error&quot;: err.Error()})
        return
    }

    c.JSON(http.StatusOK, gin.H{&quot;message&quot;: &quot;Olu≈üturulan g√∂rev&quot;, &quot;title&quot;: todo.Title})
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: Hata Mesajlarƒ±nƒ± Y√∂netin</h2>
<p>Hata mesajlarƒ±nƒ± daha kullanƒ±cƒ± dostu olacak ≈üekilde d√ºzelleyin.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.exception;

import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;
import org.springframework.web.bind.MethodArgumentNotValidException;

import java.util.HashMap;
import java.util.Map;

@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(MethodArgumentNotValidException.class)
    public Map&lt;String, String&gt; handleValidationExceptions(MethodArgumentNotValidException ex) {
        Map&lt;String, String&gt; errors = new HashMap&lt;&gt;();
        ex.getBindingResult().getFieldErrors().forEach(error -&gt; errors.put(error.getField(), error.getDefaultMessage()));
        return errors;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.exception

import org.springframework.http.HttpStatus
import org.springframework.web.bind.annotation.ExceptionHandler
import org.springframework.web.bind.annotation.RestControllerAdvice
import org.springframework.web.bind.MethodArgumentNotValidException

@RestControllerAdvice
class GlobalExceptionHandler {

    @ExceptionHandler(MethodArgumentNotValidException::class)
    fun handleValidationExceptions(ex: MethodArgumentNotValidException): Map&lt;String, String&gt; {
        return ex.bindingResult.fieldErrors.associate { it.field to it.defaultMessage.orEmpty() }
    }
}</code></pre>
<h3>Go</h3>
<pre><code class="language-go">package middleware

import (
    &quot;github.com/gin-gonic/gin&quot;
    &quot;net/http&quot;
)

func ErrorHandler() gin.HandlerFunc {
    return func(c *gin.Context) {
        c.Next()

        if len(c.Errors) &gt; 0 {
            c.JSON(http.StatusBadRequest, gin.H{&quot;errors&quot;: c.Errors.JSON()})
        }
    }
}</code></pre>
<hr />
<h3>main.go √ñrneƒüi</h3>
<p>Gin uygulamasƒ± i√ßin `main.go` dosyasƒ±nƒ±n bir √∂rneƒüi:</p>
<pre><code class="language-go">package main

import (
	&quot;controller&quot;
	&quot;github.com/gin-gonic/gin&quot;
)

func main() {
	r := gin.Default()

	r.POST(&quot;/api/todos&quot;, controller.CreateTodoHandler)

	r.Run() // Sunucu: http://localhost:8080
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Adƒ±m 5: Uygulamayƒ± √áalƒ±≈ütƒ±rƒ±n</h2>
<h3>Spring Boot (Java/Kotlin)</h3>
<p>Spring Boot uygulamasƒ±nƒ± terminal veya IDE‚Äônizden √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">./mvnw spring-boot:run # Maven projeleri i√ßin
./gradlew bootRun       # Gradle projeleri i√ßin</code></pre>
<p>API adresi: `http://localhost:8080/api/todos`</p>
<h3>Gin (Go)</h3>
<p>Go uygulamasƒ±nƒ± √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">go run main.go</code></pre>
<p>API adresi: `http://localhost:8080/api/todos`</p>
<hr />
<h2>üß™ cURL ile Test Etme</h2>
<p>API‚Äôyƒ± test etmek i√ßin cURL komutlarƒ±:</p>
<ul>
<li>Yeni Bir G√∂rev Ekleme:</li>
</ul>
<pre><code class="language-bash">curl -X POST http://localhost:8080/api/todos \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;title&quot;: &quot;Yeni G√∂rev&quot;, &quot;completed&quot;: false}&#39;</code></pre>
<ul>
<li>T√ºm G√∂revleri Getirme:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/todos</code></pre>
<ul>
<li>Doƒürulama Hatalarƒ±nƒ± Test Etme:</li>
</ul>
<p>Ge√ßersiz bir istek g√∂nderin:</p>
<pre><code class="language-bash">curl -X POST http://localhost:8080/api/todos \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;title&quot;: &quot;&quot;}&#39;</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile REST API‚Äôlerde Girdi Doƒürulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Go]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Gin]]></category>
      <category><![CDATA[Doƒürulama]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/input-validation-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring GraphQL ile API Olu≈üturma]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-graphql</link>
      <description><![CDATA[Java ve Kotlin kullanarak Spring for GraphQL ile GraphQL API\u201leri nasƒ±l olu≈üturacaƒüƒ±nƒ±zƒ± √∂ƒürenin. ≈ûema olu≈üturma, sorgu i≈üleme ve entegrasyonu i√ßerir.]]></description>
      <pubDate>Sun, 15 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-graphql</guid>
      <content:encoded><![CDATA[<p>Spring for GraphQL, Spring Boot ile entegre √ßalƒ±≈üan GraphQL API&#39;lerinin geli≈ütirilmesini kolayla≈ütƒ±rƒ±r. Bu rehber, Java ve Kotlin kullanarak bir GraphQL API&#39;si olu≈üturmanƒ±zƒ±, ≈üema tanƒ±mlamayƒ±, sorgu i≈üleme ve baƒülƒ±mlƒ±klarƒ±n enjekte edilmesini adƒ±m adƒ±m a√ßƒ±klƒ±yor.</p>
<hr />
<h2>üåü Neden GraphQL Kullanƒ±lmalƒ±?</h2>
<p>GraphQL, istemcilerin sadece gerekli olan verileri talep etmesine izin vererek, REST&#39;e g√∂re fazla veya eksik veri alma problemini azaltƒ±r. Ayrƒ±ca, g√º√ßl√º tip desteƒüi sunar ve verimli veri alma saƒülar, modern API&#39;ler i√ßin pop√ºler bir se√ßenek haline gelir.</p>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã A≈üaƒüƒ±daki bile≈üenlerin kurulu olduƒüundan emin olun:</p>
<ul>
<li>‚òï Java Development Kit (JDK) 17+</li>
<li>üì¶ Maven veya Gradle kurulu</li>
<li>üî§ Bir Java IDE (IntelliJ IDEA, Eclipse vb.)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Baƒülƒ±mlƒ±klarƒ± Ekleme</h2>
<p>Spring for GraphQL&#39;i etkinle≈ütirmek i√ßin a≈üaƒüƒ±daki baƒülƒ±mlƒ±klarƒ± projenize ekleyin.</p>
<h3>Maven:</h3>
<pre><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-graphql&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<h3>Gradle:</h3>
<pre><code class="language-groovy">implementation &#39;org.springframework.boot:spring-boot-starter-graphql&#39;</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: GraphQL ≈ûemasƒ±nƒ± Tanƒ±mlama</h2>
<p>`src/main/resources/graphql` dizini altƒ±nda `schema.graphqls` adlƒ± bir dosya olu≈üturun.</p>
<pre><code class="language-graphql">type Query {
  getUser(id: ID!): User
  getUsers: [User]
}

type User {
  id: ID!
  name: String!
  email: String!
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Veri Modeli ve Servislerin Tanƒ±mlanmasƒ±</h2>
<p>Sorgularƒ± i≈ülemek i√ßin veri modelinizi ve servis katmanƒ±nƒ± tanƒ±mlayƒ±n.</p>
<h3>Java</h3>
<h3>Entity</h3>
<pre><code class="language-java">package com.example.demo.model;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class User {
    private String id;
    private String name;
    private String email;
}</code></pre>
<h3>Servis</h3>
<pre><code class="language-java">package com.example.demo.service;

import com.example.demo.model.User;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;
import java.util.stream.Stream;

@Service
public class UserService {

    private final Map&lt;String, User&gt; userData = Stream.of(
        new User(&quot;1&quot;, &quot;Alice&quot;, &quot;alice@example.com&quot;),
        new User(&quot;2&quot;, &quot;Bob&quot;, &quot;bob@example.com&quot;)
    ).collect(Collectors.toMap(User::getId, user -&gt; user));

    public User getUser(String id) {
        return userData.get(id);
    }

    public List&lt;User&gt; getUsers() {
        return List.copyOf(userData.values());
    }
}</code></pre>
<hr />
<h3>Kotlin</h3>
<h3>Entity</h3>
<pre><code class="language-kotlin">package com.example.demo.model

data class User(
    val id: String,
    val name: String,
    val email: String
)</code></pre>
<h3>Servis</h3>
<pre><code class="language-kotlin">package com.example.demo.service

import com.example.demo.model.User
import org.springframework.stereotype.Service

@Service
class UserService {

    private val userData = mapOf(
        &quot;1&quot; to User(&quot;1&quot;, &quot;Alice&quot;, &quot;alice@example.com&quot;),
        &quot;2&quot; to User(&quot;2&quot;, &quot;Bob&quot;, &quot;bob@example.com&quot;)
    )

    fun getUser(id: String): User? = userData[id]

    fun getUsers(): List&lt;User&gt; = userData.values.toList()
}</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 4: GraphQL Controllerƒ± Uygulama</h2>
<p>GraphQL sorgularƒ±nƒ± ve mutasyonlarƒ±nƒ± i≈ülemek i√ßin `@Controller` anotasyonunu kullanƒ±n.</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.controller;

import com.example.demo.model.User;
import com.example.demo.service.UserService;
import lombok.RequiredArgsConstructor;
import org.springframework.graphql.data.method.annotation.QueryMapping;
import org.springframework.stereotype.Controller;

import java.util.List;

@Controller
@RequiredArgsConstructor
public class UserController {

    private final UserService userService;

    @QueryMapping
    public User getUser(String id) {
        return userService.getUser(id);
    }

    @QueryMapping
    public List&lt;User&gt; getUsers() {
        return userService.getUsers();
    }
}</code></pre>
<hr />
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.controller

import com.example.demo.model.User
import com.example.demo.service.UserService
import org.springframework.graphql.data.method.annotation.QueryMapping
import org.springframework.stereotype.Controller

@Controller
class UserController(
    private val userService: UserService
) {

    @QueryMapping
    fun getUser(id: String): User? = userService.getUser(id)

    @QueryMapping
    fun getUsers(): List&lt;User&gt; = userService.getUsers()
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>Uygulamayƒ± a≈üaƒüƒ±daki komutlarla √ßalƒ±≈ütƒ±rƒ±n:</p>
<ul>
<li>Spring Boot (Java/Kotlin):</li>
</ul>
<p>```bash ./mvnw spring-boot:run ```</p>
<p>GraphQL Playground&#39;a eri≈üim saƒülamak i√ßin `http://localhost:8080/graphiql` adresine gidin.</p>
<hr />
<h2>üß™ GraphQL API&#39;sini Test Etme</h2>
<p>API&#39;nizi test etmek i√ßin a≈üaƒüƒ±daki sorgularƒ± kullanabilirsiniz:</p>
<ul>
<li>Bir kullanƒ±cƒ±yƒ± ID&#39;ye g√∂re getir:</li>
</ul>
<pre><code class="language-graphql">query {
  getUser(id: &quot;1&quot;) {
    id
    name
    email
  }
}</code></pre>
<ul>
<li>T√ºm kullanƒ±cƒ±larƒ± getir:</li>
</ul>
<pre><code class="language-graphql">query {
  getUsers {
    id
    name
    email
  }
}</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring GraphQL ile API Olu≈üturma i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[GraphQL]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-graphql-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Gin - ƒ∞lk Uygulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/golang-gin-first-application</link>
      <description><![CDATA[Sƒ±fƒ±rdan ilk Golang Gin uygulamanƒ±zƒ± olu≈üturmanƒ±za yardƒ±mcƒ± olacak, yeni ba≈ülayanlar i√ßin rehber. Temelleri √∂ƒürenin ve Gin ile yolculuƒüunuza ba≈ülayƒ±n.]]></description>
      <pubDate>Sat, 14 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/golang-gin-first-application</guid>
      <content:encoded><![CDATA[<p>Gin, Golang ile y√ºksek performanslƒ± web uygulamalarƒ± olu≈üturma s√ºrecini basitle≈ütirir. Bu rehberde, adƒ±m adƒ±m ilk Gin uygulamanƒ±zƒ± nasƒ±l olu≈üturacaƒüƒ±nƒ±zƒ± g√∂stereceƒüiz.</p>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã Ba≈ülamadan √∂nce a≈üaƒüƒ±daki gereksinimlere sahip olduƒüunuzdan emin olun:</p>
<ul>
<li>üîß Golang 1.17+ kurulu</li>
<li>üóç Bir metin edit√∂r√º veya IDE (√∂r. Visual Studio Code, GoLand veya Vim)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Gin Projenizi Olu≈üturma</h2>
<p>ƒ∞lk Gin projenizi a≈üaƒüƒ±daki adƒ±mlarƒ± izleyerek ayarlayabilirsiniz:</p>
<p>1. Bir Go Mod√ºl√º Ba≈ülatƒ±n</p>
<pre><code class="language-bash">mkdir gin-first-app
cd gin-first-app
go mod init gin-first-app</code></pre>
<p>2. Gin Kurulumu</p>
<pre><code class="language-bash">go get -u github.com/gin-gonic/gin</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: ƒ∞lk Endpoint‚Äôinizi Yazma</h2>
<p>Basit bir &quot;hello&quot; mesajƒ± g√∂nderen bir endpoint yazalƒ±m:</p>
<p>`main.go` adƒ±nda bir dosya olu≈üturun ve a≈üaƒüƒ±daki i√ßeriƒüi ekleyin:</p>
<pre><code class="language-go">package main

import (
	&quot;github.com/gin-gonic/gin&quot;
)

func main() {
	r := gin.Default()

	r.GET(&quot;/hello&quot;, func(c *gin.Context) {
		c.JSON(200, gin.H{
			&quot;message&quot;: &quot;Merhaba, Gin!&quot;,
		})
	})

	r.Run() // 0.0.0.0:8080 √ºzerinde dinler ve hizmet verir
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Adƒ±m 3: Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>1. Proje klas√∂r√ºn√ºzde bir terminal a√ßƒ±n. 2. Uygulamanƒ±zƒ± √ßalƒ±≈ütƒ±rmak i√ßin a≈üaƒüƒ±daki komutu √ßalƒ±≈ütƒ±rƒ±n:</p>
<pre><code class="language-bash">go run main.go</code></pre>
<p>3. Endpoint&#39;e ≈üu adresten eri≈üin: ``` http://localhost:8080/hello ```</p>
<p>Yanƒ±t:</p>
<pre><code class="language-json">{
  &quot;message&quot;: &quot;Merhaba, Gin!&quot;
}</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Gin - ƒ∞lk Uygulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Go]]></category>
      <category><![CDATA[Gin]]></category>
      <category><![CDATA[Ba≈ülangƒ±√ß Rehberi]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/golang-gin-first-app-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot ile REST API Geli≈ütirme]]></title>
      <link>https://suaybsimsek.com/tr/posts/building-a-rest-api-with-spring-boot</link>
      <description><![CDATA[Spring Boot kullanarak REST API nasƒ±l geli≈ütirilir? HTTP metodlarƒ±, JSON veri i≈üleme, Lombok entegrasyonu ve curl ile test etme.]]></description>
      <pubDate>Tue, 10 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/building-a-rest-api-with-spring-boot</guid>
      <content:encoded><![CDATA[<p>Spring Boot, RESTful web servislerini hƒ±zlƒ± ve kolay bir ≈üekilde geli≈ütirmek i√ßin m√ºkemmel bir ara√ßtƒ±r. Bu yazƒ±da, Spring Boot kullanarak bir REST API&#39;nin nasƒ±l olu≈üturulacaƒüƒ±nƒ± adƒ±m adƒ±m g√∂receƒüiz.</p>
<hr />
<h2>üåü REST API Nedir?</h2>
<p>REST (Representational State Transfer), web servisleri tasarlamak i√ßin kullanƒ±lan bir mimari stilidir. ƒ∞stemciler ile sunucular arasƒ±ndaki ileti≈üimde standart HTTP y√∂ntemlerini kullanƒ±r.</p>
<h3>HTTP Y√∂ntemleri</h3>
<p>| Y√∂ntem | A√ßƒ±klama                          | √ñrnek Endpoint | | ------ | --------------------------------- | -------------- | | GET    | Bir kaynaƒüƒ± alƒ±r.                 | `/api/todos`   | | POST   | Yeni bir kaynak olu≈üturur.        | `/api/todos`   | | PUT    | Kaynaƒüƒ± g√ºnceller veya olu≈üturur. | `/api/todos/1` | | DELETE | Kaynaƒüƒ± siler.                    | `/api/todos/1` |</p>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Proje Olu≈üturma</h2>
<p>Spring Boot projesini [Spring Initializr](https://start.spring.io/) kullanarak olu≈üturabilirsiniz. A≈üaƒüƒ±daki ayarlarƒ± se√ßin:</p>
<ul>
<li>Proje: Maven</li>
<li>Dil: Java veya Kotlin</li>
<li>Spring Boot S√ºr√ºm√º: 3.0.0+</li>
<li>Baƒüƒ±mlƒ±lƒ±klar: Spring Web, Spring Boot DevTools, Lombok</li>
</ul>
<p>Projeyi indirin, IDE&#39;nizde a√ßƒ±n ve √ßalƒ±≈ütƒ±rmaya hazƒ±rlanƒ±n.</p>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: Model Sƒ±nƒ±fƒ± Olu≈üturma</h2>
<p>`Todo` nesnesi i√ßin bir model sƒ±nƒ±fƒ± olu≈üturun:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.model;

import lombok.Data;

@Data
public class Todo {
    private Long id;
    private String title;
    private boolean completed;
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.model

data class Todo(
    var id: Long,
    var title: String,
    var completed: Boolean
)</code></pre>
<hr />
<h2>üõ†Ô∏è Adƒ±m 3: Controller Sƒ±nƒ±fƒ± Olu≈üturma</h2>
<p>CRUD i≈ülemlerini tanƒ±mlayan bir `TodoController` sƒ±nƒ±fƒ± ekleyin:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo.controller;

import com.example.demo.model.Todo;
import org.springframework.web.bind.annotation.*;

import java.util.ArrayList;
import java.util.List;

@RestController
@RequestMapping(&quot;/api/todos&quot;)
public class TodoController {

    private List&lt;Todo&gt; todos = new ArrayList&lt;&gt;();

    @GetMapping
    public List&lt;Todo&gt; getAllTodos() {
        return todos;
    }

    @PostMapping
    public Todo createTodo(@RequestBody Todo todo) {
        todo.setId((long) (todos.size() + 1));
        todos.add(todo);
        return todo;
    }

    @PutMapping(&quot;/{id}&quot;)
    public Todo updateTodo(@PathVariable Long id, @RequestBody Todo updatedTodo) {
        Todo todo = todos.stream().filter(t -&gt; t.getId().equals(id)).findFirst().orElse(null);
        if (todo != null) {
            todo.setTitle(updatedTodo.getTitle());
            todo.setCompleted(updatedTodo.isCompleted());
        }
        return todo;
    }

    @DeleteMapping(&quot;/{id}&quot;)
    public void deleteTodo(@PathVariable Long id) {
        todos.removeIf(todo -&gt; todo.getId().equals(id));
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo.controller

import com.example.demo.model.Todo
import org.springframework.web.bind.annotation.*

@RestController
@RequestMapping(&quot;/api/todos&quot;)
class TodoController {

    private val todos = mutableListOf&lt;Todo&gt;()

    @GetMapping
    fun getAllTodos(): List&lt;Todo&gt; = todos

    @PostMapping
    fun createTodo(@RequestBody todo: Todo): Todo {
        todo.id = (todos.size + 1).toLong()
        todos.add(todo)
        return todo
    }

    @PutMapping(&quot;/{id}&quot;)
    fun updateTodo(@PathVariable id: Long, @RequestBody updatedTodo: Todo): Todo? {
        val todo = todos.find { it.id == id }
        todo?.apply {
            title = updatedTodo.title
            completed = updatedTodo.completed
        }
        return todo
    }

    @DeleteMapping(&quot;/{id}&quot;)
    fun deleteTodo(@PathVariable id: Long) {
        todos.removeIf { it.id == id }
    }
}</code></pre>
<hr />
<h2>üß™ Adƒ±m 4: API&#39;yi Test Etme</h2>
<p>API&#39;nizi test etmek i√ßin `curl` komutlarƒ±nƒ± kullanƒ±n:</p>
<ul>
<li>GET T√ºm Todos:</li>
</ul>
<pre><code class="language-bash">curl -X GET http://localhost:8080/api/todos</code></pre>
<ul>
<li>POST Yeni Todo:</li>
</ul>
<pre><code class="language-bash">curl -X POST http://localhost:8080/api/todos -H &quot;Content-Type: application/json&quot; -d &#39;{&quot;title&quot;: &quot;New Todo&quot;, &quot;completed&quot;: false}&#39;</code></pre>
<ul>
<li>PUT Todo G√ºncelleme:</li>
</ul>
<pre><code class="language-bash">curl -X PUT http://localhost:8080/api/todos/1 -H &quot;Content-Type: application/json&quot; -d &#39;{&quot;title&quot;: &quot;Updated Todo&quot;, &quot;completed&quot;: true}&#39;</code></pre>
<ul>
<li>DELETE Todo Silme:</li>
</ul>
<pre><code class="language-bash">curl -X DELETE http://localhost:8080/api/todos/1</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot ile REST API Geli≈ütirme i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[REST API]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-rest-api-thumbnail.webp" />
    </item>
    <item>
      <title><![CDATA[Spring Boot - ƒ∞lk Uygulama]]></title>
      <link>https://suaybsimsek.com/tr/posts/spring-boot-first-application</link>
      <description><![CDATA[Spring Boot ile ilk uygulamanƒ±zƒ± sƒ±fƒ±rdan olu≈üturmak i√ßin ba≈ülangƒ±√ß seviyesinde bir rehber. Temel bilgileri √∂ƒürenin ve Spring Boot ile yolculuƒüunuza ba≈ülayƒ±n.]]></description>
      <pubDate>Tue, 10 Dec 2024 00:00:00 GMT</pubDate>
      <guid isPermaLink="true">https://suaybsimsek.com/tr/posts/spring-boot-first-application</guid>
      <content:encoded><![CDATA[<p>Spring Boot, Spring Framework ile √ºretim i√ßin hazƒ±r uygulamalar olu≈üturmayƒ± kolayla≈ütƒ±rƒ±r. Bu rehberde, adƒ±m adƒ±m ilk Spring Boot uygulamanƒ±zƒ± olu≈üturmayƒ± √∂ƒüreneceksiniz.</p>
<hr />
<h2>üìã Gereksinimler</h2>
<p>üìã Ba≈ülamadan √∂nce a≈üaƒüƒ±daki ara√ßlarƒ±n kurulu olduƒüundan emin olun:</p>
<ul>
<li>‚òï Java Geli≈ütirme Kiti (JDK) 17+</li>
<li>üì¶ Maven veya Gradle</li>
<li>üñ•Ô∏è Bir Java IDE&#39;si (√ñrneƒüin IntelliJ IDEA, Eclipse veya Visual Studio Code)</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 1: Spring Boot Projesi Olu≈üturma</h2>
<p>ƒ∞lk Spring Boot projenizi iki ≈üekilde olu≈üturabilirsiniz:</p>
<p>1. Spring Initializr Kullanarak üñ±Ô∏è</p>
<ul>
<li>[Spring Initializr](https://start.spring.io/) adresini ziyaret edin.</li>
<li>A≈üaƒüƒ±daki gibi yapƒ±landƒ±rƒ±n:</li>
<li>üìÇ Proje: `Maven`</li>
<li>üë®‚Äçüíª Dil: `Java` veya `Kotlin`</li>
<li>üîÑ Spring Boot S√ºr√ºm√º: `3.0.0` (veya en g√ºncel s√ºr√ºm).</li>
<li>üìú Baƒüƒ±mlƒ±lƒ±klar: `Spring Web`</li>
<li>Generate d√ºƒümesine tƒ±klayarak proje dosyalarƒ±nƒ± indirin.</li>
</ul>
<p>2. IntelliJ IDEA Kullanarak üíª</p>
<ul>
<li>IntelliJ IDEA‚Äôyƒ± a√ßƒ±n.</li>
<li>`New Project &gt; Spring Initializr` b√∂l√ºm√ºne gidin.</li>
<li>Yukarƒ±da belirtilen parametrelerle benzer ≈üekilde yapƒ±landƒ±rƒ±n.</li>
</ul>
<hr />
<h2>üõ†Ô∏è Adƒ±m 2: ƒ∞lk Endpoint‚Äôinizi Yazma</h2>
<p>Bir &quot;hello&quot; mesajƒ± d√∂nen basit bir endpoint yazalƒ±m:</p>
<h3>Java</h3>
<pre><code class="language-java">package com.example.demo;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
public class DemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @GetMapping(&quot;/hello&quot;)
    public String sayHello() {
        return &quot;Merhaba, Spring Boot!&quot;;
    }
}</code></pre>
<h3>Kotlin</h3>
<pre><code class="language-kotlin">package com.example.demo

import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication
import org.springframework.web.bind.annotation.GetMapping
import org.springframework.web.bind.annotation.RestController

@SpringBootApplication
@RestController
class DemoApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;DemoApplication&gt;(*args)
}

@GetMapping(&quot;/hello&quot;)
fun sayHello(): String {
    return &quot;Merhaba, Spring Boot!&quot;
}</code></pre>
<hr />
<h2>‚ñ∂Ô∏è Adƒ±m 3: Uygulamayƒ± √áalƒ±≈ütƒ±rma</h2>
<p>1. Proje klas√∂r√ºnde bir terminal a√ßƒ±n. 2. Uygulamanƒ±zƒ± √ßalƒ±≈ütƒ±rmak i√ßin ≈üu komutu y√ºr√ºt√ºn:</p>
<pre><code class="language-bash">./mvnw spring-boot:run</code></pre>
<p>3. Endpoint‚Äôe ≈üu adresten eri≈üebilirsiniz: ``` http://localhost:8080/hello ```</p>
<p>Yanƒ±t:</p>
<pre><code>Merhaba, Spring Boot!</code></pre>
<hr />
<h2>üèÅ Sonu√ß</h2>
<p>Bu kurulum, Spring Boot ile Spring Boot - ƒ∞lk Uygulama i√ßin saƒülam ve √ºretim‚Äëhazƒ±r bir yakla≈üƒ±m sunar; en iyi pratikleri, net bir yapƒ± ve kendi projenize uyarlayabileceƒüiniz √∂rneklerle birle≈ütirir.</p>]]></content:encoded>
      <category><![CDATA[Java]]></category>
      <category><![CDATA[Kotlin]]></category>
      <category><![CDATA[Spring Boot]]></category>
      <category><![CDATA[Ba≈ülangƒ±√ß Rehberi]]></category>
      <category><![CDATA[Programlama]]></category>
      <media:thumbnail url="https://suaybsimsek.com/images/spring-boot-first-app-thumbnail.webp" />
    </item>
  </channel>
</rss>
